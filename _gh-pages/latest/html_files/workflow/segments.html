<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The workflow segment generation module &mdash; PyCBC 0.0a8230 documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/terminal.css" type="text/css" />
      <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="../_static/typed.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The workflow datafind and validation module" href="datafind.html" />
    <link rel="prev" title="Pycbc’s workflow module configuration file(s) and command line interface" href="initialization.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> PyCBC
          </a>
              <div class="version">
                1.18.3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../credit.html">Use of PyCBC in Scientific Publications</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../docker.html">Running PyCBC under Docker</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installing PyCBC</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../inference.html">PyCBC inference documentation (<code class="docutils literal notranslate"><span class="pre">pycbc.inference</span></code>)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pycbc_make_psd_estimation_workflow.html"><code class="docutils literal notranslate"><span class="pre">pycbc_make_psd_estimation_workflow</span></code>: A workflow generator for noise estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="pycbc_make_coinc_search_workflow.html"><code class="docutils literal notranslate"><span class="pre">pycbc_make_coinc_search_workflow</span></code>: A workflow to search for gravitational waves</a></li>
<li class="toctree-l1"><a class="reference internal" href="pygrb.html"><code class="docutils literal notranslate"><span class="pre">pycbc_make_offline_grb_workflow</span></code>: A GRB triggered CBC analysis workflow generator</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tmpltbank.html">PyCBC template bank generation documentation (<code class="docutils literal notranslate"><span class="pre">pycbc.tmpltbank</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hwinj.html">Hardware injection waveform generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../banksim.html">Calculating the Effectualness (Fitting Factor) of Template Banks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faithsim.html">Dag Generator for Doing Faithfulness Comparisons</a></li>
<li class="toctree-l1"><a class="reference internal" href="../upload_to_gracedb.html">Uploading triggers to gracedb</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../waveform_plugin.html">Making new waveform approximants available to PyCBC</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../catalog.html">Catalog of Observed Gravitational-wave Mergers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dataquality.html">Query times of valid data, hardware injections, and more.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../frame.html">Reading Gravitational-wave Frames</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fft.html">Performing FFTs in PyCBC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gw150914.html">Signal Processing with GW150914</a></li>
<li class="toctree-l1"><a class="reference internal" href="../detector.html">Gravitational-wave Detectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../psd.html">Handling PSDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../noise.html">Generating Noise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../waveform.html">Waveforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filter.html">Filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../distributions.html">Using PyCBC Distributions from PyCBC Inference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../building_bundled_executables.html">Building Bundled Executables</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../documentation.html">Documenting PyCBC code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">Creating Releases of PyCBC</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../formats/hdf_format.html">HDF files within the PyCBC workflow</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../workflow.html">Workflow: the inspiral analysis workflow generator (<code class="docutils literal notranslate"><span class="pre">pycbc.workflow</span></code>)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../workflow.html#introduction">Introduction</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../workflow.html#workflow-module-documentation">Workflow module documentation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../workflow.html#basics-and-overview">Basics and overview</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../workflow.html#generating-segments">Generating segments</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">The workflow segment generation module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../workflow.html#obtaining-data">Obtaining data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workflow.html#injection-generation">Injection generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workflow.html#template-bank">Template bank</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workflow.html#split-table">Split table</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workflow.html#matched-filtering">Matched-filtering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workflow.html#coincidence">Coincidence</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../workflow.html#method-documentation">Method documentation</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">pycbc</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyCBC</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../workflow.html">Workflow: the inspiral analysis workflow generator (<code class="docutils literal notranslate"><span class="pre">pycbc.workflow</span></code>)</a> &raquo;</li>
      <li>The workflow segment generation module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/workflow/segments.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="the-workflow-segment-generation-module">
<span id="workflowsegmentsmod"></span><h1>The workflow segment generation module<a class="headerlink" href="#the-workflow-segment-generation-module" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This page is designed to give you an introduction to the capabilities of the
pycbc workflow segment generation module and how to use this as part of a pycbc
workflow.</p>
<p>This module is designed to be able to support multiple ways of obtaining these
segments (different codes/interfaces whatever), although new code will always
be needed to support some code/interface that is not currently supported.</p>
<p>This module will generate science segments and any appropriate veto segments
and combine these together to identify a set of segments to be used in the
analysis. The various files will also be returned for later use in the analysis
(ie. for vetoing triggers with data-quality vetoes). If other workflows require
similar combined files these can be added on request.</p>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>Using this module requires a number of things</p>
<ul class="simple">
<li>A configuration file (or files) containing the information needed to tell this module how to generate the segments (described below).</li>
<li>An initialized instance of the pycbc Workflow class, containing the ConfigParser.</li>
</ul>
<p>The module is then called according to</p>
<dl class="function">
<dt>
<code class="descclassname">pycbc.workflow.</code><code class="descname">get_segments_file</code><span class="sig-paren">(</span><em>workflow</em>, <em>name</em>, <em>option_name</em>, <em>out_dir</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycbc/workflow/segment.html#get_segments_file"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Get cumulative segments from option name syntax for each ifo.</p>
<p>Use syntax of configparser string to define the resulting segment_file
e.x. option_name = +up_flag1,+up_flag2,+up_flag3,-down_flag1,-down_flag2
Each ifo may have a different string and is stored separately in the file.
Flags which add time must precede flags which subtract time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>workflow</strong> (<em>pycbc.workflow.Workflow</em>) – </li>
<li><strong>name</strong> (<em>string</em>) – Name of the segment list being created</li>
<li><strong>option_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Name of option in the associated config parser to get the flag list</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>seg_file</strong> – SegFile intance that points to the segment xml file on disk.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pycbc.workflow.SegFile</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<div class="section" id="configuration-file-setup">
<h3>Configuration file setup<a class="headerlink" href="#configuration-file-setup" title="Permalink to this headline">¶</a></h3>
<p>Here we document the necessary parts of a configuration file for this module.
We’ll lay this out in a few blocks. First we’ll give an overview of what this might look like in an O3 analysis, to give some background, then we’ll give a more comprehensive description of the input format in the <cite>ini</cite> file, and finally we’ll explain the full syntax that can be used for individual flags.</p>
<div class="section" id="example-config-file">
<h4>Example config file<a class="headerlink" href="#example-config-file" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">workflow</span><span class="p">]</span>
<span class="p">;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">pycbc</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">pycbc</span><span class="o">/</span><span class="n">latest</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">workflow</span><span class="o">/</span><span class="n">initialization</span><span class="o">.</span><span class="n">html</span>
<span class="n">h1</span><span class="o">-</span><span class="n">channel</span><span class="o">-</span><span class="n">name</span> <span class="o">=</span> <span class="n">H1</span><span class="p">:</span><span class="n">GDS</span><span class="o">-</span><span class="n">CALIB_STRAIN</span>
<span class="n">l1</span><span class="o">-</span><span class="n">channel</span><span class="o">-</span><span class="n">name</span> <span class="o">=</span> <span class="n">L1</span><span class="p">:</span><span class="n">GDS</span><span class="o">-</span><span class="n">CALIB_STRAIN</span>

<span class="p">[</span><span class="n">workflow</span><span class="o">-</span><span class="n">ifos</span><span class="p">]</span>
<span class="n">h1</span> <span class="o">=</span>
<span class="n">l1</span> <span class="o">=</span>

<span class="p">[</span><span class="n">workflow</span><span class="o">-</span><span class="n">datafind</span><span class="p">]</span>
<span class="n">datafind</span><span class="o">-</span><span class="n">h1</span><span class="o">-</span><span class="n">frame</span><span class="o">-</span><span class="nb">type</span> <span class="o">=</span> <span class="n">H1_HOFT_C00</span>
<span class="n">datafind</span><span class="o">-</span><span class="n">l1</span><span class="o">-</span><span class="n">frame</span><span class="o">-</span><span class="nb">type</span> <span class="o">=</span> <span class="n">L1_HOFT_C00</span>
<span class="p">;</span><span class="n">datafind</span><span class="o">-</span><span class="n">check</span><span class="o">-</span><span class="n">frames</span><span class="o">-</span><span class="n">exist</span> <span class="o">=</span> <span class="n">no_test</span>

<span class="p">[</span><span class="n">workflow</span><span class="o">-</span><span class="n">segments</span><span class="p">]</span>
<span class="n">segments</span><span class="o">-</span><span class="n">database</span><span class="o">-</span><span class="n">url</span> <span class="o">=</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">segments</span><span class="o">.</span><span class="n">ligo</span><span class="o">.</span><span class="n">org</span>
<span class="n">segments</span><span class="o">-</span><span class="n">veto</span><span class="o">-</span><span class="n">definer</span><span class="o">-</span><span class="n">url</span> <span class="o">=</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">git</span><span class="o">.</span><span class="n">ligo</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">detchar</span><span class="o">/</span><span class="n">veto</span><span class="o">-</span><span class="n">definitions</span><span class="o">/</span><span class="n">raw</span><span class="o">/</span><span class="n">db20ca71e65b54c0b073fd3d84d5f43fd822779e</span><span class="o">/</span><span class="n">cbc</span><span class="o">/</span><span class="n">O2</span><span class="o">/</span><span class="n">H1L1</span><span class="o">-</span><span class="n">CBC_VETO_DEFINER_CLEANED_C02_O2_1164556817</span><span class="o">-</span><span class="mf">23176801.</span><span class="n">xml</span>
<span class="n">segments</span><span class="o">-</span><span class="n">vetoes</span> <span class="o">=</span> <span class="o">+</span><span class="n">CAT_2</span><span class="p">,</span><span class="o">+</span><span class="n">CAT_H</span>

<span class="p">[</span><span class="n">workflow</span><span class="o">-</span><span class="n">segments</span><span class="o">-</span><span class="n">h1</span><span class="p">]</span>
<span class="p">;</span> <span class="n">NOTE</span><span class="p">:</span> <span class="n">It</span><span class="s1">&#39;s important to check the version number</span>
<span class="n">segments</span><span class="o">-</span><span class="n">science</span> <span class="o">=</span> <span class="o">+</span><span class="n">DMT</span><span class="o">-</span><span class="n">ANALYSIS_READY</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="n">CAT_1</span>

<span class="p">[</span><span class="n">workflow</span><span class="o">-</span><span class="n">segments</span><span class="o">-</span><span class="n">l1</span><span class="p">]</span>
<span class="p">;</span> <span class="n">NOTE</span><span class="p">:</span> <span class="n">It</span><span class="s1">&#39;s important to check the version number</span>
<span class="n">segments</span><span class="o">-</span><span class="n">science</span> <span class="o">=</span> <span class="o">+</span><span class="n">DMT</span><span class="o">-</span><span class="n">ANALYSIS_READY</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="n">CAT_1</span>

<span class="p">[</span><span class="n">datafind</span><span class="p">]</span>
<span class="n">urltype</span> <span class="o">=</span> <span class="n">file</span>
</pre></div>
</div>
<p>Note that this includes both datafind and segment instructions. We’ll just
describe the segment options</p>
</div>
<div class="section" id="description-of-the-ini-file-contents">
<h4>Description of the ini file contents<a class="headerlink" href="#description-of-the-ini-file-contents" title="Permalink to this headline">¶</a></h4>
<p>There are three important segments options that we need to provide:</p>
<ul class="simple">
<li><cite>segments-science</cite>: This decides what times will be analysed to produce triggers. All times in this might be used to compute PSDs used in the results. Normally all times flagged as ready for science analysis, minus times vetoed at CAT_1.</li>
<li><cite>segments-vetoes</cite>: This decides what times will be vetoed when producing final candidate event lists. These times <em>are</em> analysed but are discarded after combining single-detector triggers together. Normally the time discarded comprises times vetoed at CAT_2 and times of hardware injections.</li>
<li><cite>segments-veto-definer-url</cite>: As previously, this is the location of the veto definer.</li>
</ul>
<p>Note that this obeys the usual workflow tagging rules. If you supply <cite>segments-science</cite> in <cite>workflow-segments</cite> it will be valid for all ifos. Or, if you want to supply different values for different ifos (e.g. because the Virgo SCIENCE flag is named differently to L1 and H1) you can use <cite>workflow-segments-${ifoname}</cite> (where <cite>${ifoname}</cite> is replaced with the ifo name and this should then be given for all active ifos).</p>
<p>The <cite>segments-science</cite> and <cite>segments-vetoes</cite> are provided as a <em>comma-separated</em> list of flags. Documented below.</p>
</div>
<div class="section" id="flag-syntax">
<h4>Flag syntax<a class="headerlink" href="#flag-syntax" title="Permalink to this headline">¶</a></h4>
<p>We’ve said that <cite>segments-science</cite> and <cite>segments-vetoes</cite> look something like</p>
<p><cite>segments-science = FLAG_1,FLAG_2</cite></p>
<p>We start with a simple example of what can be given as the value of FLAG_1:</p>
<p><cite>+SCIENCE</cite> or <cite>-SCIENCE</cite></p>
<p>In this case SCIENCE is the flag name. It is what will be queried from the segment server. The ifo will be automatically appended, so this becomes <cite>${IFO}:SCIENCE</cite> when querying. The <cite>+</cite> or <cite>-</cite> is important and not optional. If the sign as a <cite>+</cite> then the flag is added to the list of times, if it is <cite>-</cite> then the flag is removed. All <cite>+</cite> flags are processed first and then all <cite>-</cite> flags are removed from that.</p>
<p>In <cite>segments-science</cite> <cite>+</cite> means that that time should be included in the analysis. A <cite>-</cite> means it should not be included.</p>
<p>In <cite>segments-vetoes</cite> <cite>+</cite> means that that time should be included in the vetoed times and so not included in the analysis. A <cite>-</cite> means it should not be included in the vetoed times so that time will be analysed … It is not envisaged that <cite>-</cite> flags will be used often in <cite>segments-vetoes</cite>.</p>
<div class="section" id="version-numbers">
<h5>Version numbers<a class="headerlink" href="#version-numbers" title="Permalink to this headline">¶</a></h5>
<p>For LVC internal usage, flags should be provided with a version number. So this would be:</p>
<p><cite>+SCIENCE:1</cite> or <cite>-SCIENCE:1</cite></p>
<p>not providing a version will query <em>all</em> versions of that flag. That probably won’t be a good thing with a flag like <cite>SCIENCE</cite>, but will be okay if there is only one version of the flag. In general, for LVC usage provide a version number! For GWOSC usage there are no version numbers.</p>
</div>
<div class="section" id="the-veto-definer-file">
<h5>The veto-definer file<a class="headerlink" href="#the-veto-definer-file" title="Permalink to this headline">¶</a></h5>
<p>The veto definer file groups a set of flags together, defining what is meant as CAT_1 vetoes. We could explicitly map the veto-definer from the XML file into a list of flags (removing the veto-definer altogether), but it is easier to just use the veto-definer and let the detchar group decide what these flags should be.</p>
<p>When using a veto-definer we have access to “special” flag names corresponding to what’s in the veto-definer. These special flag names are:</p>
<ul class="simple">
<li><cite>CAT_1</cite>: All flags given the <cite>category</cite> value of 1 within the veto-definer file.</li>
<li><cite>CAT_2</cite>: All flags given the <cite>category</cite> value of 2 within the veto-definer file.</li>
<li><cite>CAT_H</cite>: All flags given the <cite>category</cite> value of 3 within the veto-definer file. There’s some history/confusion here: since S6 we’ve been storing hardware injections in the <cite>category=3</cite> field of the veto-definer. Don’t worry about that, this just means all hardware injection flags.</li>
<li><cite>CAT_3</cite>. All flags given the <cite>category</cite> value of 4 within the veto-definer file. As mentioned above, this is where category 3 vetoes are traditionally stored. These vetoes have not been used since the start of Advanced LIGO/Virgo, so we can probably ignore this now.</li>
</ul>
<p>Examples of using these flags are given at the top. All of the stuff below also applies to these “special” flags, but some of these combinations may be a little odd.</p>
</div>
<div class="section" id="adding-a-ifo">
<h5>Adding a ifo<a class="headerlink" href="#adding-a-ifo" title="Permalink to this headline">¶</a></h5>
<p>Now let’s start adding complexity. I can explicitly state an ifo, even if the workflow thinks it’s analysing V1, I can supply a <em>different</em> ifo and the workflow will analyse that data as if it was the second ifo. For example</p>
<p><cite>segments-science-v1 = H1:DMT-ANALYSIS_READY:1</cite></p>
<p>will use <cite>H1</cite> data as “Virgo”. This functionality is not expected to be used in production runs, but has been useful in the past for testing purposes, e.g. using H1 data as V1 to simulate a true 3-instrument analysis. Probably this won’t be used much, but it’s here for completeness.</p>
</div>
<div class="section" id="providing-padding">
<h5>Providing padding<a class="headerlink" href="#providing-padding" title="Permalink to this headline">¶</a></h5>
<p>For some flags we want to include some additional time … Normally for vetoes where we want to cut out a little bit more data as we know the bad time might be a little longer than that recorded. This can be done as:</p>
<p><cite>+H1:SCIENCE:1&lt;-8:8&gt;</cite> or <cite>-H1:SCIENCE:1&lt;-8:8&gt;</cite></p>
<p>This corresponds to <cite>start_pad</cite> = -8 and <cite>end_pad</cite> = 8. These numbers are added to the start/end times of every segment coming from this flag, so <cite>segment_start += start_pad</cite> and <cite>segment_end += end_pad</cite>.  Or more simply, in this example the segment is extended by 8s on both the start and the end of every segment.
This number can be flipped to cause the segment to get shorter. Be careful with this though, glue does not do the right thing if the start of a segment is after the end of the segment - e.g. if you shrink a segment so much that it disappears, weird things will happen!</p>
<p>The padding must always appear after the flag and version name.</p>
</div>
<div class="section" id="providing-valid-times">
<h5>Providing valid times<a class="headerlink" href="#providing-valid-times" title="Permalink to this headline">¶</a></h5>
<p>Some flags are valid between a specific range of times. So if we provide:</p>
<p><cite>+H1:SCIENCE:1[0:1000000000]</cite> or <cite>-H1:SCIENCE:1[0:1000000000]</cite></p>
<p>it means that we only query the <cite>SCIENCE</cite> flag for times in [0:1000000000]. If this flag is active outside of this time range, we do not use it.</p>
<p>At the moment it is not possible to provide a flag that is active in two distinct ranges, but not in between. If that functionality is required, it can probably be added.</p>
<p>Valid times must also be provided after the flag name and version. If providing <em>both</em> this and a padding it would look like:</p>
<p><cite>+H1:SCIENCE:1&lt;-8:8&gt;[0:1000000000]</cite> or <cite>-H1:SCIENCE:1&lt;-8:8&gt;[0:1000000000]</cite></p>
</div>
<div class="section" id="obtaining-segments-from-pre-existing-xml-files">
<h5>Obtaining segments from pre-existing XML files<a class="headerlink" href="#obtaining-segments-from-pre-existing-xml-files" title="Permalink to this headline">¶</a></h5>
<p>Instead of obtaining science and veto segments from a segment database and veto
definer file, they can be read directly from XML segment files. This can be
useful, for example, to test new kinds of vetoes. To do this, use the following
options in the <cite>[workflow-segments]</cite> section:</p>
<ul class="simple">
<li><cite>segments-source = file</cite></li>
<li><cite>segments-science-file = /path/to/science/segments/file.xml</cite></li>
<li><cite>segments-vetoes-file = /path/to/veto/segments/file.xml</cite></li>
</ul>
<p>In order for this to work, the <cite>name</cite> field of the <cite>segment_definer</cite> tables of
the science and vetoes files should be set to <cite>science</cite> and <cite>vetoes</cite>
respectively.</p>
</div>
</div>
</div>
</div>
<div class="section" id="old-usage">
<h2>OLD Usage<a class="headerlink" href="#old-usage" title="Permalink to this headline">¶</a></h2>
<p>THE FOLLOWING DESCRIBES THE DEPRECATED INTERFACE. DO NOT USE THIS ANY MORE.
IT WILL SOON BE REMOVED!!!</p>
<p>Using this module requires a number of things</p>
<ul class="simple">
<li>A configuration file (or files) containing the information needed to tell this module how to generate the segments (described below).</li>
<li>An initialized instance of the pycbc Workflow class, containing the ConfigParser.</li>
</ul>
<p>The module is then called according to</p>
<dl class="function">
<dt>
<code class="descclassname">pycbc.workflow.</code><code class="descname">setup_segment_generation</code><span class="sig-paren">(</span><em>workflow</em>, <em>out_dir</em>, <em>tag=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycbc/workflow/segment.html#setup_segment_generation"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>This function is the gateway for setting up the segment generation steps in a
workflow. It is designed to be able to support multiple ways of obtaining
these segments and to combine/edit such files as necessary for analysis.
The current modules have the capability to generate files at runtime or to
generate files that are not needed for workflow generation within the workflow.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>workflow</strong> (<a class="reference internal" href="../pycbc.workflow.html#pycbc.workflow.core.Workflow" title="pycbc.workflow.core.Workflow"><em>pycbc.workflow.core.Workflow</em></a>) – The workflow instance that the coincidence jobs will be added to.
This instance also contains the ifos for which to attempt to obtain
segments for this analysis and the start and end times to search for
segments over.</li>
<li><strong>out_dir</strong> (<em>path</em>) – The directory in which output will be stored.</li>
<li><strong>tag</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default=None</em><em>)</em>) – Use this to specify a tag. This can be used if this module is being
called more than once to give call specific configuration (by setting
options in [workflow-datafind-${TAG}] rather than [workflow-datafind]). This
is also used to tag the Files returned by the class to uniqueify
the Files and uniqueify the actual filename.
FIXME: Filenames may not be unique with current codes!</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>segsToAnalyse</strong> (<em>dictionay of ifo-keyed glue.segment.segmentlist instances</em>) – This will contain the times that your code should analyse. By default this
is science time - CAT_1 vetoes. (This default could be changed if desired)</li>
<li><strong>segFilesList</strong> (<em>pycbc.workflow.core.FileList of SegFile instances</em>) – These are representations of the various segment files that were constructed
at this stage of the workflow and may be needed at later stages of the
analysis (e.g. for performing DQ vetoes). If the file was generated at
run-time the segment lists contained within these files will be an attribute
of the instance. (If it will be generated in the workflow it will not be
because I am not psychic).</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<div class="section" id="old-configuration-file-setup">
<h3>OLD Configuration file setup<a class="headerlink" href="#old-configuration-file-setup" title="Permalink to this headline">¶</a></h3>
<p>Here we describe the options given in the configuration file used in the
workflow that will be needed in this section</p>
<div class="section" id="workflow-segments-section">
<h4>[workflow-segments] section<a class="headerlink" href="#workflow-segments-section" title="Permalink to this headline">¶</a></h4>
<p>The configuration file must have a [workflow-segments] section, which is used to
tell the workflow how to construct the segments. The first option to choose
and provide is</p>
<p>segments-method = VALUE</p>
<p>The choices here and their description are as described below</p>
<ul class="simple">
<li>AT_RUNTIME - Use the setup_segment_gen_mixed to generate segments and generate all segment files at runtime</li>
<li>CAT2_PLUS_DAG - Use the setup_segment_gen_mixed to generate segments, generate all veto files up to CATEGORY_1 at runtime, and add jobs to produce the remaining files to the workflow.</li>
<li>CAT3_PLUS_DAG - Use the setup_segment_gen_mixed to generate segments, generate all veto files up to CATEGORY_2 at runtime, and add jobs to produce the remaining files to the workflow.</li>
<li>CAT4_PLUS_DAG - Use the setup_segment_gen_mixed to generate segments, generate all veto files up to CATEGORY_3 at runtime, and add jobs to produce the remaining files to the workflow.</li>
</ul>
<p>Each of these options will describe which subfunction to use. These are described here</p>
<dl class="function">
<dt>
<code class="descclassname">pycbc.workflow.</code><code class="descname">setup_segment_gen_mixed</code><span class="sig-paren">(</span><em>workflow</em>, <em>veto_categories</em>, <em>out_dir</em>, <em>maxVetoAtRunTime</em>, <em>tag=None</em>, <em>generate_coincident_segs=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycbc/workflow/segment.html#setup_segment_gen_mixed"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>This function will generate veto files for each ifo and for each veto
category.
It can generate these vetoes at run-time or in the workflow (or do some at
run-time and some in the workflow). However, the CAT_1 vetoes and science
time must be generated at run time as they are needed to plan the workflow.
CATs 2 and higher <em>may</em> be needed for other workflow construction.
It can also combine these files to create a set of cumulative,
multi-detector veto files, which can be used in ligolw_thinca and in
pipedown. Again these can be created at run time or within the workflow.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>workflow</strong> (<a class="reference internal" href="../pycbc.workflow.html#pycbc.workflow.core.Workflow" title="pycbc.workflow.core.Workflow"><em>pycbc.workflow.core.Workflow</em></a>) – The Workflow instance that the coincidence jobs will be added to.
This instance also contains the ifos for which to attempt to obtain
segments for this analysis and the start and end times to search for
segments over.</li>
<li><strong>veto_categories</strong> (<em>list of ints</em>) – List of veto categories to generate segments for. If this stops being
integers, this can be changed here.</li>
<li><strong>out_dir</strong> (<em>path</em>) – The directory in which output will be stored.</li>
<li><strong>maxVetoAtRunTime</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – Generate veto files at run time up to this category. Veto categories
beyond this in veto_categories will be generated in the workflow.
If we move to a model where veto
categories are not explicitly cumulative, this will be rethought.</li>
<li><strong>tag</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default=None</em><em>)</em>) – Use this to specify a tag. This can be used if this module is being
called more than once to give call specific configuration (by setting
options in [workflow-datafind-${TAG}] rather than [workflow-datafind]). This
is also used to tag the Files returned by the class to uniqueify
the Files and uniqueify the actual filename.
FIXME: Filenames may not be unique with current codes!</li>
<li><strong>generate_coincident_segs</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default = True</em><em>)</em>) – If given this module will generate a set of coincident, cumulative veto
files that can be used with ligolw_thinca and pipedown.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>segFilesList</strong> – These are representations of the various segment files that were
constructed
at this stage of the workflow and may be needed at later stages of the
analysis (e.g. for performing DQ vetoes). If the file was generated at
run-time the segment lists contained within these files will be an
attribute
of the instance. (If it will be generated in the workflow it will
not be because I am not psychic).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dictionary of pycbc.workflow.core.SegFile instances</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>When using the setup_segment_gen_mixed function the following additional options apply</p>
<ul class="simple">
<li>segments-X1-science-name = NAME - REQUIRED. Where X1 is replaced by the ifo name for each ifo. The NAME should be the full channel name corresponding to analysable times for e.g. H1:DMT-SCIENCE:4</li>
<li>segments-database-url = URL - REQUIRED. The URL to the segment databse that will be used to obtain this information</li>
<li>segments-veto-definer-url = PATH - REQUIRED. The location to the veto-definer file that is used to identify which channels are CAT_1, which are CAT_2 etc.</li>
<li>segments-veto-categories = COMMA-SEPARATED LIST OF INTS - OPTIONAL. Generate veto files for veto categories given by the ints in the list. These ranged from 1 through 4 or 5 for S5/S6 veto definers. Standard results have used categories 2,3,4.</li>
<li>segments-minimum-segment-length = INT - OPTIONAL. If given, any segments of analysable data shorter than INT will not be included in the list of analysable times returned by this module.</li>
<li>segments-generate-coincident-segments - OPTIONAL. Option takes no value. If given the module will generate cumulative, multiple detector coincidence files for easy use in ligolw_thinca and pipedown.</li>
<li>segments-generate-segment-files - OPTIONAL (DEFAULT=’always’). This option can be used if the user wants to re-use segment files generated previously. It is not recommended to use this option unless necessary. Options are<ul>
<li>generate_segment_files=’always’ : DEFAULT: All files will be generated even if they already exist.</li>
<li>generate_segment_files=’if_not_present’: Files will be generated if they do not already exist. Pre-existing files will be read in and used.</li>
<li>generate_segment_files=’error_on_duplicate’: Files will be generated if they do not already exist. Pre-existing files will raise a failure.</li>
<li>generate_segment_files=’never’: Pre-existing files will be read in and used. If no file exists the code will fail.</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="executables">
<h4>[executables]<a class="headerlink" href="#executables" title="Permalink to this headline">¶</a></h4>
<p>The following executable paths must be provided in the [executables] section
when running this module:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">segment_query</span> <span class="o">=</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ahnitz</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lalsuite</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">ligolw_segment_query</span>
<span class="o">*</span> <span class="n">segments_from_cats</span> <span class="o">=</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ahnitz</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lalsuite</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">ligolw_segments_from_cats</span>
<span class="o">*</span> <span class="n">llwadd</span> <span class="o">=</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ahnitz</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lalsuite</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">ligolw_add</span>
<span class="o">*</span> <span class="n">ligolw_combine_segments</span> <span class="o">=</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ahnitz</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lalsuite</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">ligolw_combine_segments</span>
</pre></div>
</div>
<p>segment_query is used to obtain the science segments. segments_from_cats is used to obtain the files containing the CAT_1,2,3,4,5 segments. ligolw_combine_segments produces cumulative veto-files. llwadd is used to add the cumulative veto-files from different ifos together when producing cumulative, multiple-detector veto lists.</p>
</div>
<div class="section" id="other-sections">
<h4>Other sections<a class="headerlink" href="#other-sections" title="Permalink to this headline">¶</a></h4>
<p>For other sub-modules in the pycbc workflow module we would see sections like [segment_query], [segments_from_cats] etc. which would provide the options provided to those jobs. In this case the codes require rather specific input so for now these are hardcoded in this module and any segment like [segment_query] would either be ignored or
could break the code.</p>
<p>If there is a reason to do so we could add these sections in.</p>
</div>
</div>
</div>
<div class="section" id="pycbc-workflow-segment-module">
<h2><a class="reference internal" href="../pycbc.workflow.html#module-pycbc.workflow.segment" title="pycbc.workflow.segment"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pycbc.workflow.segment</span></code></a> Module<a class="headerlink" href="#pycbc-workflow-segment-module" title="Permalink to this headline">¶</a></h2>
<p>This is complete documentation of this module’s code</p>
<p>This module is responsible for setting up the segment generation stage of
workflows. For details about this module and its capabilities see here:
<a class="reference external" href="https://ldas-jobs.ligo.caltech.edu/~cbc/docs/pycbc/ahope/segments.html">https://ldas-jobs.ligo.caltech.edu/~cbc/docs/pycbc/ahope/segments.html</a></p>
<dl class="function">
<dt>
<code class="descclassname">pycbc.workflow.segment.</code><code class="descname">add_cumulative_files</code><span class="sig-paren">(</span><em>workflow</em>, <em>output_file</em>, <em>input_files</em>, <em>out_dir</em>, <em>execute_now=False</em>, <em>tags=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycbc/workflow/segment.html#add_cumulative_files"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Function to combine a set of segment files into a single one. This function
will not merge the segment lists but keep each separate.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>workflow</strong> (<a class="reference internal" href="../pycbc.workflow.html#pycbc.workflow.core.Workflow" title="pycbc.workflow.core.Workflow"><em>pycbc.workflow.core.Workflow</em></a>) – An instance of the Workflow class that manages the workflow.</li>
<li><strong>output_file</strong> (<a class="reference internal" href="../pycbc.workflow.html#pycbc.workflow.core.File" title="pycbc.workflow.core.File"><em>pycbc.workflow.core.File</em></a>) – The output file object</li>
<li><strong>input_files</strong> (<a class="reference internal" href="../pycbc.workflow.html#pycbc.workflow.core.FileList" title="pycbc.workflow.core.FileList"><em>pycbc.workflow.core.FileList</em></a>) – This list of input segment files</li>
<li><strong>out_dir</strong> (<em>path</em>) – The directory to write output to.</li>
<li><strong>execute_now</strong> (<em>boolean</em><em>, </em><em>optional</em>) – If true, jobs are executed immediately. If false, they are added to the
workflow to be run later.</li>
<li><strong>tags</strong> (<em>list of strings</em><em>, </em><em>optional</em>) – A list of strings that is used to identify this job</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">pycbc.workflow.segment.</code><code class="descname">cat_to_veto_def_cat</code><span class="sig-paren">(</span><em>val</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycbc/workflow/segment.html#cat_to_veto_def_cat"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Convert a category character to the corresponding value in the veto
definer file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>str</strong> (<em>single character string</em>) – The input category character</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>pipedown_str</strong> (<em>str</em>) – The pipedown equivalent notation that can be passed to programs</li>
<li><em>that expect this definition.</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">pycbc.workflow.segment.</code><code class="descname">create_segs_from_cats_job</code><span class="sig-paren">(</span><em>cp</em>, <em>out_dir</em>, <em>ifo_string</em>, <em>tags=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycbc/workflow/segment.html#create_segs_from_cats_job"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>This function creates the CondorDAGJob that will be used to run
ligolw_segments_from_cats as part of the workflow</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cp</strong> (<a class="reference internal" href="../pycbc.workflow.html#pycbc.workflow.configuration.WorkflowConfigParser" title="pycbc.workflow.configuration.WorkflowConfigParser"><em>pycbc.workflow.configuration.WorkflowConfigParser</em></a>) – The in-memory representation of the configuration (.ini) files</li>
<li><strong>out_dir</strong> (<em>path</em>) – Directory in which to put output files</li>
<li><strong>ifo_string</strong> (<em>string</em>) – String containing all active ifos, ie. “H1L1V1”</li>
<li><strong>tag</strong> (<em>list of strings</em><em>, </em><em>optional</em><em> (</em><em>default=None</em><em>)</em>) – Use this to specify a tag(s). This can be used if this module is being
called more than once to give call specific configuration (by setting
options in [workflow-datafind-${TAG}] rather than [workflow-datafind]).
This is also used to tag the Files returned by the class to uniqueify
the Files and uniqueify the actual filename.
FIXME: Filenames may not be unique with current codes!</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>job</strong> – The Job instance that will run segments_from_cats jobs</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Job instance</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">pycbc.workflow.segment.</code><code class="descname">file_needs_generating</code><span class="sig-paren">(</span><em>file_path</em>, <em>cp</em>, <em>tags=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycbc/workflow/segment.html#file_needs_generating"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>This job tests the file location and determines if the file should be
generated now or if an error should be raised. This uses the
generate_segment_files variable, global to this module, which is described
above and in the documentation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>file_path</strong> (<em>path</em>) – Location of file to check</li>
<li><strong>cp</strong> (<em>ConfigParser</em>) – The associated ConfigParser from which the
segments-generate-segment-files variable is returned.
It is recommended for most applications to use the default option by
leaving segments-generate-segment-files blank, which will regenerate
all segment files at runtime. Only use this facility if you need it.
Choices are
* ‘always’ : DEFAULT: All files will be generated even if they already exist.
* ‘if_not_present’: Files will be generated if they do not already exist. Pre-existing files will be read in and used.
* ‘error_on_duplicate’: Files will be generated if they do not already exist. Pre-existing files will raise a failure.
* ‘never’: Pre-existing files will be read in and used. If no file exists the code will fail.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">1 = Generate the file. 0 = File already exists, use it. Other cases
will raise an error.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">pycbc.workflow.segment.</code><code class="descname">find_playground_segments</code><span class="sig-paren">(</span><em>segs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycbc/workflow/segment.html#find_playground_segments"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Finds playground time in a list of segments.</p>
<p>Playground segments include the first 600s of every 6370s stride starting
at GPS time 729273613.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>segs</strong> (<em>segmentfilelist</em>) – A segmentfilelist to find playground segments.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>outlist</strong> – A segmentfilelist with all playground segments during the input
segmentfilelist (ie. segs).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">segmentfilelist</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">pycbc.workflow.segment.</code><code class="descname">generate_triggered_segment</code><span class="sig-paren">(</span><em>workflow</em>, <em>out_dir</em>, <em>sciencesegs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycbc/workflow/segment.html#generate_triggered_segment"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="function">
<dt>
<code class="descclassname">pycbc.workflow.segment.</code><code class="descname">get_analyzable_segments</code><span class="sig-paren">(</span><em>workflow</em>, <em>sci_segs</em>, <em>cat_files</em>, <em>out_dir</em>, <em>tags=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycbc/workflow/segment.html#get_analyzable_segments"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Get the analyzable segments after applying ini specified vetoes and any
other restrictions on the science segs, e.g. a minimum segment length, or
demanding that only coincident segments are analysed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>workflow</strong> (<em>Workflow object</em>) – Instance of the workflow object</li>
<li><strong>sci_segs</strong> (<em>Ifo-keyed dictionary of glue.segmentlists</em>) – The science segments for each ifo to which the vetoes, or any other
restriction, will be applied.</li>
<li><strong>cat_files</strong> (<em>FileList of SegFiles</em>) – The category veto files generated by get_veto_segs</li>
<li><strong>out_dir</strong> (<em>path</em>) – Location to store output files</li>
<li><strong>tags</strong> (<em>list of strings</em>) – Used to retrieve subsections of the ini file for
configuration options.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>sci_ok_seg_file</strong> (<em>workflow.core.SegFile instance</em>) – The segment file combined from all ifos containing the analyzable
science segments.</li>
<li><strong>sci_ok_segs</strong> (<em>Ifo keyed dict of ligo.segments.segmentlist instances</em>) – The analyzable science segs for each ifo, keyed by ifo</li>
<li><strong>sci_ok_seg_name</strong> (<em>str</em>) – The name with which analyzable science segs are stored in the output
XML file.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">pycbc.workflow.segment.</code><code class="descname">get_cumulative_segs</code><span class="sig-paren">(</span><em>workflow</em>, <em>categories</em>, <em>seg_files_list</em>, <em>out_dir</em>, <em>tags=None</em>, <em>execute_now=False</em>, <em>segment_name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycbc/workflow/segment.html#get_cumulative_segs"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Function to generate one of the cumulative, multi-detector segment files
as part of the workflow.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>workflow</strong> (<a class="reference internal" href="../pycbc.workflow.html#pycbc.workflow.core.Workflow" title="pycbc.workflow.core.Workflow"><em>pycbc.workflow.core.Workflow</em></a>) – An instance of the Workflow class that manages the workflow.</li>
<li><strong>categories</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – The veto categories to include in this cumulative veto.</li>
<li><strong>seg_files_list</strong> (<em>Listionary of SegFiles</em>) – The list of segment files to be used as input for combining.</li>
<li><strong>out_dir</strong> (<em>path</em>) – The directory to write output to.</li>
<li><strong>tags</strong> (<em>list of strings</em><em>, </em><em>optional</em>) – A list of strings that is used to identify this job</li>
<li><strong>execute_now</strong> (<em>boolean</em><em>, </em><em>optional</em>) – If true, jobs are executed immediately. If false, they are added to the
workflow to be run later.</li>
<li><strong>segment_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – The name of the combined, cumulative segments in the output file.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">pycbc.workflow.segment.</code><code class="descname">get_cumulative_veto_group_files</code><span class="sig-paren">(</span><em>workflow</em>, <em>option</em>, <em>cat_files</em>, <em>out_dir</em>, <em>execute_now=True</em>, <em>tags=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycbc/workflow/segment.html#get_cumulative_veto_group_files"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Get the cumulative veto files that define the different backgrounds
we want to analyze, defined by groups of vetos.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>workflow</strong> (<em>Workflow object</em>) – Instance of the workflow object</li>
<li><strong>option</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – ini file option to use to get the veto groups</li>
<li><strong>cat_files</strong> (<em>FileList of SegFiles</em>) – The category veto files generated by get_veto_segs</li>
<li><strong>out_dir</strong> (<em>path</em>) – Location to store output files</li>
<li><strong>execute_now</strong> (<em>Boolean</em>) – If true outputs are generated at runtime. Else jobs go into the workflow
and are generated then.</li>
<li><strong>tags</strong> (<em>list of strings</em>) – Used to retrieve subsections of the ini file for
configuration options.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>seg_files</strong> (<em>workflow.core.FileList instance</em>) – The cumulative segment files for each veto group.</li>
<li><strong>names</strong> (<em>list of strings</em>) – The segment names for the corresponding seg_file</li>
<li><strong>cat_files</strong> (<em>workflow.core.FileList instance</em>) – The list of individual category veto files</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">pycbc.workflow.segment.</code><code class="descname">get_files_for_vetoes</code><span class="sig-paren">(</span><em>workflow</em>, <em>out_dir</em>, <em>runtime_names=None</em>, <em>in_workflow_names=None</em>, <em>tags=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycbc/workflow/segment.html#get_files_for_vetoes"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Get the various sets of veto segments that will be used in this analysis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>workflow</strong> (<em>Workflow object</em>) – Instance of the workflow object</li>
<li><strong>out_dir</strong> (<em>path</em>) – Location to store output files</li>
<li><strong>runtime_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – Veto category groups with these names in the [workflow-segment] section
of the ini file will be generated now.</li>
<li><strong>in_workflow_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – Veto category groups with these names in the [workflow-segment] section
of the ini file will be generated in the workflow. If a veto category
appears here and in runtime_names, it will be generated now.</li>
<li><strong>tags</strong> (<em>list of strings</em>) – Used to retrieve subsections of the ini file for
configuration options.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>veto_seg_files</strong> – List of veto segment files generated</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="../pycbc.workflow.html#pycbc.workflow.core.FileList" title="pycbc.workflow.core.FileList">FileList</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">pycbc.workflow.segment.</code><code class="descname">get_sci_segs_for_ifo</code><span class="sig-paren">(</span><em>ifo</em>, <em>cp</em>, <em>start_time</em>, <em>end_time</em>, <em>out_dir</em>, <em>tags=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycbc/workflow/segment.html#get_sci_segs_for_ifo"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Obtain science segments for the selected ifo</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ifo</strong> (<em>string</em>) – The string describing the ifo to obtain science times for.</li>
<li><strong>start_time</strong> (<em>gps time</em><em> (</em><em>either int/LIGOTimeGPS</em><em>)</em>) – The time at which to begin searching for segments.</li>
<li><strong>end_time</strong> (<em>gps time</em><em> (</em><em>either int/LIGOTimeGPS</em><em>)</em>) – The time at which to stop searching for segments.</li>
<li><strong>out_dir</strong> (<em>path</em>) – The directory in which output will be stored.</li>
<li><strong>tag</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default=None</em><em>)</em>) – Use this to specify a tag. This can be used if this module is being
called more than once to give call specific configuration (by setting
options in [workflow-datafind-${TAG}] rather than [workflow-datafind]).
This is also used to tag the Files returned by the class to uniqueify
the Files and uniqueify the actual filename.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>sci_segs</strong> (<em>ligo.segments.segmentlist</em>) – The segmentlist generated by this call</li>
<li><strong>sci_xml_file</strong> (<em>pycbc.workflow.core.SegFile</em>) – The workflow File object corresponding to this science segments file.</li>
<li><strong>out_sci_seg_name</strong> (<em>string</em>) – The name of the output segment list in the output XML file.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">pycbc.workflow.segment.</code><code class="descname">get_science_segments</code><span class="sig-paren">(</span><em>workflow</em>, <em>out_dir</em>, <em>tags=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycbc/workflow/segment.html#get_science_segments"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Get the analyzable segments after applying ini specified vetoes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>workflow</strong> (<em>Workflow object</em>) – Instance of the workflow object</li>
<li><strong>out_dir</strong> (<em>path</em>) – Location to store output files</li>
<li><strong>tags</strong> (<em>list of strings</em>) – Used to retrieve subsections of the ini file for
configuration options.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>sci_seg_file</strong> (<em>workflow.core.SegFile instance</em>) – The segment file combined from all ifos containing the science segments.</li>
<li><strong>sci_segs</strong> (<em>Ifo keyed dict of ligo.segments.segmentlist instances</em>) – The science segs for each ifo, keyed by ifo</li>
<li><strong>sci_seg_name</strong> (<em>str</em>) – The name with which science segs are stored in the output XML file.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">pycbc.workflow.segment.</code><code class="descname">get_segments_file</code><span class="sig-paren">(</span><em>workflow</em>, <em>name</em>, <em>option_name</em>, <em>out_dir</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycbc/workflow/segment.html#get_segments_file"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Get cumulative segments from option name syntax for each ifo.</p>
<p>Use syntax of configparser string to define the resulting segment_file
e.x. option_name = +up_flag1,+up_flag2,+up_flag3,-down_flag1,-down_flag2
Each ifo may have a different string and is stored separately in the file.
Flags which add time must precede flags which subtract time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>workflow</strong> (<em>pycbc.workflow.Workflow</em>) – </li>
<li><strong>name</strong> (<em>string</em>) – Name of the segment list being created</li>
<li><strong>option_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Name of option in the associated config parser to get the flag list</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>seg_file</strong> – SegFile intance that points to the segment xml file on disk.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pycbc.workflow.SegFile</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">pycbc.workflow.segment.</code><code class="descname">get_triggered_coherent_segment</code><span class="sig-paren">(</span><em>workflow</em>, <em>sciencesegs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycbc/workflow/segment.html#get_triggered_coherent_segment"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Construct the coherent network on and off source segments. Can switch to
construction of segments for a single IFO search when coherent segments
are insufficient for a search.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>workflow</strong> (<a class="reference internal" href="../pycbc.workflow.html#pycbc.workflow.core.Workflow" title="pycbc.workflow.core.Workflow"><em>pycbc.workflow.core.Workflow</em></a>) – The workflow instance that the calculated segments belong to.</li>
<li><strong>sciencesegs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a>) – Dictionary of all science segments within analysis time.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>onsource</strong> (<em>ligo.segments.segmentlistdict</em>) – A dictionary containing the on source segments for network IFOs</li>
<li><strong>offsource</strong> (<em>ligo.segments.segmentlistdict</em>) – A dictionary containing the off source segments for network IFOs</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">pycbc.workflow.segment.</code><code class="descname">get_veto_segs</code><span class="sig-paren">(</span><em>workflow</em>, <em>ifo</em>, <em>category</em>, <em>start_time</em>, <em>end_time</em>, <em>out_dir</em>, <em>veto_gen_job</em>, <em>tags=None</em>, <em>execute_now=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycbc/workflow/segment.html#get_veto_segs"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Obtain veto segments for the selected ifo and veto category and add the job
to generate this to the workflow.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>workflow</strong> (<a class="reference internal" href="../pycbc.workflow.html#pycbc.workflow.core.Workflow" title="pycbc.workflow.core.Workflow"><em>pycbc.workflow.core.Workflow</em></a>) – An instance of the Workflow class that manages the workflow.</li>
<li><strong>ifo</strong> (<em>string</em>) – The string describing the ifo to generate vetoes for.</li>
<li><strong>category</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – The veto category to generate vetoes for.</li>
<li><strong>start_time</strong> (<em>gps time</em><em> (</em><em>either int/LIGOTimeGPS</em><em>)</em>) – The time at which to begin searching for segments.</li>
<li><strong>end_time</strong> (<em>gps time</em><em> (</em><em>either int/LIGOTimeGPS</em><em>)</em>) – The time at which to stop searching for segments.</li>
<li><strong>out_dir</strong> (<em>path</em>) – The directory in which output will be stored.</li>
<li><strong>vetoGenJob</strong> (<em>Job</em>) – The veto generation Job class that will be used to create the Node.</li>
<li><strong>tag</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default=None</em><em>)</em>) – Use this to specify a tag. This can be used if this module is being
called more than once to give call specific configuration (by setting
options in [workflow-datafind-${TAG}] rather than [workflow-datafind]).
This is also used to tag the Files returned by the class to uniqueify
the Files and uniqueify the actual filename.
FIXME: Filenames may not be unique with current codes!</li>
<li><strong>execute_now</strong> (<em>boolean</em><em>, </em><em>optional</em>) – If true, jobs are executed immediately. If false, they are added to the
workflow to be run later.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>veto_def_file</strong> – The workflow File object corresponding to this DQ veto file.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="../pycbc.workflow.html#pycbc.workflow.core.SegFile" title="pycbc.workflow.core.SegFile">pycbc.workflow.core.SegFile</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">pycbc.workflow.segment.</code><code class="descname">parse_cat_ini_opt</code><span class="sig-paren">(</span><em>cat_str</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycbc/workflow/segment.html#parse_cat_ini_opt"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Parse a cat str from the ini file into a list of sets</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">pycbc.workflow.segment.</code><code class="descname">save_veto_definer</code><span class="sig-paren">(</span><em>cp</em>, <em>out_dir</em>, <em>tags=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycbc/workflow/segment.html#save_veto_definer"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Retrieve the veto definer file and save it locally</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cp</strong> (<em>ConfigParser instance</em>) – </li>
<li><strong>out_dir</strong> (<em>path</em>) – </li>
<li><strong>tags</strong> (<em>list of strings</em>) – Used to retrieve subsections of the ini file for
configuration options.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">pycbc.workflow.segment.</code><code class="descname">setup_segment_gen_mixed</code><span class="sig-paren">(</span><em>workflow</em>, <em>veto_categories</em>, <em>out_dir</em>, <em>maxVetoAtRunTime</em>, <em>tag=None</em>, <em>generate_coincident_segs=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycbc/workflow/segment.html#setup_segment_gen_mixed"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>This function will generate veto files for each ifo and for each veto
category.
It can generate these vetoes at run-time or in the workflow (or do some at
run-time and some in the workflow). However, the CAT_1 vetoes and science
time must be generated at run time as they are needed to plan the workflow.
CATs 2 and higher <em>may</em> be needed for other workflow construction.
It can also combine these files to create a set of cumulative,
multi-detector veto files, which can be used in ligolw_thinca and in
pipedown. Again these can be created at run time or within the workflow.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>workflow</strong> (<a class="reference internal" href="../pycbc.workflow.html#pycbc.workflow.core.Workflow" title="pycbc.workflow.core.Workflow"><em>pycbc.workflow.core.Workflow</em></a>) – The Workflow instance that the coincidence jobs will be added to.
This instance also contains the ifos for which to attempt to obtain
segments for this analysis and the start and end times to search for
segments over.</li>
<li><strong>veto_categories</strong> (<em>list of ints</em>) – List of veto categories to generate segments for. If this stops being
integers, this can be changed here.</li>
<li><strong>out_dir</strong> (<em>path</em>) – The directory in which output will be stored.</li>
<li><strong>maxVetoAtRunTime</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – Generate veto files at run time up to this category. Veto categories
beyond this in veto_categories will be generated in the workflow.
If we move to a model where veto
categories are not explicitly cumulative, this will be rethought.</li>
<li><strong>tag</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default=None</em><em>)</em>) – Use this to specify a tag. This can be used if this module is being
called more than once to give call specific configuration (by setting
options in [workflow-datafind-${TAG}] rather than [workflow-datafind]). This
is also used to tag the Files returned by the class to uniqueify
the Files and uniqueify the actual filename.
FIXME: Filenames may not be unique with current codes!</li>
<li><strong>generate_coincident_segs</strong> (<em>boolean</em><em>, </em><em>optional</em><em> (</em><em>default = True</em><em>)</em>) – If given this module will generate a set of coincident, cumulative veto
files that can be used with ligolw_thinca and pipedown.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>segFilesList</strong> – These are representations of the various segment files that were
constructed
at this stage of the workflow and may be needed at later stages of the
analysis (e.g. for performing DQ vetoes). If the file was generated at
run-time the segment lists contained within these files will be an
attribute
of the instance. (If it will be generated in the workflow it will
not be because I am not psychic).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dictionary of pycbc.workflow.core.SegFile instances</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">pycbc.workflow.segment.</code><code class="descname">setup_segment_generation</code><span class="sig-paren">(</span><em>workflow</em>, <em>out_dir</em>, <em>tag=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycbc/workflow/segment.html#setup_segment_generation"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>This function is the gateway for setting up the segment generation steps in a
workflow. It is designed to be able to support multiple ways of obtaining
these segments and to combine/edit such files as necessary for analysis.
The current modules have the capability to generate files at runtime or to
generate files that are not needed for workflow generation within the workflow.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>workflow</strong> (<a class="reference internal" href="../pycbc.workflow.html#pycbc.workflow.core.Workflow" title="pycbc.workflow.core.Workflow"><em>pycbc.workflow.core.Workflow</em></a>) – The workflow instance that the coincidence jobs will be added to.
This instance also contains the ifos for which to attempt to obtain
segments for this analysis and the start and end times to search for
segments over.</li>
<li><strong>out_dir</strong> (<em>path</em>) – The directory in which output will be stored.</li>
<li><strong>tag</strong> (<em>string</em><em>, </em><em>optional</em><em> (</em><em>default=None</em><em>)</em>) – Use this to specify a tag. This can be used if this module is being
called more than once to give call specific configuration (by setting
options in [workflow-datafind-${TAG}] rather than [workflow-datafind]). This
is also used to tag the Files returned by the class to uniqueify
the Files and uniqueify the actual filename.
FIXME: Filenames may not be unique with current codes!</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>segsToAnalyse</strong> (<em>dictionay of ifo-keyed glue.segment.segmentlist instances</em>) – This will contain the times that your code should analyse. By default this
is science time - CAT_1 vetoes. (This default could be changed if desired)</li>
<li><strong>segFilesList</strong> (<em>pycbc.workflow.core.FileList of SegFile instances</em>) – These are representations of the various segment files that were constructed
at this stage of the workflow and may be needed at later stages of the
analysis (e.g. for performing DQ vetoes). If the file was generated at
run-time the segment lists contained within these files will be an attribute
of the instance. (If it will be generated in the workflow it will not be
because I am not psychic).</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="initialization.html" class="btn btn-neutral float-left" title="Pycbc’s workflow module configuration file(s) and command line interface" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="datafind.html" class="btn btn-neutral float-right" title="The workflow datafind and validation module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2015, 2016, 2017, Alexander Nitz, Ian Harry, Christopher M. Biwer, Duncan A.  Brown, Josh Willis, and Tito Dal Canton.
      <span class="lastupdated">Last updated on Oct 20, 2021.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>