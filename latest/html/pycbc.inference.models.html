

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pycbc.inference.models package &mdash; PyCBC 2.10.dev1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=751f435e"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/typed.min.js?v=edb71f0b"></script>
      <script src="_static/terminal.css?v=d691274a"></script>
      <script src="_static/theme_overrides.css?v=e4e1d026"></script>
      <script src="_static/design-tabs.js?v=f930bc37"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="pycbc.inference.sampler package" href="pycbc.inference.sampler.html" />
    <link rel="prev" title="pycbc.inference.jump package" href="pycbc.inference.jump.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: linear-gradient(0deg, rgba(0,0,0,1) 0%, rgba(193,193,255,1) 85%)" >

          
          
          <a href="index.html">
            
              <img src="https://raw.githubusercontent.com/gwastro/pycbc-logo/master/pycbc_logo_name.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installing PyCBC</a></li>
<li class="toctree-l1"><a class="reference internal" href="credit.html">Use of PyCBC in Scientific Publications</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Modules</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="pycbc.html">pycbc package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="pycbc.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="pycbc.catalog.html">pycbc.catalog package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.coordinates.html">pycbc.coordinates package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.detector.html">pycbc.detector package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.distributions.html">pycbc.distributions package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.events.html">pycbc.events package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.fft.html">pycbc.fft package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.filter.html">pycbc.filter package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.frame.html">pycbc.frame package</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="pycbc.inference.html">pycbc.inference package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.inject.html">pycbc.inject package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.io.html">pycbc.io package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.live.html">pycbc.live package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.neutron_stars.html">pycbc.neutron_stars package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.noise.html">pycbc.noise package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.population.html">pycbc.population package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.psd.html">pycbc.psd package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.results.html">pycbc.results package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.strain.html">pycbc.strain package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.tmpltbank.html">pycbc.tmpltbank package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.types.html">pycbc.types package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.vetoes.html">pycbc.vetoes package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.waveform.html">pycbc.waveform package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.workflow.html">pycbc.workflow package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.bin_utils">pycbc.bin_utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.boundaries">pycbc.boundaries module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.constants">pycbc.constants module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.conversions">pycbc.conversions module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.cosmology">pycbc.cosmology module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.dq">pycbc.dq module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.libutils">pycbc.libutils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.mchirp_area">pycbc.mchirp_area module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.opt">pycbc.opt module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.pnutils">pycbc.pnutils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.pool">pycbc.pool module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.rate">pycbc.rate module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.scheme">pycbc.scheme module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.sensitivity">pycbc.sensitivity module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.time">pycbc.time module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.transforms">pycbc.transforms module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.version">pycbc.version module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="genindex.html">Index</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Library Examples and Interactive Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="searches.html">PyCBC searches</a></li>
<li class="toctree-l1"><a class="reference internal" href="inference.html">PyCBC inference documentation (<code class="docutils literal notranslate"><span class="pre">pycbc.inference</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="apps.html">Applications and Workflows</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Dev Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="extend.html">Extending PyCBC with external plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="devs.html">Documentation for Developers</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: linear-gradient(0deg, rgba(0,0,0,1) 0%, rgba(193,193,255,1) 85%)" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PyCBC</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">pycbc</a></li>
          <li class="breadcrumb-item"><a href="pycbc.html">pycbc package</a></li>
          <li class="breadcrumb-item"><a href="pycbc.inference.html">pycbc.inference package</a></li>
      <li class="breadcrumb-item active">pycbc.inference.models package</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/gwastro/pycbc/blob/master/docs/pycbc.inference.models.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pycbc-inference-models-package">
<h1>pycbc.inference.models package<a class="headerlink" href="#pycbc-inference-models-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-pycbc.inference.models.analytic">
<span id="pycbc-inference-models-analytic-module"></span><h2>pycbc.inference.models.analytic module<a class="headerlink" href="#module-pycbc.inference.models.analytic" title="Link to this heading"></a></h2>
<p>This modules provides models that have analytic solutions for the
log likelihood.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.analytic.TestEggbox">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.analytic.</span></span><span class="sig-name descname"><span class="pre">TestEggbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/analytic.html#TestEggbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.analytic.TestEggbox" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.models.base.BaseModel" title="pycbc.inference.models.base.BaseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></a></p>
<p>The test distribution is an ‘eggbox’ function:</p>
<div class="math notranslate nohighlight">
\[\log \mathcal{L}(\Theta) = \left[
    2+\prod_{i=1}^{n}\cos\left(\frac{\theta_{i}}{2}\right)\right]^{5}\]</div>
<p>The number of dimensions is set by the number of <code class="docutils literal notranslate"><span class="pre">variable_params</span></code> that
are passed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variable_params</strong> (<em>(</em><em>tuple of</em><em>) </em><em>string</em><em>(</em><em>s</em><em>)</em>) – A tuple of parameter names that will be varied.</p></li>
<li><p><strong>**kwargs</strong> – All other keyword arguments are passed to <code class="docutils literal notranslate"><span class="pre">BaseModel</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.analytic.TestEggbox.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'test_eggbox'</span></em><a class="headerlink" href="#pycbc.inference.models.analytic.TestEggbox.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.analytic.TestNormal">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.analytic.</span></span><span class="sig-name descname"><span class="pre">TestNormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/analytic.html#TestNormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.analytic.TestNormal" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.models.base.BaseModel" title="pycbc.inference.models.base.BaseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></a></p>
<p>The test distribution is an multi-variate normal distribution.</p>
<p>The number of dimensions is set by the number of <code class="docutils literal notranslate"><span class="pre">variable_params</span></code> that
are passed. For details on the distribution used, see
<code class="docutils literal notranslate"><span class="pre">scipy.stats.multivariate_normal</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variable_params</strong> (<em>(</em><em>tuple of</em><em>) </em><em>string</em><em>(</em><em>s</em><em>)</em>) – A tuple of parameter names that will be varied.</p></li>
<li><p><strong>mean</strong> (<em>array-like</em><em>, </em><em>optional</em>) – The mean values of the parameters. If None provide, will use 0 for all
parameters.</p></li>
<li><p><strong>cov</strong> (<em>array-like</em><em>, </em><em>optional</em>) – The covariance matrix of the parameters. If None provided, will use
unit variance for all parameters, with cross-terms set to 0.</p></li>
<li><p><strong>**kwargs</strong> – All other keyword arguments are passed to <code class="docutils literal notranslate"><span class="pre">BaseModel</span></code>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create a 2D model with zero mean and unit variance:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">TestNormal</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Set the current parameters and evaluate the log posterior:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">logposterior</span>
<span class="go">-1.8628770664093453</span>
</pre></div>
</div>
<p>See the current stats that were evaluated:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">current_stats</span>
<span class="go">{&#39;logjacobian&#39;: 0.0, &#39;loglikelihood&#39;: -1.8628770664093453, &#39;logprior&#39;: 0.0}</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.analytic.TestNormal.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'test_normal'</span></em><a class="headerlink" href="#pycbc.inference.models.analytic.TestNormal.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.analytic.TestPosterior">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.analytic.</span></span><span class="sig-name descname"><span class="pre">TestPosterior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posterior_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/analytic.html#TestPosterior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.analytic.TestPosterior" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.models.base.BaseModel" title="pycbc.inference.models.base.BaseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></a></p>
<p>Build a test posterior from a set of samples using a kde</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variable_params</strong> (<em>(</em><em>tuple of</em><em>) </em><em>string</em><em>(</em><em>s</em><em>)</em>) – A tuple of parameter names that will be varied.</p></li>
<li><p><strong>posterior_file</strong> (<em>hdf file</em>) – A compatible pycbc inference output file which posterior samples can
be read from.</p></li>
<li><p><strong>nsamples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Number of samples to draw from posterior file to build KDE.</p></li>
<li><p><strong>**kwargs</strong> – All other keyword arguments are passed to <code class="docutils literal notranslate"><span class="pre">BaseModel</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.analytic.TestPosterior.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'test_posterior'</span></em><a class="headerlink" href="#pycbc.inference.models.analytic.TestPosterior.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.analytic.TestPrior">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.analytic.</span></span><span class="sig-name descname"><span class="pre">TestPrior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/analytic.html#TestPrior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.analytic.TestPrior" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.models.base.BaseModel" title="pycbc.inference.models.base.BaseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></a></p>
<p>Uses the prior as the test distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variable_params</strong> (<em>(</em><em>tuple of</em><em>) </em><em>string</em><em>(</em><em>s</em><em>)</em>) – A tuple of parameter names that will be varied. Must have length 2.</p></li>
<li><p><strong>**kwargs</strong> – All other keyword arguments are passed to <code class="docutils literal notranslate"><span class="pre">BaseModel</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.analytic.TestPrior.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'test_prior'</span></em><a class="headerlink" href="#pycbc.inference.models.analytic.TestPrior.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.analytic.TestRosenbrock">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.analytic.</span></span><span class="sig-name descname"><span class="pre">TestRosenbrock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/analytic.html#TestRosenbrock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.analytic.TestRosenbrock" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.models.base.BaseModel" title="pycbc.inference.models.base.BaseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></a></p>
<p>The test distribution is the Rosenbrock function:</p>
<div class="math notranslate nohighlight">
\[\log \mathcal{L}(\Theta) = -\sum_{i=1}^{n-1}[
    (1-\theta_{i})^{2}+100(\theta_{i+1} - \theta_{i}^{2})^{2}]\]</div>
<p>The number of dimensions is set by the number of <code class="docutils literal notranslate"><span class="pre">variable_params</span></code> that
are passed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variable_params</strong> (<em>(</em><em>tuple of</em><em>) </em><em>string</em><em>(</em><em>s</em><em>)</em>) – A tuple of parameter names that will be varied.</p></li>
<li><p><strong>**kwargs</strong> – All other keyword arguments are passed to <code class="docutils literal notranslate"><span class="pre">BaseModel</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.analytic.TestRosenbrock.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'test_rosenbrock'</span></em><a class="headerlink" href="#pycbc.inference.models.analytic.TestRosenbrock.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.analytic.TestVolcano">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.analytic.</span></span><span class="sig-name descname"><span class="pre">TestVolcano</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/analytic.html#TestVolcano"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.analytic.TestVolcano" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.models.base.BaseModel" title="pycbc.inference.models.base.BaseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></a></p>
<p>The test distribution is a two-dimensional ‘volcano’ function:</p>
<div class="math notranslate nohighlight">
\[\Theta =
    \sqrt{\theta_{1}^{2} + \theta_{2}^{2}} \log \mathcal{L}(\Theta) =
    25\left(e^{\frac{-\Theta}{35}} +
            \frac{1}{2\sqrt{2\pi}} e^{-\frac{(\Theta-5)^{2}}{8}}\right)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variable_params</strong> (<em>(</em><em>tuple of</em><em>) </em><em>string</em><em>(</em><em>s</em><em>)</em>) – A tuple of parameter names that will be varied. Must have length 2.</p></li>
<li><p><strong>**kwargs</strong> – All other keyword arguments are passed to <code class="docutils literal notranslate"><span class="pre">BaseModel</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.analytic.TestVolcano.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'test_volcano'</span></em><a class="headerlink" href="#pycbc.inference.models.analytic.TestVolcano.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-pycbc.inference.models.base">
<span id="pycbc-inference-models-base-module"></span><h2>pycbc.inference.models.base module<a class="headerlink" href="#module-pycbc.inference.models.base" title="Link to this heading"></a></h2>
<p>Base class for models.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.base.BaseModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.base.</span></span><span class="sig-name descname"><span class="pre">BaseModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">static_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_transforms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">waveform_transforms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/base.html#BaseModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.base.BaseModel" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Base class for all models.</p>
<p>Given some model <span class="math notranslate nohighlight">\(h\)</span> with parameters <span class="math notranslate nohighlight">\(\Theta\)</span>, Bayes Theorem
states that the probability of observing parameter values <span class="math notranslate nohighlight">\(\vartheta\)</span>
is:</p>
<div class="math notranslate nohighlight">
\[p(\vartheta|h) = \frac{p(h|\vartheta) p(\vartheta)}{p(h)}.\]</div>
<p>Here:</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p(\vartheta|h)\)</span> is the <strong>posterior</strong> probability;</p></li>
<li><p><span class="math notranslate nohighlight">\(p(h|\vartheta)\)</span> is the <strong>likelihood</strong>;</p></li>
<li><p><span class="math notranslate nohighlight">\(p(\vartheta)\)</span> is the <strong>prior</strong>;</p></li>
<li><p><span class="math notranslate nohighlight">\(p(h)\)</span> is the <strong>evidence</strong>.</p></li>
</ul>
</div></blockquote>
<p>This class defines properties and methods for evaluating the log
likelihood, log prior, and log posteror. A set of parameter values is set
using the <code class="docutils literal notranslate"><span class="pre">update</span></code> method. Calling the class’s
<code class="docutils literal notranslate"><span class="pre">log(likelihood|prior|posterior)</span></code> properties will then evaluate the model
at those parameter values.</p>
<p>Classes that inherit from this class must implement a <code class="docutils literal notranslate"><span class="pre">_loglikelihood</span></code>
function that can be called by <code class="docutils literal notranslate"><span class="pre">loglikelihood</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variable_params</strong> (<em>(</em><em>tuple of</em><em>) </em><em>string</em><em>(</em><em>s</em><em>)</em>) – A tuple of parameter names that will be varied.</p></li>
<li><p><strong>static_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><em>optional</em>) – A dictionary of parameter names -&gt; values to keep fixed.</p></li>
<li><p><strong>prior</strong> (<em>callable</em><em>, </em><em>optional</em>) – A callable class or function that computes the log of the prior. If
None provided, will use <code class="docutils literal notranslate"><span class="pre">_noprior</span></code>, which returns 0 for all parameter
values.</p></li>
<li><p><strong>sampling_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em>, </em><em>optional</em>) – Replace one or more of the <code class="docutils literal notranslate"><span class="pre">variable_params</span></code> with the given
parameters for sampling.</p></li>
<li><p><strong>replace_parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em>, </em><em>optional</em>) – The <code class="docutils literal notranslate"><span class="pre">variable_params</span></code> to replace with sampling parameters. Must be
the same length as <code class="docutils literal notranslate"><span class="pre">sampling_params</span></code>.</p></li>
<li><p><strong>sampling_transforms</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em>, </em><em>optional</em>) – List of transforms to use to go between the <code class="docutils literal notranslate"><span class="pre">variable_params</span></code> and the
sampling parameters. Required if <code class="docutils literal notranslate"><span class="pre">sampling_params</span></code> is not None.</p></li>
<li><p><strong>waveform_transforms</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em>, </em><em>optional</em>) – A list of transforms to convert the <code class="docutils literal notranslate"><span class="pre">variable_params</span></code> into something
understood by the likelihood model. This is useful if the prior is
more easily parameterized in parameters that are different than what
the likelihood is most easily defined in. Since these are used solely
for converting parameters, and not for rescaling the parameter space,
a Jacobian is not required for these transforms.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.base.BaseModel.current_params">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">current_params</span></span><a class="headerlink" href="#pycbc.inference.models.base.BaseModel.current_params" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.base.BaseModel.current_stats">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">current_stats</span></span><a class="headerlink" href="#pycbc.inference.models.base.BaseModel.current_stats" title="Link to this definition"></a></dt>
<dd><p>Return the <code class="docutils literal notranslate"><span class="pre">default_stats</span></code> as a dict.</p>
<p>This does no computation. It only returns what has already been
calculated. If a stat hasn’t been calculated, it will be returned
as <code class="docutils literal notranslate"><span class="pre">numpy.nan</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary of stat names -&gt; current stat values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.base.BaseModel.default_stats">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_stats</span></span><a class="headerlink" href="#pycbc.inference.models.base.BaseModel.default_stats" title="Link to this definition"></a></dt>
<dd><p>The stats that <code class="docutils literal notranslate"><span class="pre">get_current_stats</span></code> returns by default.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.base.BaseModel.extra_args_from_config">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">extra_args_from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">section</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtypes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/base.html#BaseModel.extra_args_from_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.base.BaseModel.extra_args_from_config" title="Link to this definition"></a></dt>
<dd><p>Gets any additional keyword in the given config file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cp</strong> (<a class="reference internal" href="pycbc.workflow.html#pycbc.workflow.configuration.WorkflowConfigParser" title="pycbc.workflow.configuration.WorkflowConfigParser"><em>WorkflowConfigParser</em></a>) – Config file parser to read.</p></li>
<li><p><strong>section</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The name of the section to read.</p></li>
<li><p><strong>skip_args</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – Names of arguments to skip.</p></li>
<li><p><strong>dtypes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><em>optional</em>) – A dictionary of arguments -&gt; data types. If an argument is found
in the dict, it will be cast to the given datatype. Otherwise, the
argument’s value will just be read from the config file (and thus
be a string).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of keyword arguments read from the config file.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.base.BaseModel.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cp</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/base.html#BaseModel.from_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.base.BaseModel.from_config" title="Link to this definition"></a></dt>
<dd><p>Initializes an instance of this class from the given config file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cp</strong> (<a class="reference internal" href="pycbc.workflow.html#pycbc.workflow.configuration.WorkflowConfigParser" title="pycbc.workflow.configuration.WorkflowConfigParser"><em>WorkflowConfigParser</em></a>) – Config file parser to read.</p></li>
<li><p><strong>**kwargs</strong> – All additional keyword arguments are passed to the class. Any
provided keyword will over ride what is in the config file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.base.BaseModel.get_current_stats">
<span class="sig-name descname"><span class="pre">get_current_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/base.html#BaseModel.get_current_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.base.BaseModel.get_current_stats" title="Link to this definition"></a></dt>
<dd><p>Return one or more of the current stats as a tuple.</p>
<p>This function does no computation. It only returns what has already
been calculated. If a stat hasn’t been calculated, it will be returned
as <code class="docutils literal notranslate"><span class="pre">numpy.nan</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – Specify the names of the stats to retrieve. If <code class="docutils literal notranslate"><span class="pre">None</span></code> (the
default), will return <code class="docutils literal notranslate"><span class="pre">default_stats</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The current values of the requested stats, as a tuple. The order
of the stats is the same as the names.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.base.BaseModel.logjacobian">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">logjacobian</span></span><a class="headerlink" href="#pycbc.inference.models.base.BaseModel.logjacobian" title="Link to this definition"></a></dt>
<dd><p>The log jacobian of the sampling transforms at the current postion.</p>
<p>If no sampling transforms were provided, will just return 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**params</strong> – The keyword arguments should specify values for all of the variable
args and all of the sampling args.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value of the jacobian.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.base.BaseModel.loglikelihood">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">loglikelihood</span></span><a class="headerlink" href="#pycbc.inference.models.base.BaseModel.loglikelihood" title="Link to this definition"></a></dt>
<dd><p>The log likelihood at the current parameters.</p>
<p>This will initially try to return the <code class="docutils literal notranslate"><span class="pre">current_stats.loglikelihood</span></code>.
If that raises an <code class="docutils literal notranslate"><span class="pre">AttributeError</span></code>, will call <cite>_loglikelihood`</cite> to
calculate it and store it to <code class="docutils literal notranslate"><span class="pre">current_stats</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.base.BaseModel.logposterior">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">logposterior</span></span><a class="headerlink" href="#pycbc.inference.models.base.BaseModel.logposterior" title="Link to this definition"></a></dt>
<dd><p>Returns the log of the posterior of the current parameter values.</p>
<p>The logprior is calculated first. If the logprior returns <code class="docutils literal notranslate"><span class="pre">-inf</span></code>
(possibly indicating a non-physical point), then the <code class="docutils literal notranslate"><span class="pre">loglikelihood</span></code>
is not called.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.base.BaseModel.logprior">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">logprior</span></span><a class="headerlink" href="#pycbc.inference.models.base.BaseModel.logprior" title="Link to this definition"></a></dt>
<dd><p>Returns the log prior at the current parameters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.base.BaseModel.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pycbc.inference.models.base.BaseModel.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.base.BaseModel.prior_from_config">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prior_from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">static_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_section</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraint_section</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/base.html#BaseModel.prior_from_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.base.BaseModel.prior_from_config" title="Link to this definition"></a></dt>
<dd><p>Gets arguments and keyword arguments from a config file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cp</strong> (<a class="reference internal" href="pycbc.workflow.html#pycbc.workflow.configuration.WorkflowConfigParser" title="pycbc.workflow.configuration.WorkflowConfigParser"><em>WorkflowConfigParser</em></a>) – Config file parser to read.</p></li>
<li><p><strong>variable_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a>) – List of variable model parameter names.</p></li>
<li><p><strong>static_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Dictionary of static model parameters and their values.</p></li>
<li><p><strong>prior_section</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Section to read prior(s) from.</p></li>
<li><p><strong>constraint_section</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Section to read constraint(s) from.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The prior.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pycbc.distributions.JointDistribution</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.base.BaseModel.prior_rvs">
<span class="sig-name descname"><span class="pre">prior_rvs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/base.html#BaseModel.prior_rvs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.base.BaseModel.prior_rvs" title="Link to this definition"></a></dt>
<dd><p>Returns random variates drawn from the prior.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">sampling_params</span></code> are different from the <code class="docutils literal notranslate"><span class="pre">variable_params</span></code>,
the variates are transformed to the <cite>sampling_params</cite> parameter space
before being returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) – Number of random values to return for each parameter. Default is 1.</p></li>
<li><p><strong>prior</strong> (<a class="reference internal" href="pycbc.distributions.html#pycbc.distributions.joint.JointDistribution" title="pycbc.distributions.joint.JointDistribution"><em>JointDistribution</em></a><em>, </em><em>optional</em>) – Use the given prior to draw values rather than the saved prior.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A field array of the random values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="pycbc.io.html#pycbc.io.record.FieldArray" title="pycbc.io.record.FieldArray">FieldArray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.base.BaseModel.sampling_params">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sampling_params</span></span><a class="headerlink" href="#pycbc.inference.models.base.BaseModel.sampling_params" title="Link to this definition"></a></dt>
<dd><p>Returns the sampling parameters.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">sampling_transforms</span></code> is None, this is the same as the
<code class="docutils literal notranslate"><span class="pre">variable_params</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.base.BaseModel.static_params">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">static_params</span></span><a class="headerlink" href="#pycbc.inference.models.base.BaseModel.static_params" title="Link to this definition"></a></dt>
<dd><p>Returns the model’s static arguments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.base.BaseModel.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/base.html#BaseModel.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.base.BaseModel.update" title="Link to this definition"></a></dt>
<dd><p>Updates the current parameter positions and resets stats.</p>
<p>If any sampling transforms are specified, they are applied to the
params before being stored.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.base.BaseModel.variable_params">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">variable_params</span></span><a class="headerlink" href="#pycbc.inference.models.base.BaseModel.variable_params" title="Link to this definition"></a></dt>
<dd><p>Returns the model parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.base.BaseModel.write_metadata">
<span class="sig-name descname"><span class="pre">write_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/base.html#BaseModel.write_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.base.BaseModel.write_metadata" title="Link to this definition"></a></dt>
<dd><p>Writes metadata to the given file handler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fp</strong> (<em>pycbc.inference.io.BaseInferenceFile instance</em>) – The inference file to write to.</p></li>
<li><p><strong>group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – If provided, the metadata will be written to the attrs specified
by group, i.e., to <code class="docutils literal notranslate"><span class="pre">fp[group].attrs</span></code>. Otherwise, metadata is
written to the top-level attrs (<code class="docutils literal notranslate"><span class="pre">fp.attrs</span></code>).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.base.ModelStats">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.base.</span></span><span class="sig-name descname"><span class="pre">ModelStats</span></span><a class="reference internal" href="_modules/pycbc/inference/models/base.html#ModelStats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.base.ModelStats" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class to hold model’s current stat values.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.base.ModelStats.getstats">
<span class="sig-name descname"><span class="pre">getstats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/base.html#ModelStats.getstats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.base.ModelStats.getstats" title="Link to this definition"></a></dt>
<dd><p>Get the requested stats as a tuple.</p>
<p>If a requested stat is not an attribute (implying it hasn’t been
stored), then the default value is returned for that stat.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The names of the stats to get.</p></li>
<li><p><strong>default</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – What to return if a requested stat is not an attribute of self.
Default is <code class="docutils literal notranslate"><span class="pre">numpy.nan</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple of the requested stats.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.base.ModelStats.getstatsdict">
<span class="sig-name descname"><span class="pre">getstatsdict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/base.html#ModelStats.getstatsdict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.base.ModelStats.getstatsdict" title="Link to this definition"></a></dt>
<dd><p>Get the requested stats as a dictionary.</p>
<p>If a requested stat is not an attribute (implying it hasn’t been
stored), then the default value is returned for that stat.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The names of the stats to get.</p></li>
<li><p><strong>default</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – What to return if a requested stat is not an attribute of self.
Default is <code class="docutils literal notranslate"><span class="pre">numpy.nan</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of the requested stats.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.base.ModelStats.statnames">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">statnames</span></span><a class="headerlink" href="#pycbc.inference.models.base.ModelStats.statnames" title="Link to this definition"></a></dt>
<dd><p>Returns the names of the stats that have been stored.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.base.SamplingTransforms">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.base.</span></span><span class="sig-name descname"><span class="pre">SamplingTransforms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace_parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_transforms</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/base.html#SamplingTransforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.base.SamplingTransforms" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Provides methods for transforming between sampling parameter space and
model parameter space.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.base.SamplingTransforms.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/base.html#SamplingTransforms.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.base.SamplingTransforms.apply" title="Link to this definition"></a></dt>
<dd><p>Applies the sampling transforms to the given samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em> or </em><a class="reference internal" href="pycbc.io.html#pycbc.io.record.FieldArray" title="pycbc.io.record.FieldArray"><em>FieldArray</em></a>) – The samples to apply the transforms to.</p></li>
<li><p><strong>inverse</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to apply the inverse transforms (i.e., go from the sampling
args to the <code class="docutils literal notranslate"><span class="pre">variable_params</span></code>). Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The transformed samples, along with the original samples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a> or <a class="reference internal" href="pycbc.io.html#pycbc.io.record.FieldArray" title="pycbc.io.record.FieldArray">FieldArray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.base.SamplingTransforms.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/base.html#SamplingTransforms.from_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.base.SamplingTransforms.from_config" title="Link to this definition"></a></dt>
<dd><p>Gets sampling transforms specified in a config file.</p>
<p>Sampling parameters and the parameters they replace are read from the
<code class="docutils literal notranslate"><span class="pre">sampling_params</span></code> section, if it exists. Sampling transforms are
read from the <code class="docutils literal notranslate"><span class="pre">sampling_transforms</span></code> section(s), using
<code class="docutils literal notranslate"><span class="pre">transforms.read_transforms_from_config</span></code>.</p>
<p>An <code class="docutils literal notranslate"><span class="pre">AssertionError</span></code> is raised if no <code class="docutils literal notranslate"><span class="pre">sampling_params</span></code> section
exists in the config file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cp</strong> (<a class="reference internal" href="pycbc.workflow.html#pycbc.workflow.configuration.WorkflowConfigParser" title="pycbc.workflow.configuration.WorkflowConfigParser"><em>WorkflowConfigParser</em></a>) – Config file parser to read.</p></li>
<li><p><strong>variable_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a>) – List of parameter names of the original variable params.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A sampling transforms class.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pycbc.inference.models.base.SamplingTransforms" title="pycbc.inference.models.base.SamplingTransforms">SamplingTransforms</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.base.SamplingTransforms.logjacobian">
<span class="sig-name descname"><span class="pre">logjacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/base.html#SamplingTransforms.logjacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.base.SamplingTransforms.logjacobian" title="Link to this definition"></a></dt>
<dd><p>Returns the log of the jacobian needed to transform pdfs in the
<code class="docutils literal notranslate"><span class="pre">variable_params</span></code> parameter space to the <code class="docutils literal notranslate"><span class="pre">sampling_params</span></code>
parameter space.</p>
<p>Let <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> be the set of variable parameters,
<span class="math notranslate nohighlight">\(\mathbf{y} = f(\mathbf{x})\)</span> the set of sampling parameters, and
<span class="math notranslate nohighlight">\(p_x(\mathbf{x})\)</span> a probability density function defined over
<span class="math notranslate nohighlight">\(\mathbf{x}\)</span>.
The corresponding pdf in <span class="math notranslate nohighlight">\(\mathbf{y}\)</span> is then:</p>
<div class="math notranslate nohighlight">
\[p_y(\mathbf{y}) =
    p_x(\mathbf{x})\left|\mathrm{det}\,\mathbf{J}_{ij}\right|,\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{J}_{ij}\)</span> is the Jacobian of the inverse transform
<span class="math notranslate nohighlight">\(\mathbf{x} = g(\mathbf{y})\)</span>. This has elements:</p>
<div class="math notranslate nohighlight">
\[\mathbf{J}_{ij} = \frac{\partial g_i}{\partial{y_j}}\]</div>
<p>This function returns
<span class="math notranslate nohighlight">\(\log \left|\mathrm{det}\,\mathbf{J}_{ij}\right|\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**params</strong> – The keyword arguments should specify values for all of the variable
args and all of the sampling args.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value of the jacobian.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.base.check_for_cartesian_spins">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.base.</span></span><span class="sig-name descname"><span class="pre">check_for_cartesian_spins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">which</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">static_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">waveform_transforms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/base.html#check_for_cartesian_spins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.base.check_for_cartesian_spins" title="Link to this definition"></a></dt>
<dd><p>Checks that if any spin parameters exist, cartesian spins also exist.</p>
<p>This looks for parameters starting with <code class="docutils literal notranslate"><span class="pre">spinN</span></code> in the variable and
static params, where <code class="docutils literal notranslate"><span class="pre">N</span></code> is either  1 or 2 (specified by the <code class="docutils literal notranslate"><span class="pre">which</span></code>
argument). If any parameters are found with those names, the params and
the output of the waveform transforms are checked to see that there is
at least one of <code class="docutils literal notranslate"><span class="pre">spinN(x|y|z)</span></code>. If not, a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> is raised.</p>
<p>This check will not be done if the config file has an section given by
the ignore argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>which</strong> (<em>{1</em><em>, </em><em>2}</em>) – Which component to check for. Must be either 1 or 2.</p></li>
<li><p><strong>variable_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a>) – List of the variable parameters.</p></li>
<li><p><strong>static_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – The dictionary of static params.</p></li>
<li><p><strong>waveform_transforms</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a>) – List of the transforms that will be applied to the variable and
static params before being passed to the waveform generator.</p></li>
<li><p><strong>cp</strong> (<em>ConfigParser</em>) – The config file.</p></li>
<li><p><strong>ignore</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The section to check for in the config file. If the section is
present in the config file, the check will not be done.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.base.read_sampling_params_from_config">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.base.</span></span><span class="sig-name descname"><span class="pre">read_sampling_params_from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">section_group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">section</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sampling_params'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/base.html#read_sampling_params_from_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.base.read_sampling_params_from_config" title="Link to this definition"></a></dt>
<dd><p>Reads sampling parameters from the given config file.</p>
<p>Parameters are read from the <cite>[({section_group}_){section}]</cite> section.
The options should list the variable args to transform; the parameters they
point to should list the parameters they are to be transformed to for
sampling. If a multiple parameters are transformed together, they should
be comma separated. Example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[sampling_params]</span>
<span class="na">mass1, mass2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">mchirp, logitq</span>
<span class="na">spin1_a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">logitspin1_a</span>
</pre></div>
</div>
<p>Note that only the final sampling parameters should be listed, even if
multiple intermediate transforms are needed. (In the above example, a
transform is needed to go from mass1, mass2 to mchirp, q, then another one
needed to go from q to logitq.) These transforms should be specified
in separate sections; see <code class="docutils literal notranslate"><span class="pre">transforms.read_transforms_from_config</span></code> for
details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cp</strong> (<a class="reference internal" href="pycbc.workflow.html#pycbc.workflow.configuration.WorkflowConfigParser" title="pycbc.workflow.configuration.WorkflowConfigParser"><em>WorkflowConfigParser</em></a>) – An open config parser to read from.</p></li>
<li><p><strong>section_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – Append <cite>{section_group}_</cite> to the section name. Default is None.</p></li>
<li><p><strong>section</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – The name of the section. Default is ‘sampling_params’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>sampling_params</strong> (<em>list</em>) – The list of sampling parameters to use instead.</p></li>
<li><p><strong>replaced_params</strong> (<em>list</em>) – The list of variable args to replace in the sampler.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pycbc.inference.models.base_data">
<span id="pycbc-inference-models-base-data-module"></span><h2>pycbc.inference.models.base_data module<a class="headerlink" href="#module-pycbc.inference.models.base_data" title="Link to this heading"></a></h2>
<p>Base classes for mofdels with data.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.base_data.BaseDataModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.base_data.</span></span><span class="sig-name descname"><span class="pre">BaseDataModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recalibration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">injection_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_save_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/base_data.html#BaseDataModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.base_data.BaseDataModel" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.models.base.BaseModel" title="pycbc.inference.models.base.BaseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></a></p>
<p>Base class for models that require data and a waveform generator.</p>
<p>This adds propeties for the log of the likelihood that the data contain
noise, <code class="docutils literal notranslate"><span class="pre">lognl</span></code>, and the log likelihood ratio <code class="docutils literal notranslate"><span class="pre">loglr</span></code>.</p>
<p>Classes that inherit from this class must define <code class="docutils literal notranslate"><span class="pre">_loglr</span></code> and <code class="docutils literal notranslate"><span class="pre">_lognl</span></code>
functions, in addition to the <code class="docutils literal notranslate"><span class="pre">_loglikelihood</span></code> requirement inherited from
<code class="docutils literal notranslate"><span class="pre">BaseModel</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variable_params</strong> (<em>(</em><em>tuple of</em><em>) </em><em>string</em><em>(</em><em>s</em><em>)</em>) – A tuple of parameter names that will be varied.</p></li>
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – A dictionary of data, in which the keys are the detector names and the
values are the data.</p></li>
<li><p><strong>recalibration</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em> of </em><em>pycbc.calibration.Recalibrate</em><em>, </em><em>optional</em>) – Dictionary of detectors -&gt; recalibration class instances for
recalibrating data.</p></li>
<li><p><strong>gates</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em> of </em><em>tuples</em><em>, </em><em>optional</em>) – Dictionary of detectors -&gt; tuples of specifying gate times. The
sort of thing returned by <cite>pycbc.gate.gates_from_cli</cite>.</p></li>
<li><p><strong>injection_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – If an injection was added to the data, the name of the injection file
used. If provided, the injection parameters will be written to
file when <code class="docutils literal notranslate"><span class="pre">write_metadata</span></code> is called.</p></li>
<li><p><strong>**kwargs</strong> – All other keyword arguments are passed to <code class="docutils literal notranslate"><span class="pre">BaseModel</span></code>.</p></li>
</ul>
</dd>
</dl>
<p>See <code class="docutils literal notranslate"><span class="pre">BaseModel</span></code> for additional attributes and properties.</p>
<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.base_data.BaseDataModel.data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#pycbc.inference.models.base_data.BaseDataModel.data" title="Link to this definition"></a></dt>
<dd><p>Dictionary mapping detector names to data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.base_data.BaseDataModel.detectors">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">detectors</span></span><a class="headerlink" href="#pycbc.inference.models.base_data.BaseDataModel.detectors" title="Link to this definition"></a></dt>
<dd><p>Returns the detectors used.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.base_data.BaseDataModel.loglr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">loglr</span></span><a class="headerlink" href="#pycbc.inference.models.base_data.BaseDataModel.loglr" title="Link to this definition"></a></dt>
<dd><p>The log likelihood ratio at the current parameters,
or the inner product &lt;s|h&gt; and &lt;h|h&gt; if set the flag
<cite>self.return_sh_hh</cite> to be True.</p>
<p>This will initially try to return the <code class="docutils literal notranslate"><span class="pre">current_stats.loglr</span></code>.
If that raises an <code class="docutils literal notranslate"><span class="pre">AttributeError</span></code>, will call <cite>_loglr`</cite> to
calculate it and store it to <code class="docutils literal notranslate"><span class="pre">current_stats</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.base_data.BaseDataModel.lognl">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lognl</span></span><a class="headerlink" href="#pycbc.inference.models.base_data.BaseDataModel.lognl" title="Link to this definition"></a></dt>
<dd><p>The log likelihood of the model assuming the data is noise.</p>
<p>This will initially try to return the <code class="docutils literal notranslate"><span class="pre">current_stats.lognl</span></code>.
If that raises an <code class="docutils literal notranslate"><span class="pre">AttributeError</span></code>, will call <cite>_lognl`</cite> to
calculate it and store it to <code class="docutils literal notranslate"><span class="pre">current_stats</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.base_data.BaseDataModel.logplr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">logplr</span></span><a class="headerlink" href="#pycbc.inference.models.base_data.BaseDataModel.logplr" title="Link to this definition"></a></dt>
<dd><p>Returns the log of the prior-weighted likelihood ratio at the
current parameter values.</p>
<p>The logprior is calculated first. If the logprior returns <code class="docutils literal notranslate"><span class="pre">-inf</span></code>
(possibly indicating a non-physical point), then <code class="docutils literal notranslate"><span class="pre">loglr</span></code> is not
called.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.base_data.BaseDataModel.write_metadata">
<span class="sig-name descname"><span class="pre">write_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/base_data.html#BaseDataModel.write_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.base_data.BaseDataModel.write_metadata" title="Link to this definition"></a></dt>
<dd><p>Adds data to the metadata that’s written.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fp</strong> (<em>pycbc.inference.io.BaseInferenceFile instance</em>) – The inference file to write to.</p></li>
<li><p><strong>group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – If provided, the metadata will be written to the attrs specified
by group, i.e., to <code class="docutils literal notranslate"><span class="pre">fp[group].attrs</span></code>. Otherwise, metadata is
written to the top-level attrs (<code class="docutils literal notranslate"><span class="pre">fp.attrs</span></code>).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pycbc.inference.models.brute_marg">
<span id="pycbc-inference-models-brute-marg-module"></span><h2>pycbc.inference.models.brute_marg module<a class="headerlink" href="#module-pycbc.inference.models.brute_marg" title="Link to this heading"></a></h2>
<p>This module provides model classes that do brute force marginalization
using at the likelihood level.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.brute_marg.BruteLISASkyModesMarginalize">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.brute_marg.</span></span><span class="sig-name descname"><span class="pre">BruteLISASkyModesMarginalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loop_polarization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/brute_marg.html#BruteLISASkyModesMarginalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.brute_marg.BruteLISASkyModesMarginalize" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise" title="pycbc.inference.models.gaussian_noise.BaseGaussianNoise"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseGaussianNoise</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.brute_marg.BruteLISASkyModesMarginalize.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cp</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/brute_marg.html#BruteLISASkyModesMarginalize.from_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.brute_marg.BruteLISASkyModesMarginalize.from_config" title="Link to this definition"></a></dt>
<dd><p>Initializes an instance of this class from the given config file.</p>
<p>In addition to <code class="docutils literal notranslate"><span class="pre">[model]</span></code>, a <code class="docutils literal notranslate"><span class="pre">data_section</span></code> (default <code class="docutils literal notranslate"><span class="pre">[data]</span></code>)
must be in the configuration file. The data section specifies settings
for loading data and estimating PSDs. See the <a class="reference external" href="http://pycbc.org/pycbc/latest/html/inference.html#setting-data">online documentation</a> for
more details.</p>
<p>The following options are read from the <code class="docutils literal notranslate"><span class="pre">[model]</span></code> section, in
addition to <code class="docutils literal notranslate"><span class="pre">name</span></code> (which must be set):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">{{DET}}-low-frequency-cutoff</span> <span class="pre">=</span> <span class="pre">FLOAT</span></code> :
The low frequency cutoff to use for each detector {{DET}}. A cutoff
must be provided for every detector that may be analyzed (any
additional detectors are ignored).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{{DET}}-high-frequency-cutoff</span> <span class="pre">=</span> <span class="pre">FLOAT</span></code> :
(Optional) A high frequency cutoff for each detector. If not
provided, the Nyquist frequency is used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check-for-valid-times</span> <span class="pre">=</span></code> :
(Optional) If provided, will check that there are no data quality
flags on during the analysis segment and the segment used for PSD
estimation in each detector. To check for flags,
<a class="reference internal" href="pycbc.html#pycbc.dq.query_flag" title="pycbc.dq.query_flag"><code class="xref py py-func docutils literal notranslate"><span class="pre">pycbc.dq.query_flag()</span></code></a> is used, with settings pulled from the
<code class="docutils literal notranslate"><span class="pre">dq-*</span></code> options in the <code class="docutils literal notranslate"><span class="pre">[data]</span></code> section. If a detector has bad
data quality during either the analysis segment or PSD segment, it
will be removed from the analysis.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shift-psd-times-to-valid</span> <span class="pre">=</span></code> :
(Optional) If provided, the segment used for PSD estimation will
automatically be shifted left or right until a continous block of
data with no data quality issues can be found. If no block can be
found with a maximum shift of +/- the requested psd segment length,
the detector will not be analyzed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">err-on-missing-detectors</span> <span class="pre">=</span></code> :
Raises an error if any detector is removed from the analysis because
a valid time could not be found. Otherwise, a warning is printed
to screen and the detector is removed from the analysis.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">normalize</span> <span class="pre">=</span></code> :
(Optional) Turn on the normalization factor.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ignore-failed-waveforms</span> <span class="pre">=</span></code> :
Sets the <code class="docutils literal notranslate"><span class="pre">ignore_failed_waveforms</span></code> attribute.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cp</strong> (<a class="reference internal" href="pycbc.workflow.html#pycbc.workflow.configuration.WorkflowConfigParser" title="pycbc.workflow.configuration.WorkflowConfigParser"><em>WorkflowConfigParser</em></a>) – Config file parser to read.</p></li>
<li><p><strong>data_section</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – The name of the section to load data options from.</p></li>
<li><p><strong>**kwargs</strong> – All additional keyword arguments are passed to the class. Any
provided keyword will override what is in the config file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.brute_marg.BruteLISASkyModesMarginalize.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'brute_lisa_sky_modes_marginalize'</span></em><a class="headerlink" href="#pycbc.inference.models.brute_marg.BruteLISASkyModesMarginalize.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.brute_marg.BruteLISASkyModesMarginalize.reconstruct">
<span class="sig-name descname"><span class="pre">reconstruct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/brute_marg.html#BruteLISASkyModesMarginalize.reconstruct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.brute_marg.BruteLISASkyModesMarginalize.reconstruct" title="Link to this definition"></a></dt>
<dd><p>Reconstruct a point from unwrapping the 8-fold sky symmetry</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.brute_marg.BruteParallelGaussianMarginalize">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.brute_marg.</span></span><span class="sig-name descname"><span class="pre">BruteParallelGaussianMarginalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marginalize_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/brute_marg.html#BruteParallelGaussianMarginalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.brute_marg.BruteParallelGaussianMarginalize" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise" title="pycbc.inference.models.gaussian_noise.BaseGaussianNoise"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseGaussianNoise</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.brute_marg.BruteParallelGaussianMarginalize.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'brute_parallel_gaussian_marginalize'</span></em><a class="headerlink" href="#pycbc.inference.models.brute_marg.BruteParallelGaussianMarginalize.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.brute_marg.likelihood_wrapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.brute_marg.</span></span><span class="sig-name descname"><span class="pre">likelihood_wrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/brute_marg.html#likelihood_wrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.brute_marg.likelihood_wrapper" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
</dd></dl>

</section>
<section id="module-pycbc.inference.models.data_utils">
<span id="pycbc-inference-models-data-utils-module"></span><h2>pycbc.inference.models.data_utils module<a class="headerlink" href="#module-pycbc.inference.models.data_utils" title="Link to this heading"></a></h2>
<p>Utilities for loading data for models.</p>
<dl class="py exception">
<dt class="sig sig-object py" id="pycbc.inference.models.data_utils.NoValidDataError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.data_utils.</span></span><span class="sig-name descname"><span class="pre">NoValidDataError</span></span><a class="reference internal" href="_modules/pycbc/inference/models/data_utils.html#NoValidDataError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.data_utils.NoValidDataError" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
<p>This should be raised if a continous segment of valid data could not be
found.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.data_utils.check_for_nans">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.data_utils.</span></span><span class="sig-name descname"><span class="pre">check_for_nans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strain_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/data_utils.html#check_for_nans"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.data_utils.check_for_nans" title="Link to this definition"></a></dt>
<dd><p>Checks if any data in a dictionary of strains has NaNs.</p>
<p>If any NaNs are found, a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> is raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>strain_dict</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Dictionary of detectors -&gt;
<a class="reference internal" href="pycbc.types.html#pycbc.types.timeseries.TimeSeries" title="pycbc.types.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycbc.types.timeseries.TimeSeries</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.data_utils.check_validtimes">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.data_utils.</span></span><span class="sig-name descname"><span class="pre">check_validtimes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">detector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gps_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gps_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_to_valid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">segment_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'DATA'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/data_utils.html#check_validtimes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.data_utils.check_validtimes" title="Link to this definition"></a></dt>
<dd><p>Checks DQ server to see if the given times are in a valid segment.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">shift_to_valid</span></code> flag is provided, the times will be shifted left
or right to try to find a continous valid block nearby. The shifting starts
by shifting the times left by 1 second. If that does not work, it shifts
the times right by one second. This continues, increasing the shift time by
1 second, until a valid block could be found, or until the shift size
exceeds <code class="docutils literal notranslate"><span class="pre">max_shift</span></code>.</p>
<p>If the given times are not in a continuous valid segment, or a valid block
cannot be found nearby, a <code class="docutils literal notranslate"><span class="pre">NoValidDataError</span></code> is raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>detector</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The name of the detector to query; e.g., ‘H1’.</p></li>
<li><p><strong>gps_start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – The GPS start time of the segment to query.</p></li>
<li><p><strong>gps_end</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – The GPS end time of the segment to query.</p></li>
<li><p><strong>shift_to_valid</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, will try to shift the gps start and end times to the nearest
continous valid segment of data. Default is False.</p></li>
<li><p><strong>max_shift</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) – The maximum number of seconds to try to shift left or right to find
a valid segment. Default is <code class="docutils literal notranslate"><span class="pre">gps_end</span> <span class="pre">-</span> <span class="pre">gps_start</span></code>.</p></li>
<li><p><strong>segment_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – The status flag to query; passed to <a class="reference internal" href="pycbc.html#pycbc.dq.query_flag" title="pycbc.dq.query_flag"><code class="xref py py-func docutils literal notranslate"><span class="pre">pycbc.dq.query_flag()</span></code></a>.
Default is “DATA”.</p></li>
<li><p><strong>**kwargs</strong> – All other keyword arguments are passed to
<a class="reference internal" href="pycbc.html#pycbc.dq.query_flag" title="pycbc.dq.query_flag"><code class="xref py py-func docutils literal notranslate"><span class="pre">pycbc.dq.query_flag()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>use_start</strong> (<em>int</em>) – The start time to use. If <code class="docutils literal notranslate"><span class="pre">shift_to_valid</span></code> is True, this may differ
from the given GPS start time.</p></li>
<li><p><strong>use_end</strong> (<em>int</em>) – The end time to use. If <code class="docutils literal notranslate"><span class="pre">shift_to_valid</span></code> is True, this may differ
from the given GPS end time.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.data_utils.create_data_parser">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.data_utils.</span></span><span class="sig-name descname"><span class="pre">create_data_parser</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/data_utils.html#create_data_parser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.data_utils.create_data_parser" title="Link to this definition"></a></dt>
<dd><p>Creates an argument parser for loading GW data.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.data_utils.data_from_cli">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.data_utils.</span></span><span class="sig-name descname"><span class="pre">data_from_cli</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_for_valid_times</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_psd_times_to_valid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_on_missing_detectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/data_utils.html#data_from_cli"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.data_utils.data_from_cli" title="Link to this definition"></a></dt>
<dd><p>Loads the data needed for a model from the given command-line options.</p>
<p>Gates specifed on the command line are also applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>opts</strong> (<em>ArgumentParser parsed args</em>) – Argument options parsed from a command line string (the sort of thing
returned by <cite>parser.parse_args</cite>).</p></li>
<li><p><strong>check_for_valid_times</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – Check that valid data exists in the requested gps times. Default is
False.</p></li>
<li><p><strong>shift_psd_times_to_valid</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – If estimating the PSD from data, shift the PSD times to a valid
segment if needed. Default is False.</p></li>
<li><p><strong>err_on_missing_detectors</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – Raise a NoValidDataError if any detector does not have valid data.
Otherwise, a warning is printed, and that detector is skipped.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>strain_dict</strong> (<em>dict</em>) – Dictionary of detectors -&gt; time series strain.</p></li>
<li><p><strong>psd_strain_dict</strong> (<em>dict or None</em>) – If <code class="docutils literal notranslate"><span class="pre">opts.psd_(start|end)_time</span></code> were set, a dctionary of
detectors -&gt; time series data to use for PSD estimation. Otherwise,
<code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.data_utils.data_opts_from_config">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.data_utils.</span></span><span class="sig-name descname"><span class="pre">data_opts_from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">section</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_flow</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/data_utils.html#data_opts_from_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.data_utils.data_opts_from_config" title="Link to this definition"></a></dt>
<dd><p>Loads data options from a section in a config file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cp</strong> (<a class="reference internal" href="pycbc.workflow.html#pycbc.workflow.configuration.WorkflowConfigParser" title="pycbc.workflow.configuration.WorkflowConfigParser"><em>WorkflowConfigParser</em></a>) – Config file to read.</p></li>
<li><p><strong>section</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The section to read. All options in the section will be loaded as-if
they wre command-line arguments.</p></li>
<li><p><strong>filter_flow</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Dictionary of detectors -&gt; inner product low frequency cutoffs.
If a <cite>data-conditioning-low-freq</cite> cutoff wasn’t provided for any
of the detectors, these values will be used. Otherwise, the
data-conditioning-low-freq must be less than the inner product cutoffs.
If any are not, a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> is raised.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>opts</strong> – An argument parser namespace that was constructed as if the options
were specified on the command line.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>parsed argparse.ArgumentParser</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.data_utils.detectors_with_valid_data">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.data_utils.</span></span><span class="sig-name descname"><span class="pre">detectors_with_valid_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">detectors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gps_start_times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gps_end_times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_on_missing_detectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/data_utils.html#detectors_with_valid_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.data_utils.detectors_with_valid_data" title="Link to this definition"></a></dt>
<dd><p>Determines which detectors have valid data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>detectors</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Names of the detector names to check.</p></li>
<li><p><strong>gps_start_times</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Dictionary of detector name -&gt; start time listing the GPS start times
of the segment to check for each detector.</p></li>
<li><p><strong>gps_end_times</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Dictionary of detector name -&gt; end time listing the GPS end times of
the segment to check for each detector.</p></li>
<li><p><strong>pad_data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><em>optional</em>) – Dictionary of detector name -&gt; pad time to add to the beginning/end of
the GPS start/end times before checking. A pad time for every detector
in <code class="docutils literal notranslate"><span class="pre">detectors</span></code> must be given. Default (None) is to apply no pad to
the times.</p></li>
<li><p><strong>err_on_missing_detectors</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, a <code class="docutils literal notranslate"><span class="pre">NoValidDataError</span></code> will be raised if any detector does not
have continous valid data in its requested segment. Otherwise, the
detector will not be included in the returned list of detectors with
valid data. Default is False.</p></li>
<li><p><strong>**kwargs</strong> – All other keyword arguments are passed to <code class="docutils literal notranslate"><span class="pre">check_validtimes</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of detector name -&gt; valid times giving the detectors with
valid data and their segments. If <code class="docutils literal notranslate"><span class="pre">shift_to_valid</span></code> was passed to
<code class="docutils literal notranslate"><span class="pre">check_validtimes</span></code> this may not be the same as the input segments. If
no valid times could be found for a detector (and
<code class="docutils literal notranslate"><span class="pre">err_on_missing_detectors</span></code> is False), it will not be included in the
returned dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.data_utils.fd_data_from_strain_dict">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.data_utils.</span></span><span class="sig-name descname"><span class="pre">fd_data_from_strain_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strain_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psd_strain_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/data_utils.html#fd_data_from_strain_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.data_utils.fd_data_from_strain_dict" title="Link to this definition"></a></dt>
<dd><p>Converts a dictionary of time series to the frequency domain, and gets
the PSDs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>opts</strong> (<em>ArgumentParser parsed args</em>) – Argument options parsed from a command line string (the sort of thing
returned by <cite>parser.parse_args</cite>).</p></li>
<li><p><strong>strain_dict</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Dictionary of detectors -&gt; time series data.</p></li>
<li><p><strong>psd_strain_dict</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><em>optional</em>) – Dictionary of detectors -&gt; time series data to use for PSD estimation.
If not provided, will use the <code class="docutils literal notranslate"><span class="pre">strain_dict</span></code>. This is
ignored if <code class="docutils literal notranslate"><span class="pre">opts.psd_estimation</span></code> is not set. See
<code class="xref py py-func docutils literal notranslate"><span class="pre">pycbc.psd.psd_from_cli_multi_ifos()</span></code> for details.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>stilde_dict</strong> (<em>dict</em>) – Dictionary of detectors -&gt; frequency series data.</p></li>
<li><p><strong>psd_dict</strong> (<em>dict</em>) – Dictionary of detectors -&gt; frequency-domain PSDs.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.data_utils.gate_overwhitened_data">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.data_utils.</span></span><span class="sig-name descname"><span class="pre">gate_overwhitened_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stilde_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psd_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gates</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/data_utils.html#gate_overwhitened_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.data_utils.gate_overwhitened_data" title="Link to this definition"></a></dt>
<dd><p>Applies gates to overwhitened data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stilde_dict</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Dictionary of detectors -&gt; frequency series data to apply the gates to.</p></li>
<li><p><strong>psd_dict</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Dictionary of detectors -&gt; PSD to use for overwhitening.</p></li>
<li><p><strong>gates</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Dictionary of detectors -&gt; gates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of detectors -&gt; frequency series data with the gates
applied after overwhitening. The returned data is not overwhitened.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.data_utils.strain_from_cli_multi_ifos">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.data_utils.</span></span><span class="sig-name descname"><span class="pre">strain_from_cli_multi_ifos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/data_utils.html#strain_from_cli_multi_ifos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.data_utils.strain_from_cli_multi_ifos" title="Link to this definition"></a></dt>
<dd><p>Wrapper around strain.from_cli_multi_ifos that tries a few times before
quiting.</p>
<p>When running in a parallel environment, multiple concurrent queries to the
segment data base can cause time out errors. If that happens, this will
sleep for a few seconds, then try again a few times before giving up.</p>
</dd></dl>

</section>
<section id="module-pycbc.inference.models.gated_gaussian_noise">
<span id="pycbc-inference-models-gated-gaussian-noise-module"></span><h2>pycbc.inference.models.gated_gaussian_noise module<a class="headerlink" href="#module-pycbc.inference.models.gated_gaussian_noise" title="Link to this heading"></a></h2>
<p>This module provides model classes that assume the noise is Gaussian and
introduces a gate to remove given times from the data, using the inpainting
method to fill the removed part such that it does not enter the likelihood.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.gated_gaussian_noise.</span></span><span class="sig-name descname"><span class="pre">BaseGatedGaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_frequency_cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_frequency_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">static_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highpass_waveforms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gated_gaussian_noise.html#BaseGatedGaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise" title="pycbc.inference.models.gaussian_noise.BaseGaussianNoise"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseGaussianNoise</span></code></a></p>
<p>Base model for gated gaussian.</p>
<p>Provides additional routines for applying a time-domain gate to data.
See <a class="reference internal" href="#pycbc.inference.models.gated_gaussian_noise.GatedGaussianNoise" title="pycbc.inference.models.gated_gaussian_noise.GatedGaussianNoise"><code class="xref py py-class docutils literal notranslate"><span class="pre">GatedGaussianNoise</span></code></a> for more details.</p>
<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.data" title="Link to this definition"></a></dt>
<dd><p>Dictionary mapping detector names to data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.det_lognl">
<span class="sig-name descname"><span class="pre">det_lognl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gated_gaussian_noise.html#BaseGatedGaussian.det_lognl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.det_lognl" title="Link to this definition"></a></dt>
<dd><p>Returns the log likelihood of the noise in the given detector:</p>
<div class="math notranslate nohighlight">
\[\log p(d_i|n_i) = \log \alpha_i -
    \frac{1}{2} \left&lt;d_i | d_i\right&gt;.\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>det</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The name of the detector.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The log likelihood of the noise in the requested detector.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.det_lognorm">
<span class="sig-name descname"><span class="pre">det_lognorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gated_gaussian_noise.html#BaseGatedGaussian.det_lognorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.det_lognorm" title="Link to this definition"></a></dt>
<dd><p>Calculate the normalization term from the truncated covariance
matrix.</p>
<p>Determinant is estimated using a linear fit to logdet vs truncated
matrix size.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_section</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gated_gaussian_noise.html#BaseGatedGaussian.from_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.from_config" title="Link to this definition"></a></dt>
<dd><p>Adds addiotional keyword arguments based on config file.</p>
<p>Additional keyword arguments are:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">highpass_waveforms</span></code> : waveforms will be highpassed.</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.gate_indices">
<span class="sig-name descname"><span class="pre">gate_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gated_gaussian_noise.html#BaseGatedGaussian.gate_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.gate_indices" title="Link to this definition"></a></dt>
<dd><p>Calculate the indices corresponding to start and end of gate.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gated_gaussian_noise.html#BaseGatedGaussian.get_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.get_data" title="Link to this definition"></a></dt>
<dd><p>Return a copy of the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary of detector names -&gt; FrequencySeries.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.get_gate_times">
<span class="sig-name descname"><span class="pre">get_gate_times</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gated_gaussian_noise.html#BaseGatedGaussian.get_gate_times"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.get_gate_times" title="Link to this definition"></a></dt>
<dd><p>Gets the time to apply a gate based on the current sky position.</p>
<p>If the parameter <code class="docutils literal notranslate"><span class="pre">gatefunc</span></code> is set to <code class="docutils literal notranslate"><span class="pre">'hmeco'</span></code>, the gate times
will be calculated based on the hybrid MECO of the given set of
parameters; see <code class="docutils literal notranslate"><span class="pre">get_gate_times_hmeco</span></code> for details. Otherwise, the
gate times will just be retrieved from the <code class="docutils literal notranslate"><span class="pre">t_gate_start</span></code> and
<code class="docutils literal notranslate"><span class="pre">t_gate_end</span></code> parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary of detector names -&gt; (gate start, gate width)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.get_gate_times_hmeco">
<span class="sig-name descname"><span class="pre">get_gate_times_hmeco</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gated_gaussian_noise.html#BaseGatedGaussian.get_gate_times_hmeco"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.get_gate_times_hmeco" title="Link to this definition"></a></dt>
<dd><p>Gets the time to apply a gate based on the current sky position.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary of detector names -&gt; (gate start, gate width)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.get_gated_data">
<span class="sig-name descname"><span class="pre">get_gated_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gated_gaussian_noise.html#BaseGatedGaussian.get_gated_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.get_gated_data" title="Link to this definition"></a></dt>
<dd><p>Return a copy of the gated data.</p>
<p>The gated data will be cached for faster retrieval.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary of detector names -&gt; FrequencySeries.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.get_gated_waveforms">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_gated_waveforms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gated_gaussian_noise.html#BaseGatedGaussian.get_gated_waveforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.get_gated_waveforms" title="Link to this definition"></a></dt>
<dd><p>Generates and gates waveforms using the current parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary of detector names -&gt; FrequencySeries.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.get_waveforms">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_waveforms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gated_gaussian_noise.html#BaseGatedGaussian.get_waveforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.get_waveforms" title="Link to this definition"></a></dt>
<dd><p>The waveforms generated using the current parameters.</p>
<p>If the waveforms haven’t been generated yet, they will be generated,
resized to the same length as the data, and cached. If the
<code class="docutils literal notranslate"><span class="pre">highpass_waveforms</span></code> attribute is set, a highpass filter will
also be applied to the waveforms.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary of detector names -&gt; waveforms</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.logdet_fit">
<span class="sig-name descname"><span class="pre">logdet_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cov</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gated_gaussian_noise.html#BaseGatedGaussian.logdet_fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.logdet_fit" title="Link to this definition"></a></dt>
<dd><p>Construct a linear regression from a sample of truncated covariance
matrices.</p>
<p>Returns the sample points used for linear fit generation as well as the
linear fit parameters.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.normalize">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">normalize</span></span><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.normalize" title="Link to this definition"></a></dt>
<dd><p>Determines if the loglikelihood includes the normalization term.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.psds">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">psds</span></span><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.psds" title="Link to this definition"></a></dt>
<dd><p>Dictionary of detectors -&gt; PSD frequency series.</p>
<p>If no PSD was provided for a detector, this will just be a frequency
series of ones.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.td_data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">td_data</span></span><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.td_data" title="Link to this definition"></a></dt>
<dd><p>The data in the time domain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.whiten">
<span class="sig-name descname"><span class="pre">whiten</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">whiten</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gated_gaussian_noise.html#BaseGatedGaussian.whiten"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.whiten" title="Link to this definition"></a></dt>
<dd><p>Whitens the given data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Dictionary of detector names -&gt; FrequencySeries.</p></li>
<li><p><strong>whiten</strong> (<em>{0</em><em>, </em><em>1</em><em>, </em><em>2}</em>) – Integer indicating what level of whitening to apply. Levels are:
0: no whitening; 1: whiten; 2: overwhiten.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, modify the data in place. Otherwise, a copy will be
created for whitening.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of FrequencySeries after the requested whitening has
been applied.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.write_metadata">
<span class="sig-name descname"><span class="pre">write_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gated_gaussian_noise.html#BaseGatedGaussian.write_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian.write_metadata" title="Link to this definition"></a></dt>
<dd><p>Adds writing the psds, and analyzed detectors.</p>
<p>The analyzed detectors, their analysis segments, and the segments
used for psd estimation are written as
<code class="docutils literal notranslate"><span class="pre">analyzed_detectors</span></code>, <code class="docutils literal notranslate"><span class="pre">{{detector}}_analysis_segment</span></code>, and
<code class="docutils literal notranslate"><span class="pre">{{detector}}_psd_segment</span></code>, respectively. These are either written
to the specified <code class="docutils literal notranslate"><span class="pre">group</span></code>’s attrs, or to the top level attrs if
<code class="docutils literal notranslate"><span class="pre">group</span></code> is None.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fp</strong> (<em>pycbc.inference.io.BaseInferenceFile instance</em>) – The inference file to write to.</p></li>
<li><p><strong>group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – If provided, the metadata will be written to the attrs specified
by group, i.e., to <code class="docutils literal notranslate"><span class="pre">fp[group].attrs</span></code>. Otherwise, metadata is
written to the top-level attrs (<code class="docutils literal notranslate"><span class="pre">fp.attrs</span></code>).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.GatedGaussianMargPol">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.gated_gaussian_noise.</span></span><span class="sig-name descname"><span class="pre">GatedGaussianMargPol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_frequency_cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_frequency_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">static_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polarization_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gated_gaussian_noise.html#GatedGaussianMargPol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.GatedGaussianMargPol" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian" title="pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseGatedGaussian</span></code></a></p>
<p>Gated gaussian model with numerical marginalization over polarization.</p>
<p>This implements the GatedGaussian likelihood with an explicit numerical
marginalization over polarization angle. This is accomplished using
a fixed set of integration points distribution uniformation between
0 and 2pi. By default, 1000 integration points are used.
The ‘polarization_samples’ argument can be passed to set an alternate
number of integration points.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.GatedGaussianMargPol.get_gate_times_hmeco">
<span class="sig-name descname"><span class="pre">get_gate_times_hmeco</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gated_gaussian_noise.html#GatedGaussianMargPol.get_gate_times_hmeco"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.GatedGaussianMargPol.get_gate_times_hmeco" title="Link to this definition"></a></dt>
<dd><p>Gets the time to apply a gate based on the current sky position.
:returns: Dictionary of detector names -&gt; (gate start, gate width)
:rtype: dict</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.GatedGaussianMargPol.get_gated_waveforms">
<span class="sig-name descname"><span class="pre">get_gated_waveforms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gated_gaussian_noise.html#GatedGaussianMargPol.get_gated_waveforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.GatedGaussianMargPol.get_gated_waveforms" title="Link to this definition"></a></dt>
<dd><p>Generates and gates waveforms using the current parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary of detector names -&gt; FrequencySeries.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.GatedGaussianMargPol.get_waveforms">
<span class="sig-name descname"><span class="pre">get_waveforms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gated_gaussian_noise.html#GatedGaussianMargPol.get_waveforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.GatedGaussianMargPol.get_waveforms" title="Link to this definition"></a></dt>
<dd><p>The waveforms generated using the current parameters.</p>
<p>If the waveforms haven’t been generated yet, they will be generated,
resized to the same length as the data, and cached. If the
<code class="docutils literal notranslate"><span class="pre">highpass_waveforms</span></code> attribute is set, a highpass filter will
also be applied to the waveforms.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary of detector names -&gt; waveforms</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.GatedGaussianMargPol.multi_loglikelihood">
<span class="sig-name descname"><span class="pre">multi_loglikelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">models</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gated_gaussian_noise.html#GatedGaussianMargPol.multi_loglikelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.GatedGaussianMargPol.multi_loglikelihood" title="Link to this definition"></a></dt>
<dd><p>Calculate a multi-model (signal) likelihood</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.GatedGaussianMargPol.multi_signal_support">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">multi_signal_support</span></span><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.GatedGaussianMargPol.multi_signal_support" title="Link to this definition"></a></dt>
<dd><p>The list of classes that this model supports in a multi-signal
likelihood</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.GatedGaussianMargPol.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'gated_gaussian_margpol'</span></em><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.GatedGaussianMargPol.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.GatedGaussianNoise">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.gated_gaussian_noise.</span></span><span class="sig-name descname"><span class="pre">GatedGaussianNoise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_frequency_cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_frequency_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">static_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gated_gaussian_noise.html#GatedGaussianNoise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.GatedGaussianNoise" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian" title="pycbc.inference.models.gated_gaussian_noise.BaseGatedGaussian"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseGatedGaussian</span></code></a></p>
<p>Model that applies a time domain gate, assuming stationary Gaussian
noise.</p>
<p>The gate start and end times are set by providing <code class="docutils literal notranslate"><span class="pre">t_gate_start</span></code> and
<code class="docutils literal notranslate"><span class="pre">t_gate_end</span></code> parameters, respectively. This will cause the gated times
to be excised from the analysis. For more details on the likelihood
function and its derivation, see
<a class="reference external" href="https://arxiv.org/abs/2105.05238">arXiv:2105.05238</a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The normalization of the likelihood depends on the gate times. However,
at the moment, the normalization is not calculated, as it depends on
the determinant of the truncated covariance matrix (see Eq. 4 of
arXiv:2105.05238). For this reason it is recommended that you only
use this model for fixed gate times.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.GatedGaussianNoise.get_gated_waveforms">
<span class="sig-name descname"><span class="pre">get_gated_waveforms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gated_gaussian_noise.html#GatedGaussianNoise.get_gated_waveforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.GatedGaussianNoise.get_gated_waveforms" title="Link to this definition"></a></dt>
<dd><p>Generates and gates waveforms using the current parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary of detector names -&gt; FrequencySeries.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.GatedGaussianNoise.get_waveforms">
<span class="sig-name descname"><span class="pre">get_waveforms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gated_gaussian_noise.html#GatedGaussianNoise.get_waveforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.GatedGaussianNoise.get_waveforms" title="Link to this definition"></a></dt>
<dd><p>The waveforms generated using the current parameters.</p>
<p>If the waveforms haven’t been generated yet, they will be generated,
resized to the same length as the data, and cached. If the
<code class="docutils literal notranslate"><span class="pre">highpass_waveforms</span></code> attribute is set, a highpass filter will
also be applied to the waveforms.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary of detector names -&gt; waveforms</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.GatedGaussianNoise.multi_loglikelihood">
<span class="sig-name descname"><span class="pre">multi_loglikelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">models</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gated_gaussian_noise.html#GatedGaussianNoise.multi_loglikelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.GatedGaussianNoise.multi_loglikelihood" title="Link to this definition"></a></dt>
<dd><p>Calculate a multi-model (signal) likelihood</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.GatedGaussianNoise.multi_signal_support">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">multi_signal_support</span></span><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.GatedGaussianNoise.multi_signal_support" title="Link to this definition"></a></dt>
<dd><p>The list of classes that this model supports in a multi-signal
likelihood</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.gated_gaussian_noise.GatedGaussianNoise.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'gated_gaussian_noise'</span></em><a class="headerlink" href="#pycbc.inference.models.gated_gaussian_noise.GatedGaussianNoise.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-pycbc.inference.models.gaussian_noise">
<span id="pycbc-inference-models-gaussian-noise-module"></span><h2>pycbc.inference.models.gaussian_noise module<a class="headerlink" href="#module-pycbc.inference.models.gaussian_noise" title="Link to this heading"></a></h2>
<p>This module provides model classes that assume the noise is Gaussian.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.BaseGaussianNoise">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.gaussian_noise.</span></span><span class="sig-name descname"><span class="pre">BaseGaussianNoise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_frequency_cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_frequency_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">static_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_failed_waveforms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_save_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gaussian_noise.html#BaseGaussianNoise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.models.base_data.BaseDataModel" title="pycbc.inference.models.base_data.BaseDataModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseDataModel</span></code></a></p>
<p>Model for analyzing GW data with assuming a wide-sense stationary
Gaussian noise model.</p>
<p>This model will load gravitational wave data and calculate the log noise
likelihood <code class="docutils literal notranslate"><span class="pre">_lognl</span></code> and normalization. It also implements the
<code class="docutils literal notranslate"><span class="pre">_loglikelihood</span></code> function as the sum of the log likelihood ratio and the
<code class="docutils literal notranslate"><span class="pre">lognl</span></code>. It does not implement a log likelihood ratio function
<code class="docutils literal notranslate"><span class="pre">_loglr</span></code>, however, since that can differ depending on the signal model.
Models that analyze GW data assuming it is stationary Gaussian should
therefore inherit from this class and implement their own <code class="docutils literal notranslate"><span class="pre">_loglr</span></code>
function.</p>
<p>For more details on the inner product used, the log likelihood of the
noise, and the normalization factor, see <a class="reference internal" href="#pycbc.inference.models.gaussian_noise.GaussianNoise" title="pycbc.inference.models.gaussian_noise.GaussianNoise"><code class="xref py py-class docutils literal notranslate"><span class="pre">GaussianNoise</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variable_params</strong> (<em>(</em><em>tuple of</em><em>) </em><em>string</em><em>(</em><em>s</em><em>)</em>) – A tuple of parameter names that will be varied.</p></li>
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – A dictionary of data, in which the keys are the detector names and the
values are the data (assumed to be unwhitened). All data must have the
same frequency resolution.</p></li>
<li><p><strong>low_frequency_cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – A dictionary of starting frequencies, in which the keys are the
detector names and the values are the starting frequencies for the
respective detectors to be used for computing inner products.</p></li>
<li><p><strong>psds</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><em>optional</em>) – A dictionary of FrequencySeries keyed by the detector names. The
dictionary must have a psd for each detector specified in the data
dictionary. If provided, the inner products in each detector will be
weighted by 1/psd of that detector.</p></li>
<li><p><strong>high_frequency_cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><em>optional</em>) – A dictionary of ending frequencies, in which the keys are the
detector names and the values are the ending frequencies for the
respective detectors to be used for computing inner products. If not
provided, the minimum of the largest frequency stored in the data
and a given waveform will be used.</p></li>
<li><p><strong>normalize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, the normalization factor <span class="math notranslate nohighlight">\(alpha\)</span> will be included in the
log likelihood. See <a class="reference internal" href="#pycbc.inference.models.gaussian_noise.GaussianNoise" title="pycbc.inference.models.gaussian_noise.GaussianNoise"><code class="xref py py-class docutils literal notranslate"><span class="pre">GaussianNoise</span></code></a> for details. Default is
to not include it.</p></li>
<li><p><strong>static_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><em>optional</em>) – A dictionary of parameter names -&gt; values to keep fixed.</p></li>
<li><p><strong>ignore_failed_waveforms</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – If the waveform generator raises an error when it tries to generate,
treat the point as having zero likelihood. This allows the parameter
estimation to continue. Otherwise, an error will be raised, stopping
the run. Default is False.</p></li>
<li><p><strong>**kwargs</strong> – All other keyword arguments are passed to <code class="docutils literal notranslate"><span class="pre">BaseDataModel</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.BaseGaussianNoise.ignore_failed_waveforms">
<span class="sig-name descname"><span class="pre">ignore_failed_waveforms</span></span><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise.ignore_failed_waveforms" title="Link to this definition"></a></dt>
<dd><p>If True, points in parameter space that cause waveform generation to
fail (i.e., they raise a <code class="docutils literal notranslate"><span class="pre">FailedWaveformError</span></code>) will be treated as
points with zero likelihood. Otherwise, such points will cause the
model to raise a <code class="docutils literal notranslate"><span class="pre">FailedWaveformError</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.BaseGaussianNoise.det_lognl">
<span class="sig-name descname"><span class="pre">det_lognl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gaussian_noise.html#BaseGaussianNoise.det_lognl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise.det_lognl" title="Link to this definition"></a></dt>
<dd><p>Returns the log likelihood of the noise in the given detector:</p>
<div class="math notranslate nohighlight">
\[\log p(d_i|n_i) = \log \alpha_i -
    \frac{1}{2} \left&lt;d_i | d_i\right&gt;.\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>det</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The name of the detector.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The log likelihood of the noise in the requested detector.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.BaseGaussianNoise.det_lognorm">
<span class="sig-name descname"><span class="pre">det_lognorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gaussian_noise.html#BaseGaussianNoise.det_lognorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise.det_lognorm" title="Link to this definition"></a></dt>
<dd><p>The log of the likelihood normalization in the given detector.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">self.normalize</span></code> is False, will just return 0.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.BaseGaussianNoise.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_section</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gaussian_noise.html#BaseGaussianNoise.from_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise.from_config" title="Link to this definition"></a></dt>
<dd><p>Initializes an instance of this class from the given config file.</p>
<p>In addition to <code class="docutils literal notranslate"><span class="pre">[model]</span></code>, a <code class="docutils literal notranslate"><span class="pre">data_section</span></code> (default <code class="docutils literal notranslate"><span class="pre">[data]</span></code>)
must be in the configuration file. The data section specifies settings
for loading data and estimating PSDs. See the <a class="reference external" href="http://pycbc.org/pycbc/latest/html/inference.html#setting-data">online documentation</a> for
more details.</p>
<p>The following options are read from the <code class="docutils literal notranslate"><span class="pre">[model]</span></code> section, in
addition to <code class="docutils literal notranslate"><span class="pre">name</span></code> (which must be set):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">{{DET}}-low-frequency-cutoff</span> <span class="pre">=</span> <span class="pre">FLOAT</span></code> :
The low frequency cutoff to use for each detector {{DET}}. A cutoff
must be provided for every detector that may be analyzed (any
additional detectors are ignored).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{{DET}}-high-frequency-cutoff</span> <span class="pre">=</span> <span class="pre">FLOAT</span></code> :
(Optional) A high frequency cutoff for each detector. If not
provided, the Nyquist frequency is used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check-for-valid-times</span> <span class="pre">=</span></code> :
(Optional) If provided, will check that there are no data quality
flags on during the analysis segment and the segment used for PSD
estimation in each detector. To check for flags,
<a class="reference internal" href="pycbc.html#pycbc.dq.query_flag" title="pycbc.dq.query_flag"><code class="xref py py-func docutils literal notranslate"><span class="pre">pycbc.dq.query_flag()</span></code></a> is used, with settings pulled from the
<code class="docutils literal notranslate"><span class="pre">dq-*</span></code> options in the <code class="docutils literal notranslate"><span class="pre">[data]</span></code> section. If a detector has bad
data quality during either the analysis segment or PSD segment, it
will be removed from the analysis.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shift-psd-times-to-valid</span> <span class="pre">=</span></code> :
(Optional) If provided, the segment used for PSD estimation will
automatically be shifted left or right until a continous block of
data with no data quality issues can be found. If no block can be
found with a maximum shift of +/- the requested psd segment length,
the detector will not be analyzed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">err-on-missing-detectors</span> <span class="pre">=</span></code> :
Raises an error if any detector is removed from the analysis because
a valid time could not be found. Otherwise, a warning is printed
to screen and the detector is removed from the analysis.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">normalize</span> <span class="pre">=</span></code> :
(Optional) Turn on the normalization factor.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ignore-failed-waveforms</span> <span class="pre">=</span></code> :
Sets the <code class="docutils literal notranslate"><span class="pre">ignore_failed_waveforms</span></code> attribute.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cp</strong> (<a class="reference internal" href="pycbc.workflow.html#pycbc.workflow.configuration.WorkflowConfigParser" title="pycbc.workflow.configuration.WorkflowConfigParser"><em>WorkflowConfigParser</em></a>) – Config file parser to read.</p></li>
<li><p><strong>data_section</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – The name of the section to load data options from.</p></li>
<li><p><strong>**kwargs</strong> – All additional keyword arguments are passed to the class. Any
provided keyword will override what is in the config file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.BaseGaussianNoise.high_frequency_cutoff">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">high_frequency_cutoff</span></span><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise.high_frequency_cutoff" title="Link to this definition"></a></dt>
<dd><p>The high frequency cutoff of the inner product.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.BaseGaussianNoise.kmax">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kmax</span></span><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise.kmax" title="Link to this definition"></a></dt>
<dd><p>Dictionary of ending indices for the inner product.</p>
<p>This is determined from the high frequency cutoff and the <code class="docutils literal notranslate"><span class="pre">delta_f</span></code>
of the data using
<a class="reference internal" href="pycbc.filter.html#pycbc.filter.matchedfilter.get_cutoff_indices" title="pycbc.filter.matchedfilter.get_cutoff_indices"><code class="xref py py-func docutils literal notranslate"><span class="pre">pycbc.filter.matchedfilter.get_cutoff_indices()</span></code></a>. If no high
frequency cutoff was provided, this will be the indice corresponding to
the Nyquist frequency.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.BaseGaussianNoise.kmin">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kmin</span></span><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise.kmin" title="Link to this definition"></a></dt>
<dd><p>Dictionary of starting indices for the inner product.</p>
<p>This is determined from the lower frequency cutoff and the <code class="docutils literal notranslate"><span class="pre">delta_f</span></code>
of the data using
<a class="reference internal" href="pycbc.filter.html#pycbc.filter.matchedfilter.get_cutoff_indices" title="pycbc.filter.matchedfilter.get_cutoff_indices"><code class="xref py py-func docutils literal notranslate"><span class="pre">pycbc.filter.matchedfilter.get_cutoff_indices()</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.BaseGaussianNoise.lognorm">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lognorm</span></span><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise.lognorm" title="Link to this definition"></a></dt>
<dd><p>The log of the normalization of the log likelihood.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.BaseGaussianNoise.low_frequency_cutoff">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">low_frequency_cutoff</span></span><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise.low_frequency_cutoff" title="Link to this definition"></a></dt>
<dd><p>The low frequency cutoff of the inner product.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.BaseGaussianNoise.normalize">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">normalize</span></span><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise.normalize" title="Link to this definition"></a></dt>
<dd><p>Determines if the loglikelihood includes the normalization term.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.BaseGaussianNoise.psd_segments">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">psd_segments</span></span><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise.psd_segments" title="Link to this definition"></a></dt>
<dd><p>Dictionary giving times used for PSD estimation for each detector.</p>
<p>If a detector’s PSD was not estimated from data, or the segment wasn’t
provided, that detector will not be in the dictionary.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.BaseGaussianNoise.psds">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">psds</span></span><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise.psds" title="Link to this definition"></a></dt>
<dd><p>Dictionary of detectors -&gt; PSD frequency series.</p>
<p>If no PSD was provided for a detector, this will just be a frequency
series of ones.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.BaseGaussianNoise.set_psd_segments">
<span class="sig-name descname"><span class="pre">set_psd_segments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gaussian_noise.html#BaseGaussianNoise.set_psd_segments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise.set_psd_segments" title="Link to this definition"></a></dt>
<dd><p>Sets the PSD segments from a dictionary of PSDs.</p>
<p>This attempts to get the PSD segment from a <code class="docutils literal notranslate"><span class="pre">psd_segment</span></code> attribute
of each detector’s PSD frequency series. If that attribute isn’t set,
then that detector is not added to the dictionary of PSD segments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>psds</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Dictionary of detector name -&gt; PSD frequency series. The segment
used for each PSD will try to be retrieved from the PSD’s
<code class="docutils literal notranslate"><span class="pre">.psd_segment</span></code> attribute.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.BaseGaussianNoise.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gaussian_noise.html#BaseGaussianNoise.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise.update" title="Link to this definition"></a></dt>
<dd><p>Updates the current parameter positions and resets stats.</p>
<p>If any sampling transforms are specified, they are applied to the
params before being stored.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.BaseGaussianNoise.weight">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">weight</span></span><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise.weight" title="Link to this definition"></a></dt>
<dd><p>Dictionary of detectors -&gt; frequency series of inner-product
weights.</p>
<p>The weights are <span class="math notranslate nohighlight">\(\sqrt{4 \Delta f / S_n(f)}\)</span>. This is set when
the PSDs are set.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.BaseGaussianNoise.whitened_data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">whitened_data</span></span><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise.whitened_data" title="Link to this definition"></a></dt>
<dd><p>Dictionary of detectors -&gt; whitened data frequency series.</p>
<p>The whitened data is the data multiplied by the inner-product weight.
Note that this includes the <span class="math notranslate nohighlight">\(\sqrt{4 \Delta f}\)</span> factor. This
is set when the PSDs are set.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.BaseGaussianNoise.write_metadata">
<span class="sig-name descname"><span class="pre">write_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gaussian_noise.html#BaseGaussianNoise.write_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise.write_metadata" title="Link to this definition"></a></dt>
<dd><p>Adds writing the psds, analyzed detectors, and lognl.</p>
<p>The analyzed detectors, their analysis segments, and the segments
used for psd estimation are written as
<code class="docutils literal notranslate"><span class="pre">analyzed_detectors</span></code>, <code class="docutils literal notranslate"><span class="pre">{{detector}}_analysis_segment</span></code>, and
<code class="docutils literal notranslate"><span class="pre">{{detector}}_psd_segment</span></code>, respectively. These are either written
to the specified <code class="docutils literal notranslate"><span class="pre">group</span></code>’s attrs, or to the top level attrs if
<code class="docutils literal notranslate"><span class="pre">group</span></code> is None.</p>
<p>The total and each detector’s lognl is written to the sample group’s
<code class="docutils literal notranslate"><span class="pre">attrs</span></code>. If a group is specified, the group name will be prependend
to the lognl labels with <code class="docutils literal notranslate"><span class="pre">{group}__</span></code>, with any <code class="docutils literal notranslate"><span class="pre">/</span></code> in the group
path replaced with <code class="docutils literal notranslate"><span class="pre">__</span></code>. For example, if group is <code class="docutils literal notranslate"><span class="pre">/a/b</span></code>, the
<code class="docutils literal notranslate"><span class="pre">lognl</span></code> will be written as <code class="docutils literal notranslate"><span class="pre">a__b__lognl</span></code> in the sample’s group
attrs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fp</strong> (<em>pycbc.inference.io.BaseInferenceFile instance</em>) – The inference file to write to.</p></li>
<li><p><strong>group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – If provided, the metadata will be written to the attrs specified
by group, i.e., to <code class="docutils literal notranslate"><span class="pre">fp[group].attrs</span></code>. Otherwise, metadata is
written to the top-level attrs (<code class="docutils literal notranslate"><span class="pre">fp.attrs</span></code>).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.GaussianNoise">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.gaussian_noise.</span></span><span class="sig-name descname"><span class="pre">GaussianNoise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_frequency_cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_frequency_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">static_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">det_frame_waveform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gaussian_noise.html#GaussianNoise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.GaussianNoise" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise" title="pycbc.inference.models.gaussian_noise.BaseGaussianNoise"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseGaussianNoise</span></code></a></p>
<p>Model that assumes data is stationary Gaussian noise.</p>
<p>With Gaussian noise the log likelihood functions for signal
<span class="math notranslate nohighlight">\(\log p(d|\Theta, h)\)</span> and for noise <span class="math notranslate nohighlight">\(\log p(d|n)\)</span> are given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\log p(d|\Theta, h) &amp;=  \log\alpha -\frac{1}{2} \sum_i
    \left&lt; d_i - h_i(\Theta) | d_i - h_i(\Theta) \right&gt; \\
\log p(d|n) &amp;= \log\alpha -\frac{1}{2} \sum_i \left&lt;d_i | d_i\right&gt;\end{split}\]</div>
<p>where the sum is over the number of detectors, <span class="math notranslate nohighlight">\(d_i\)</span> is the data in
each detector, and <span class="math notranslate nohighlight">\(h_i(\Theta)\)</span> is the model signal in each
detector. The (discrete) inner product is given by:</p>
<div class="math notranslate nohighlight">
\[\left&lt;a_i | b_i\right&gt; = 4\Re \Delta f
    \sum_{k=k_{\mathrm{min}}}^{k_{\mathrm{max}}}
    \frac{\tilde{a}_i^{*}[k] \tilde{b}_i[k]}{S^{(i)}_n[k]},\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta f\)</span> is the frequency resolution (given by 1 / the
observation time <span class="math notranslate nohighlight">\(T\)</span>), <span class="math notranslate nohighlight">\(k\)</span> is an index over the discretely
sampled frequencies <span class="math notranslate nohighlight">\(f = k \Delta_f\)</span>, and <span class="math notranslate nohighlight">\(S^{(i)}_n[k]\)</span> is the
PSD in the given detector. The upper cutoff on the inner product
<span class="math notranslate nohighlight">\(k_{\max}\)</span> is by default the Nyquist frequency
<span class="math notranslate nohighlight">\(k_{\max} = N/2+1\)</span>, where <span class="math notranslate nohighlight">\(N = \lfloor T/\Delta t \rfloor\)</span>
is the number of samples in the time domain, but this can be set manually
to a smaller value.</p>
<p>The normalization factor <span class="math notranslate nohighlight">\(\alpha\)</span> is:</p>
<div class="math notranslate nohighlight">
\[\alpha = \prod_{i} \frac{1}{\left(\pi T\right)^{N/2}
    \prod_{k=k_\mathrm{min}}^{k_{\mathrm{max}}} S^{(i)}_n[k]},\]</div>
<p>where the product is over the number of detectors. By default, the
normalization constant is not included in the log likelihood, but it can
be turned on using the <code class="docutils literal notranslate"><span class="pre">normalize</span></code> keyword argument.</p>
<p>Note that the log likelihood ratio has fewer terms than the log likelihood,
since the normalization and <span class="math notranslate nohighlight">\(\left&lt;d_i|d_i\right&gt;\)</span> terms cancel:</p>
<div class="math notranslate nohighlight">
\[\log \mathcal{L}(\Theta) = \sum_i \left[
    \left&lt;h_i(\Theta)|d_i\right&gt; -
    \frac{1}{2} \left&lt;h_i(\Theta)|h_i(\Theta)\right&gt; \right]\]</div>
<p>Upon initialization, the data is whitened using the given PSDs. If no PSDs
are given the data and waveforms returned by the waveform generator are
assumed to be whitened.</p>
<p>For more details on initialization parameters and definition of terms, see
<code class="xref py py-class docutils literal notranslate"><span class="pre">models.BaseDataModel</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variable_params</strong> (<em>(</em><em>tuple of</em><em>) </em><em>string</em><em>(</em><em>s</em><em>)</em>) – A tuple of parameter names that will be varied.</p></li>
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – A dictionary of data, in which the keys are the detector names and the
values are the data (assumed to be unwhitened). The list of keys must
match the waveform generator’s detectors keys, and the epoch of every
data set must be the same as the waveform generator’s epoch.</p></li>
<li><p><strong>low_frequency_cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – A dictionary of starting frequencies, in which the keys are the
detector names and the values are the starting frequencies for the
respective detectors to be used for computing inner products.</p></li>
<li><p><strong>psds</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><em>optional</em>) – A dictionary of FrequencySeries keyed by the detector names. The
dictionary must have a psd for each detector specified in the data
dictionary. If provided, the inner products in each detector will be
weighted by 1/psd of that detector.</p></li>
<li><p><strong>high_frequency_cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><em>optional</em>) – A dictionary of ending frequencies, in which the keys are the
detector names and the values are the ending frequencies for the
respective detectors to be used for computing inner products. If not
provided, the minimum of the largest frequency stored in the data
and a given waveform will be used.</p></li>
<li><p><strong>normalize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, the normalization factor <span class="math notranslate nohighlight">\(alpha\)</span> will be included in the
log likelihood. Default is to not include it.</p></li>
<li><p><strong>static_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><em>optional</em>) – A dictionary of parameter names -&gt; values to keep fixed.</p></li>
<li><p><strong>det_frame_waveform</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – If True, the waveform will be generated directly in the detector frame
using the
<a class="reference internal" href="pycbc.waveform.html#pycbc.waveform.generator.FDomainDirectDetFrameGenerator" title="pycbc.waveform.generator.FDomainDirectDetFrameGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">FDomainDirectDetFrameGenerator</span></code></a>.
This requires the approximant be implemented in
<code class="xref py py-func docutils literal notranslate"><span class="pre">get_fd_det_waveform()</span></code>.
If False, the
<a class="reference internal" href="pycbc.waveform.html#pycbc.waveform.generator.FDomainDetFrameGenerator" title="pycbc.waveform.generator.FDomainDetFrameGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">FDomainDetFrameGenerator</span></code></a> will be
used instead. Defaults to <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>**kwargs</strong> – All other keyword arguments are passed to <code class="docutils literal notranslate"><span class="pre">BaseDataModel</span></code>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create a signal, and set up the model using that signal:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pycbc</span><span class="w"> </span><span class="kn">import</span> <span class="n">psd</span> <span class="k">as</span> <span class="n">pypsd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pycbc.inference.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">GaussianNoise</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pycbc.waveform.generator</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span><span class="n">FDomainDetFrameGenerator</span><span class="p">,</span>
<span class="gp">... </span>                                      <span class="n">FDomainCBCGenerator</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seglen</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sample_rate</span> <span class="o">=</span> <span class="mi">2048</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="n">seglen</span><span class="o">*</span><span class="n">sample_rate</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fmin</span> <span class="o">=</span> <span class="mf">30.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">static_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;approximant&#39;</span><span class="p">:</span> <span class="s1">&#39;IMRPhenomD&#39;</span><span class="p">,</span> <span class="s1">&#39;f_lower&#39;</span><span class="p">:</span> <span class="n">fmin</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="s1">&#39;mass1&#39;</span><span class="p">:</span> <span class="mf">38.6</span><span class="p">,</span> <span class="s1">&#39;mass2&#39;</span><span class="p">:</span> <span class="mf">29.3</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="s1">&#39;spin1z&#39;</span><span class="p">:</span> <span class="mf">0.</span><span class="p">,</span> <span class="s1">&#39;spin2z&#39;</span><span class="p">:</span> <span class="mf">0.</span><span class="p">,</span> <span class="s1">&#39;ra&#39;</span><span class="p">:</span> <span class="mf">1.37</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.26</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="s1">&#39;polarization&#39;</span><span class="p">:</span> <span class="mf">2.76</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="o">*</span><span class="mf">500.</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">variable_params</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tc&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tsig</span> <span class="o">=</span> <span class="mf">3.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generator</span> <span class="o">=</span> <span class="n">FDomainDetFrameGenerator</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">FDomainCBCGenerator</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">detectors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H1&#39;</span><span class="p">,</span> <span class="s1">&#39;L1&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">variable_args</span><span class="o">=</span><span class="n">variable_params</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">delta_f</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="n">seglen</span><span class="p">,</span> <span class="o">**</span><span class="n">static_params</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">tc</span><span class="o">=</span><span class="n">tsig</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">psd</span> <span class="o">=</span> <span class="n">pypsd</span><span class="o">.</span><span class="n">aLIGOZeroDetHighPower</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="n">seglen</span><span class="p">,</span> <span class="mf">20.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">psds</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;H1&#39;</span><span class="p">:</span> <span class="n">psd</span><span class="p">,</span> <span class="s1">&#39;L1&#39;</span><span class="p">:</span> <span class="n">psd</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">low_frequency_cutoff</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;H1&#39;</span><span class="p">:</span> <span class="n">fmin</span><span class="p">,</span> <span class="s1">&#39;L1&#39;</span><span class="p">:</span> <span class="n">fmin</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">GaussianNoise</span><span class="p">(</span><span class="n">variable_params</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">low_frequency_cutoff</span><span class="p">,</span>
<span class="go">                          psds=psds, static_params=static_params)</span>
</pre></div>
</div>
<p>Set the current position to the coalescence time of the signal:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">tc</span><span class="o">=</span><span class="n">tsig</span><span class="p">)</span>
</pre></div>
</div>
<p>Now compute the log likelihood ratio and prior-weighted likelihood ratio;
since we have not provided a prior, these should be equal to each other:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">loglr</span><span class="p">))</span>
<span class="go">282.43</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">logplr</span><span class="p">))</span>
<span class="go">282.43</span>
</pre></div>
</div>
<p>Print all of the default_stats:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">: </span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<span class="gp">... </span>                  <span class="k">for</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">current_stats</span><span class="o">.</span><span class="n">items</span><span class="p">())]))</span>
<span class="go">H1_cplx_loglr: 177.76+0.00j,</span>
<span class="go">H1_optimal_snrsq: 355.52,</span>
<span class="go">L1_cplx_loglr: 104.67+0.00j,</span>
<span class="go">L1_optimal_snrsq: 209.35,</span>
<span class="go">logjacobian: 0.00,</span>
<span class="go">loglikelihood: 0.00,</span>
<span class="go">loglr: 282.43,</span>
<span class="go">logprior: 0.00</span>
</pre></div>
</div>
<p>Compute the SNR; for this system and PSD, this should be approximately 24:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pycbc.conversions</span><span class="w"> </span><span class="kn">import</span> <span class="n">snr_from_loglr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">snr_from_loglr</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">loglr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">23.77</span>
</pre></div>
</div>
<p>Since there is no noise, the SNR should be the same as the quadrature sum
of the optimal SNRs in each detector:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">det_optimal_snrsq</span><span class="p">(</span><span class="s1">&#39;H1&#39;</span><span class="p">)</span> <span class="o">+</span>
<span class="gp">... </span>     <span class="n">model</span><span class="o">.</span><span class="n">det_optimal_snrsq</span><span class="p">(</span><span class="s1">&#39;L1&#39;</span><span class="p">))</span><span class="o">**</span><span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">23.77</span>
</pre></div>
</div>
<p>Toggle on the normalization constant:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">normalize</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">loglikelihood</span>
<span class="go">835397.8757405131</span>
</pre></div>
</div>
<p>Using the same model, evaluate the log likelihood ratio at several points
in time and check that the max is at tsig:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">times</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tsig</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">tsig</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loglrs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="p">(</span><span class="n">ii</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">times</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">tc</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">loglrs</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">loglr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;tsig: </span><span class="si">{:.2f}</span><span class="s1">, time of max loglr: </span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">tsig</span><span class="p">,</span> <span class="n">times</span><span class="p">[</span><span class="n">loglrs</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]))</span>
<span class="go">tsig: 3.10, time of max loglr: 3.10</span>
</pre></div>
</div>
<p>Create a prior and use it (see distributions module for more details):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pycbc</span><span class="w"> </span><span class="kn">import</span> <span class="n">distributions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uniform_prior</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="n">tc</span><span class="o">=</span><span class="p">(</span><span class="n">tsig</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span><span class="n">tsig</span><span class="o">+</span><span class="mf">0.2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prior</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">JointDistribution</span><span class="p">(</span><span class="n">variable_params</span><span class="p">,</span> <span class="n">uniform_prior</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">GaussianNoise</span><span class="p">(</span><span class="n">variable_params</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">signal</span><span class="p">,</span> <span class="n">low_frequency_cutoff</span><span class="p">,</span> <span class="n">psds</span><span class="o">=</span><span class="n">psds</span><span class="p">,</span> <span class="n">prior</span><span class="o">=</span><span class="n">prior</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">static_params</span><span class="o">=</span><span class="n">static_params</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">tc</span><span class="o">=</span><span class="n">tsig</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">logplr</span><span class="p">))</span>
<span class="go">283.35</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">: </span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<span class="gp">... </span>                  <span class="k">for</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">current_stats</span><span class="o">.</span><span class="n">items</span><span class="p">())]))</span>
<span class="go">H1_cplx_loglr: 177.76+0.00j,</span>
<span class="go">H1_optimal_snrsq: 355.52,</span>
<span class="go">L1_cplx_loglr: 104.67+0.00j,</span>
<span class="go">L1_optimal_snrsq: 209.35,</span>
<span class="go">logjacobian: 0.00,</span>
<span class="go">loglikelihood: 0.00,</span>
<span class="go">loglr: 282.43,</span>
<span class="go">logprior: 0.92</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.GaussianNoise.det_cplx_loglr">
<span class="sig-name descname"><span class="pre">det_cplx_loglr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gaussian_noise.html#GaussianNoise.det_cplx_loglr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.GaussianNoise.det_cplx_loglr" title="Link to this definition"></a></dt>
<dd><p>Returns the complex log likelihood ratio in the given detector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>det</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The name of the detector.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The complex log likelihood ratio.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>complex float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.GaussianNoise.det_optimal_snrsq">
<span class="sig-name descname"><span class="pre">det_optimal_snrsq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gaussian_noise.html#GaussianNoise.det_optimal_snrsq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.GaussianNoise.det_optimal_snrsq" title="Link to this definition"></a></dt>
<dd><p>Returns the opitmal SNR squared in the given detector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>det</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The name of the detector.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The opimtal SNR squared.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.GaussianNoise.get_waveforms">
<span class="sig-name descname"><span class="pre">get_waveforms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gaussian_noise.html#GaussianNoise.get_waveforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.GaussianNoise.get_waveforms" title="Link to this definition"></a></dt>
<dd><p>The waveforms generated using the current parameters.</p>
<p>If the waveforms haven’t been generated yet, they will be generated.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary of detector names -&gt; FrequencySeries.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.GaussianNoise.multi_loglikelihood">
<span class="sig-name descname"><span class="pre">multi_loglikelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">models</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gaussian_noise.html#GaussianNoise.multi_loglikelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.GaussianNoise.multi_loglikelihood" title="Link to this definition"></a></dt>
<dd><p>Calculate a multi-model (signal) likelihood</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.GaussianNoise.multi_signal_support">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">multi_signal_support</span></span><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.GaussianNoise.multi_signal_support" title="Link to this definition"></a></dt>
<dd><p>The list of classes that this model supports in a multi-signal
likelihood</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.GaussianNoise.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'gaussian_noise'</span></em><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.GaussianNoise.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.catch_waveform_error">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.gaussian_noise.</span></span><span class="sig-name descname"><span class="pre">catch_waveform_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gaussian_noise.html#catch_waveform_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.catch_waveform_error" title="Link to this definition"></a></dt>
<dd><p>Decorator that will catch no waveform errors.</p>
<p>This can be added to a method in an inference model. The decorator will
call the model’s <cite>_nowaveform_return</cite> method if either of the following
happens when the wrapped method is executed:</p>
<blockquote>
<div><ul class="simple">
<li><p>A <cite>NoWaveformError</cite> is raised.</p></li>
<li><p>A <cite>RuntimeError</cite> or <cite>FailedWaveformError</cite> is raised and the model has
an <cite>ignore_failed_waveforms</cite> attribute that is set to True.</p></li>
</ul>
</div></blockquote>
<p>This requires the model to have a <cite>_nowaveform_handler</cite> method.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.create_waveform_generator">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.gaussian_noise.</span></span><span class="sig-name descname"><span class="pre">create_waveform_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">waveform_transforms=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recalibration=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gates=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generator_class=&lt;class</span> <span class="pre">'pycbc.waveform.generator.FDomainDetFrameGenerator'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**static_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gaussian_noise.html#create_waveform_generator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.create_waveform_generator" title="Link to this definition"></a></dt>
<dd><p>Creates a waveform generator for use with a model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variable_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The names of the parameters varied.</p></li>
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Dictionary mapping detector names to either a
<code class="xref py py-class docutils literal notranslate"><span class="pre">&lt;pycbc.types.TimeSeries</span> <span class="pre">TimeSeries&gt;</span></code> or
<code class="xref py py-class docutils literal notranslate"><span class="pre">&lt;pycbc.types.FrequencySeries</span> <span class="pre">FrequencySeries&gt;</span></code>.</p></li>
<li><p><strong>waveform_transforms</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em>, </em><em>optional</em>) – The list of transforms applied to convert variable parameters into
parameters that will be understood by the waveform generator.</p></li>
<li><p><strong>recalibration</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><em>optional</em>) – Dictionary mapping detector names to
<code class="xref py py-class docutils literal notranslate"><span class="pre">&lt;pycbc.calibration.Recalibrate&gt;</span></code> instances for
recalibrating data.</p></li>
<li><p><strong>gates</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em> of </em><em>tuples</em><em>, </em><em>optional</em>) – Dictionary of detectors -&gt; tuples of specifying gate times. The
sort of thing returned by <code class="xref py py-func docutils literal notranslate"><span class="pre">pycbc.gate.gates_from_cli()</span></code>.</p></li>
<li><p><strong>generator_class</strong> (<em>detector-frame fdomain generator</em><em>, </em><em>optional</em>) – Class to use for generating waveforms. Default is
<code class="xref py py-class docutils literal notranslate"><span class="pre">waveform.generator.FDomainDetFrameGenerator</span></code>.</p></li>
<li><p><strong>**static_params</strong> – All other keyword arguments are passed as static parameters to the
waveform generator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A waveform generator for frequency domain generation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pycbc.waveform.FDomainDetFrameGenerator</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.gaussian_noise.get_values_from_injection">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.gaussian_noise.</span></span><span class="sig-name descname"><span class="pre">get_values_from_injection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">injection_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_cp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/gaussian_noise.html#get_values_from_injection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.gaussian_noise.get_values_from_injection" title="Link to this definition"></a></dt>
<dd><p>Replaces all FROM_INJECTION values in a config file with the
corresponding value from the injection.</p>
<p>This looks for any options that start with <code class="docutils literal notranslate"><span class="pre">FROM_INJECTION[:ARG]</span></code> in
a config file. It then replaces that value with the corresponding value
from the injection file. An argument may be optionally provided, in which
case the argument will be retrieved from the injection file. Functions of
parameters in the injection file may be used; the syntax and functions
available is the same as the <code class="docutils literal notranslate"><span class="pre">--parameters</span></code> argument in executables
such as <code class="docutils literal notranslate"><span class="pre">pycbc_inference_extract_samples</span></code>. If no <code class="docutils literal notranslate"><span class="pre">ARG</span></code> is provided,
then the option name will try to be retrieved from the injection.</p>
<p>For example,</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">mass1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">FROM_INJECTION</span>
</pre></div>
</div>
<p>will cause <code class="docutils literal notranslate"><span class="pre">mass1</span></code> to be retrieved from the injection file, while:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">mass1 = FROM_INJECTION</span><span class="o">:</span><span class="s">&#39;primary_mass(mass1, mass2)&#39;</span>
</pre></div>
</div>
<p>will cause the larger of mass1 and mass2 to be retrieved from the injection
file. Note that if spaces are in the argument, it must be encased in
single quotes.</p>
<p>The injection file may contain only one injection. Otherwise, a ValueError
will be raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cp</strong> (<em>ConfigParser</em>) – The config file within which to replace values.</p></li>
<li><p><strong>injection_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> or </em><em>None</em>) – The injection file to get values from. A ValueError will be raised
if there are any <code class="docutils literal notranslate"><span class="pre">FROM_INJECTION</span></code> values in the config file, and
injection file is None, or if there is more than one injection.</p></li>
<li><p><strong>update_cp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – Update the config parser with the replaced parameters. If False,
will just retrieve the parameter values to update, without updating
the config file. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The parameters that were replaced, as a tuple of section name, option,
value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)">list</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pycbc.inference.models.hierarchical">
<span id="pycbc-inference-models-hierarchical-module"></span><h2>pycbc.inference.models.hierarchical module<a class="headerlink" href="#module-pycbc.inference.models.hierarchical" title="Link to this heading"></a></h2>
<p>Hierarchical model definitions.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.HierarchicalModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.hierarchical.</span></span><span class="sig-name descname"><span class="pre">HierarchicalModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">submodels</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/hierarchical.html#HierarchicalModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.hierarchical.HierarchicalModel" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.models.base.BaseModel" title="pycbc.inference.models.base.BaseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></a></p>
<p>Model that is a combination of other models.</p>
<p>Sub-models are treated as being independent of each other, although
they can share parameters. In other words, the hierarchical likelihood is:</p>
<div class="math notranslate nohighlight">
\[p(\mathbf{D}|\mathbf{\vartheta}, \mathbf{H}) =
    \prod_{I}^{K} p(\mathbf{d}_I|\mathbf{\vartheta}, H_{I})\]</div>
<p>Submodels are provided as a dictionary upon initialization with a unique
label assigned to each model, e.g., <code class="docutils literal notranslate"><span class="pre">{'event1'</span> <span class="pre">-&gt;</span> <span class="pre">model1,</span> <span class="pre">'event2'</span> <span class="pre">-&gt;</span>
<span class="pre">model2}</span></code>. Variable and static parameters that are specific to each
submodel should be prepended with <code class="docutils literal notranslate"><span class="pre">{label}__</span></code>, where <code class="docutils literal notranslate"><span class="pre">{label}__</span></code> is the
label associated with the given submodel. Shared parameters across multiple
models have no labels prepended. To specify shared models over a subset of
models, separate models with an underscore.  For example,
<code class="docutils literal notranslate"><span class="pre">event1_event2__foo</span></code> will result in <code class="docutils literal notranslate"><span class="pre">foo</span></code> being common between models
<code class="docutils literal notranslate"><span class="pre">event1</span></code> and <code class="docutils literal notranslate"><span class="pre">event2</span></code>. For more details on parameter naming see
<a class="reference internal" href="#pycbc.inference.models.hierarchical.HierarchicalParam" title="pycbc.inference.models.hierarchical.HierarchicalParam"><code class="xref py py-class docutils literal notranslate"><span class="pre">HierarchicalParam</span></code></a>.</p>
<p>All waveform and sampling transforms, as well as prior evaluation, are
handled by this model, not the sub-models. Parameters created by waveform
transforms should therefore also have sub-model names prepended to them,
to indicate which models they should be provided to for likelihood
evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variable_params</strong> (<em>(</em><em>tuple of</em><em>) </em><em>string</em><em>(</em><em>s</em><em>)</em>) – A tuple of parameter names that will be varied.</p></li>
<li><p><strong>submodels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Dictionary of model labels -&gt; model instances of all the submodels.</p></li>
<li><p><strong>**kwargs</strong> – All other keyword arguments are passed to
<a class="reference internal" href="#pycbc.inference.models.base.BaseModel" title="pycbc.inference.models.base.BaseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.HierarchicalModel.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cp</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/hierarchical.html#HierarchicalModel.from_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.hierarchical.HierarchicalModel.from_config" title="Link to this definition"></a></dt>
<dd><p>Initializes an instance of this class from the given config file.</p>
<p>Sub-models are initialized before initializing this class. The model
section must have a <code class="docutils literal notranslate"><span class="pre">submodels</span></code> argument that lists the names of all
the submodels to generate as a space-separated list. Each sub-model
should have its own <code class="docutils literal notranslate"><span class="pre">[{label}__model]</span></code> section that sets up the
model for that sub-model. For example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[model]</span>
<span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">hierarchical</span>
<span class="na">submodels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">event1 event2</span>

<span class="k">[event1__model]</span>
<span class="na">&lt;event1 model options&gt;</span>

<span class="k">[event2__model]</span>
<span class="na">&lt;event2 model options&gt;</span>
</pre></div>
</div>
<p>Similarly, all other sections that are specific to a model should start
with the model’s label. All sections starting with a model’s label will
be passed to that model’s <code class="docutils literal notranslate"><span class="pre">from_config</span></code> method with the label removed
from the section name. For example, if a sub-model requires a data
section to be specified, it should be titled <code class="docutils literal notranslate"><span class="pre">[{label}__data]</span></code>. Upon
initialization, the <code class="docutils literal notranslate"><span class="pre">{label}__</span></code> will be stripped from the section
header and passed to the model.</p>
<p>No model labels should preceed the <code class="docutils literal notranslate"><span class="pre">variable_params</span></code>,
<code class="docutils literal notranslate"><span class="pre">static_params</span></code>, <code class="docutils literal notranslate"><span class="pre">waveform_transforms</span></code>, or <code class="docutils literal notranslate"><span class="pre">sampling_transforms</span></code>
sections.  Instead, the parameters specified in these sections should
follow the naming conventions described in <code class="xref py py-class docutils literal notranslate"><span class="pre">HierachicalParam</span></code>
to determine which sub-model(s) they belong to. (Sampling parameters
can follow any naming convention, as they are only handled by the
hierarchical model.) This is because the hierarchical model handles
all transforms, communication with the sampler, file IO, and prior
calculation. Only sub-model’s loglikelihood functions are called.</p>
<p>Metadata for each sub-model is written to the output hdf file under
groups given by the sub-model label. For example, if we have two
submodels labelled <code class="docutils literal notranslate"><span class="pre">event1</span></code> and <code class="docutils literal notranslate"><span class="pre">event2</span></code>, there will be groups
with the same names in the top level of the output that contain that
model’s subdata. For instance, if event1 used the <code class="docutils literal notranslate"><span class="pre">gaussian_noise</span></code>
model, the GW data and PSDs will be found in <code class="docutils literal notranslate"><span class="pre">event1/data</span></code> and the
low frequency cutoff used for that model will be in the <code class="docutils literal notranslate"><span class="pre">attrs</span></code> of
the <code class="docutils literal notranslate"><span class="pre">event1</span></code> group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cp</strong> (<a class="reference internal" href="pycbc.workflow.html#pycbc.workflow.configuration.WorkflowConfigParser" title="pycbc.workflow.configuration.WorkflowConfigParser"><em>WorkflowConfigParser</em></a>) – Config file parser to read.</p></li>
<li><p><strong>**kwargs</strong> – All additional keyword arguments are passed to the class. Any
provided keyword will override what is in the config file.
Preferencing a keyword argument by <code class="docutils literal notranslate"><span class="pre">{submodel}__</span></code> will send
the parameter as a keyword argument to the specified submodel’s
<code class="docutils literal notranslate"><span class="pre">from_config</span></code> method.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.HierarchicalModel.hstatic_params">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hstatic_params</span></span><a class="headerlink" href="#pycbc.inference.models.hierarchical.HierarchicalModel.hstatic_params" title="Link to this definition"></a></dt>
<dd><p>The static params with <a class="reference internal" href="#pycbc.inference.models.hierarchical.HierarchicalParam" title="pycbc.inference.models.hierarchical.HierarchicalParam"><code class="xref py py-class docutils literal notranslate"><span class="pre">HierarchicalParam</span></code></a> instances used
as dictionary keys.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.HierarchicalModel.hvariable_params">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hvariable_params</span></span><a class="headerlink" href="#pycbc.inference.models.hierarchical.HierarchicalModel.hvariable_params" title="Link to this definition"></a></dt>
<dd><p>The variable params as a tuple of <a class="reference internal" href="#pycbc.inference.models.hierarchical.HierarchicalParam" title="pycbc.inference.models.hierarchical.HierarchicalParam"><code class="xref py py-class docutils literal notranslate"><span class="pre">HierarchicalParam</span></code></a>
instances.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.HierarchicalModel.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'hierarchical'</span></em><a class="headerlink" href="#pycbc.inference.models.hierarchical.HierarchicalModel.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.HierarchicalModel.static_params">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">static_params</span></span><a class="headerlink" href="#pycbc.inference.models.hierarchical.HierarchicalModel.static_params" title="Link to this definition"></a></dt>
<dd><p>Returns the model’s static arguments.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.HierarchicalModel.variable_params">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">variable_params</span></span><a class="headerlink" href="#pycbc.inference.models.hierarchical.HierarchicalModel.variable_params" title="Link to this definition"></a></dt>
<dd><p>Returns the model parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.HierarchicalModel.write_metadata">
<span class="sig-name descname"><span class="pre">write_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/hierarchical.html#HierarchicalModel.write_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.hierarchical.HierarchicalModel.write_metadata" title="Link to this definition"></a></dt>
<dd><p>Adds data to the metadata that’s written.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fp</strong> (<em>pycbc.inference.io.BaseInferenceFile instance</em>) – The inference file to write to.</p></li>
<li><p><strong>group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – If provided, the metadata will be written to the attrs specified
by group, i.e., to <code class="docutils literal notranslate"><span class="pre">fp[group].attrs</span></code>. Otherwise, metadata is
written to the top-level attrs (<code class="docutils literal notranslate"><span class="pre">fp.attrs</span></code>).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.HierarchicalParam">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.hierarchical.</span></span><span class="sig-name descname"><span class="pre">HierarchicalParam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fullname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">possible_models</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/hierarchical.html#HierarchicalParam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.hierarchical.HierarchicalParam" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
<p>Sub-class of str for hierarchical parameter names.</p>
<p>This adds attributes that keep track of the model label(s) the parameter
is associated with, along with the name that is passed to the models.</p>
<p>The following conventions are used for parsing parameter names:</p>
<blockquote>
<div><ul class="simple">
<li><p>Model labels and parameter names are separated by the <code class="docutils literal notranslate"><span class="pre">delim</span></code> class
attribute, which by default is <code class="docutils literal notranslate"><span class="pre">__</span></code>, e.g., <code class="docutils literal notranslate"><span class="pre">event1__mass</span></code>.</p></li>
<li><p>Multiple model labels can be provided by separating the model labels
with the <code class="docutils literal notranslate"><span class="pre">model_delim</span></code> class attribute, which by default is <code class="docutils literal notranslate"><span class="pre">_</span></code>,
e.g., <code class="docutils literal notranslate"><span class="pre">event1_event2__mass</span></code>. Note that this means that individual
model labels cannot contain <code class="docutils literal notranslate"><span class="pre">_</span></code>, else they’ll be parsed as separate
models.</p></li>
<li><p>Parameters that have no model labels prepended to them (i.e., there
is no <code class="docutils literal notranslate"><span class="pre">__</span></code> in the name) are common to all models.</p></li>
</ul>
</div></blockquote>
<p>These parsing rules are applied by the <a class="reference internal" href="#pycbc.inference.models.hierarchical.HierarchicalParam.parse" title="pycbc.inference.models.hierarchical.HierarchicalParam.parse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HierarchicalParam.parse()</span></code></a>
method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fullname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Name of the hierarchical parameter. Should have format
<code class="docutils literal notranslate"><span class="pre">{model1}[_{model2}[_{...}]]__{param}</span></code>.</p></li>
<li><p><strong>possible_models</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><em>set</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The possible sub-models a parameter can belong to. Should a set of
model labels.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.HierarchicalParam.fullname">
<span class="sig-name descname"><span class="pre">fullname</span></span><a class="headerlink" href="#pycbc.inference.models.hierarchical.HierarchicalParam.fullname" title="Link to this definition"></a></dt>
<dd><p>The full name of the parameter, including model labels. For example,
<code class="docutils literal notranslate"><span class="pre">e1_e2__foo</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.HierarchicalParam.models">
<span class="sig-name descname"><span class="pre">models</span></span><a class="headerlink" href="#pycbc.inference.models.hierarchical.HierarchicalParam.models" title="Link to this definition"></a></dt>
<dd><p>The model labels the parameter is associated with. For example,
<code class="docutils literal notranslate"><span class="pre">e1_e2__foo</span></code> yields models <code class="docutils literal notranslate"><span class="pre">e1,</span> <span class="pre">e2</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)">set</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.HierarchicalParam.subname">
<span class="sig-name descname"><span class="pre">subname</span></span><a class="headerlink" href="#pycbc.inference.models.hierarchical.HierarchicalParam.subname" title="Link to this definition"></a></dt>
<dd><p>The name of the parameter without the model labels prepended to it.
For example, <code class="docutils literal notranslate"><span class="pre">e1_e2__foo</span></code> yields <code class="docutils literal notranslate"><span class="pre">foo</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.HierarchicalParam.delim">
<span class="sig-name descname"><span class="pre">delim</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'__'</span></em><a class="headerlink" href="#pycbc.inference.models.hierarchical.HierarchicalParam.delim" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.HierarchicalParam.from_subname">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_subname</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/hierarchical.html#HierarchicalParam.from_subname"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.hierarchical.HierarchicalParam.from_subname" title="Link to this definition"></a></dt>
<dd><p>Creates a HierarchicalParam from the given subname and model label.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.HierarchicalParam.model_delim">
<span class="sig-name descname"><span class="pre">model_delim</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'_'</span></em><a class="headerlink" href="#pycbc.inference.models.hierarchical.HierarchicalParam.model_delim" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.HierarchicalParam.parse">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fullname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">possible_models</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/hierarchical.html#HierarchicalParam.parse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.hierarchical.HierarchicalParam.parse" title="Link to this definition"></a></dt>
<dd><p>Parses the full parameter name into the models the parameter is
associated with and the parameter name that is passed to the models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fullname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The full name of the parameter, which includes both the model
label(s) and the parameter name.</p></li>
<li><p><strong>possible_models</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><em>set</em></a>) – Set of model labels the parameter can be associated with.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>models</strong> (<em>list</em>) – List of the model labels the parameter is associated with.</p></li>
<li><p><strong>subp</strong> (<em>str</em>) – Parameter name that is passed to the models. This is the parameter
name with the model label(s) stripped from it.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.JointPrimaryMarginalizedModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.hierarchical.</span></span><span class="sig-name descname"><span class="pre">JointPrimaryMarginalizedModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">submodels</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/hierarchical.html#JointPrimaryMarginalizedModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.hierarchical.JointPrimaryMarginalizedModel" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.models.hierarchical.HierarchicalModel" title="pycbc.inference.models.hierarchical.HierarchicalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">HierarchicalModel</span></code></a></p>
<p>This likelihood model can be used for cases when one of the submodels
can be marginalized to accelerate the total likelihood. This likelihood
model also allows for further acceleration of other models during
marginalization, if some extrinsic parameters can be tightly constrained
by the primary model. More specifically, such as the EM + GW parameter
estimation, the sky localization can be well measured. For LISA + 3G
multiband observation, SOBHB signals’ (tc, ra, dec) can be tightly
constrained by 3G network, so this model is also useful for this case.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.JointPrimaryMarginalizedModel.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cp</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/hierarchical.html#JointPrimaryMarginalizedModel.from_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.hierarchical.JointPrimaryMarginalizedModel.from_config" title="Link to this definition"></a></dt>
<dd><p>Initializes an instance of this class from the given config file.
For more details, see <cite>from_config</cite> in <cite>HierarchicalModel</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cp</strong> (<a class="reference internal" href="pycbc.workflow.html#pycbc.workflow.configuration.WorkflowConfigParser" title="pycbc.workflow.configuration.WorkflowConfigParser"><em>WorkflowConfigParser</em></a>) – Config file parser to read.</p></li>
<li><p><strong>**kwargs</strong> – All additional keyword arguments are passed to the class. Any
provided keyword will override what is in the config file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.JointPrimaryMarginalizedModel.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'joint_primary_marginalized'</span></em><a class="headerlink" href="#pycbc.inference.models.hierarchical.JointPrimaryMarginalizedModel.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.JointPrimaryMarginalizedModel.others_lognl">
<span class="sig-name descname"><span class="pre">others_lognl</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/hierarchical.html#JointPrimaryMarginalizedModel.others_lognl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.hierarchical.JointPrimaryMarginalizedModel.others_lognl" title="Link to this definition"></a></dt>
<dd><p>Calculate the combined lognl from all others sub-models.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.JointPrimaryMarginalizedModel.reconstruct">
<span class="sig-name descname"><span class="pre">reconstruct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/hierarchical.html#JointPrimaryMarginalizedModel.reconstruct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.hierarchical.JointPrimaryMarginalizedModel.reconstruct" title="Link to this definition"></a></dt>
<dd><p>Reconstruct marginalized parameters by using the primary
model’s reconstruct method, total_loglr, and others_lognl.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.JointPrimaryMarginalizedModel.total_loglr">
<span class="sig-name descname"><span class="pre">total_loglr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/hierarchical.html#JointPrimaryMarginalizedModel.total_loglr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.hierarchical.JointPrimaryMarginalizedModel.total_loglr" title="Link to this definition"></a></dt>
<dd><p>Computes the total log likelihood ratio,</p>
<div class="math notranslate nohighlight">
\[\log \mathcal{L}(\Theta) = \sum_i
    \left&lt;h_i(\Theta)|d_i\right&gt; -
    \frac{1}{2}\left&lt;h_i(\Theta)|h_i(\Theta)\right&gt;,\]</div>
<p>at the current parameter values <span class="math notranslate nohighlight">\(\Theta\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The value of the log likelihood ratio.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.JointPrimaryMarginalizedModel.update_all_models">
<span class="sig-name descname"><span class="pre">update_all_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/hierarchical.html#JointPrimaryMarginalizedModel.update_all_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.hierarchical.JointPrimaryMarginalizedModel.update_all_models" title="Link to this definition"></a></dt>
<dd><p>This update method is also useful for loglr checking,
the original update method in base module can’t update
parameters in submodels correctly in loglr checking.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.JointPrimaryMarginalizedModel.write_metadata">
<span class="sig-name descname"><span class="pre">write_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/hierarchical.html#JointPrimaryMarginalizedModel.write_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.hierarchical.JointPrimaryMarginalizedModel.write_metadata" title="Link to this definition"></a></dt>
<dd><p>Adds metadata to the output files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fp</strong> (<em>pycbc.inference.io.BaseInferenceFile instance</em>) – The inference file to write to.</p></li>
<li><p><strong>group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – If provided, the metadata will be written to the attrs specified
by group, i.e., to <code class="docutils literal notranslate"><span class="pre">fp[group].attrs</span></code>. Otherwise, metadata is
written to the top-level attrs (<code class="docutils literal notranslate"><span class="pre">fp.attrs</span></code>).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.MultiSignalModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.hierarchical.</span></span><span class="sig-name descname"><span class="pre">MultiSignalModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">submodels</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/hierarchical.html#MultiSignalModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.hierarchical.MultiSignalModel" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.models.hierarchical.HierarchicalModel" title="pycbc.inference.models.hierarchical.HierarchicalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">HierarchicalModel</span></code></a></p>
<p>Model for multiple signals which share data</p>
<p>Sub models are treated as if the signals overlap in data. This requires
constituent models to implement a specific method to handle this case.
All models must be of the same type or the specific model is responsible
for implement cross-compatibility with another model. Each model h_i is
responsible for calculating its own loglikelihood ratio for itself, and
must also implement a method to calculate crossterms of the form
&lt;h_i | h_j&gt; which arise from the full calculation of &lt;d - h|d - h&gt;.
This model inherits from the HierarchicalModel so the syntax for
configuration files is the same. The primary model is used to determine
the noise terms &lt;d | d&gt;, which by default will be the first model used.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.MultiSignalModel.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'multi_signal'</span></em><a class="headerlink" href="#pycbc.inference.models.hierarchical.MultiSignalModel.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.MultiSignalModel.write_metadata">
<span class="sig-name descname"><span class="pre">write_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/hierarchical.html#MultiSignalModel.write_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.hierarchical.MultiSignalModel.write_metadata" title="Link to this definition"></a></dt>
<dd><p>Adds metadata to the output files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fp</strong> (<em>pycbc.inference.io.BaseInferenceFile instance</em>) – The inference file to write to.</p></li>
<li><p><strong>group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – If provided, the metadata will be written to the attrs specified
by group, i.e., to <code class="docutils literal notranslate"><span class="pre">fp[group].attrs</span></code>. Otherwise, metadata is
written to the top-level attrs (<code class="docutils literal notranslate"><span class="pre">fp.attrs</span></code>).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.hpiter">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.hierarchical.</span></span><span class="sig-name descname"><span class="pre">hpiter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">possible_models</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/hierarchical.html#hpiter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.hierarchical.hpiter" title="Link to this definition"></a></dt>
<dd><p>Turns a list of parameter strings into a list of HierarchicalParams.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – List of parameter names.</p></li>
<li><p><strong>possible_models</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><em>set</em></a>) – Set of model labels the parameters can be associated with.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Iterator of <a class="reference internal" href="#pycbc.inference.models.hierarchical.HierarchicalParam" title="pycbc.inference.models.hierarchical.HierarchicalParam"><code class="xref py py-class docutils literal notranslate"><span class="pre">HierarchicalParam</span></code></a> instances.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>iterator</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.hierarchical.map_params">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.hierarchical.</span></span><span class="sig-name descname"><span class="pre">map_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/hierarchical.html#map_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.hierarchical.map_params" title="Link to this definition"></a></dt>
<dd><p>Creates a map of models -&gt; parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><em>HierarchicalParam instances</em>) – The list of hierarchical parameter names to parse.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of model labels -&gt; associated parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pycbc.inference.models.marginalized_gaussian_noise">
<span id="pycbc-inference-models-marginalized-gaussian-noise-module"></span><h2>pycbc.inference.models.marginalized_gaussian_noise module<a class="headerlink" href="#module-pycbc.inference.models.marginalized_gaussian_noise" title="Link to this heading"></a></h2>
<p>This module provides model classes that assume the noise is Gaussian and
allows for the likelihood to be marginalized over phase and/or time and/or
distance.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.marginalized_gaussian_noise.MarginalizedHMPolPhase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.marginalized_gaussian_noise.</span></span><span class="sig-name descname"><span class="pre">MarginalizedHMPolPhase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_frequency_cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_frequency_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polarization_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coa_phase_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">static_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/marginalized_gaussian_noise.html#MarginalizedHMPolPhase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.marginalized_gaussian_noise.MarginalizedHMPolPhase" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise" title="pycbc.inference.models.gaussian_noise.BaseGaussianNoise"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseGaussianNoise</span></code></a></p>
<p>Numerically marginalizes waveforms with higher modes over polarization
<cite>and</cite> phase.</p>
<p>This class implements the Gaussian likelihood with an explicit numerical
marginalization over polarization angle and orbital phase. This is
accomplished using a fixed set of integration points distributed uniformly
between 0 and 2:math:<cite>pi</cite> for both the polarization and phase. By default,
100 integration points are used for each parameter, giving <span class="math notranslate nohighlight">\(10^4\)</span>
evaluation points in total. This can be modified using the
<code class="docutils literal notranslate"><span class="pre">polarization_samples</span></code> and <code class="docutils literal notranslate"><span class="pre">coa_phase_samples</span></code> arguments.</p>
<p>This only works with waveforms that return separate spherical harmonic
modes for each waveform. For a list of currently supported approximants,
see <a class="reference internal" href="pycbc.waveform.html#pycbc.waveform.waveform_modes.fd_waveform_mode_approximants" title="pycbc.waveform.waveform_modes.fd_waveform_mode_approximants"><code class="xref py py-func docutils literal notranslate"><span class="pre">pycbc.waveform.waveform_modes.fd_waveform_mode_approximants()</span></code></a>
and <a class="reference internal" href="pycbc.waveform.html#pycbc.waveform.waveform_modes.td_waveform_mode_approximants" title="pycbc.waveform.waveform_modes.td_waveform_mode_approximants"><code class="xref py py-func docutils literal notranslate"><span class="pre">pycbc.waveform.waveform_modes.td_waveform_mode_approximants()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variable_params</strong> (<em>(</em><em>tuple of</em><em>) </em><em>string</em><em>(</em><em>s</em><em>)</em>) – A tuple of parameter names that will be varied.</p></li>
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – A dictionary of data, in which the keys are the detector names and the
values are the data (assumed to be unwhitened). All data must have the
same frequency resolution.</p></li>
<li><p><strong>low_frequency_cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – A dictionary of starting frequencies, in which the keys are the
detector names and the values are the starting frequencies for the
respective detectors to be used for computing inner products.</p></li>
<li><p><strong>psds</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><em>optional</em>) – A dictionary of FrequencySeries keyed by the detector names. The
dictionary must have a psd for each detector specified in the data
dictionary. If provided, the inner products in each detector will be
weighted by 1/psd of that detector.</p></li>
<li><p><strong>high_frequency_cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><em>optional</em>) – A dictionary of ending frequencies, in which the keys are the
detector names and the values are the ending frequencies for the
respective detectors to be used for computing inner products. If not
provided, the minimum of the largest frequency stored in the data
and a given waveform will be used.</p></li>
<li><p><strong>normalize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, the normalization factor <span class="math notranslate nohighlight">\(alpha\)</span> will be included in the
log likelihood. See <code class="xref py py-class docutils literal notranslate"><span class="pre">GaussianNoise</span></code> for details. Default is
to not include it.</p></li>
<li><p><strong>polarization_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) – How many points to use in polarization. Default is 100.</p></li>
<li><p><strong>coa_phase_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) – How many points to use in phase. Defaults is 100.</p></li>
<li><p><strong>**kwargs</strong> – All other keyword arguments are passed to
<a class="reference internal" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise" title="pycbc.inference.models.gaussian_noise.BaseGaussianNoise"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseGaussianNoise</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.marginalized_gaussian_noise.MarginalizedHMPolPhase.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'marginalized_hmpolphase'</span></em><a class="headerlink" href="#pycbc.inference.models.marginalized_gaussian_noise.MarginalizedHMPolPhase.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.marginalized_gaussian_noise.MarginalizedHMPolPhase.phase_fac">
<span class="sig-name descname"><span class="pre">phase_fac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/marginalized_gaussian_noise.html#MarginalizedHMPolPhase.phase_fac"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.marginalized_gaussian_noise.MarginalizedHMPolPhase.phase_fac" title="Link to this definition"></a></dt>
<dd><p>The phase <span class="math notranslate nohighlight">\(\exp[i m \phi]\)</span>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.marginalized_gaussian_noise.MarginalizedPhaseGaussianNoise">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.marginalized_gaussian_noise.</span></span><span class="sig-name descname"><span class="pre">MarginalizedPhaseGaussianNoise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_frequency_cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_frequency_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">static_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/marginalized_gaussian_noise.html#MarginalizedPhaseGaussianNoise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.marginalized_gaussian_noise.MarginalizedPhaseGaussianNoise" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.models.gaussian_noise.GaussianNoise" title="pycbc.inference.models.gaussian_noise.GaussianNoise"><code class="xref py py-class docutils literal notranslate"><span class="pre">GaussianNoise</span></code></a></p>
<p>The likelihood is analytically marginalized over phase.</p>
<p>This class can be used with signal models that can be written as:</p>
<div class="math notranslate nohighlight">
\[\tilde{h}(f; \Theta, \phi) = A(f; \Theta)e^{i\Psi(f; \Theta) + i \phi},\]</div>
<p>where <span class="math notranslate nohighlight">\(\phi\)</span> is an arbitrary phase constant. This phase constant
can be analytically marginalized over with a uniform prior as follows:
assuming the noise is stationary and Gaussian (see <cite>GaussianNoise</cite>
for details), the posterior is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}p(\Theta,\phi|d)
    &amp;\propto p(\Theta)p(\phi)p(d|\Theta,\phi) \\
    &amp;\propto p(\Theta)\frac{1}{2\pi}\exp\left[
        -\frac{1}{2}\sum_{i}^{N_D} \left&lt;
            h_i(\Theta,\phi) - d_i, h_i(\Theta,\phi) - d_i
        \right&gt;\right].\end{split}\]</div>
<p>Here, the sum is over the number of detectors <span class="math notranslate nohighlight">\(N_D\)</span>, <span class="math notranslate nohighlight">\(d_i\)</span>
and <span class="math notranslate nohighlight">\(h_i\)</span> are the data and signal in detector <span class="math notranslate nohighlight">\(i\)</span>,
respectively, and we have assumed a uniform prior on <span class="math notranslate nohighlight">\(\phi \in [0,
2\pi)\)</span>. With the form of the signal model given above, the inner product
in the exponent can be written as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}-\frac{1}{2}\left&lt;h_i - d_i, h_i- d_i\right&gt;
    &amp;= \left&lt;h_i, d_i\right&gt; -
       \frac{1}{2}\left&lt;h_i, h_i\right&gt; -
       \frac{1}{2}\left&lt;d_i, d_i\right&gt; \\
    &amp;= \Re\left\{O(h^0_i, d_i)e^{-i\phi}\right\} -
       \frac{1}{2}\left&lt;h^0_i, h^0_i\right&gt; -
       \frac{1}{2}\left&lt;d_i, d_i\right&gt;,\end{split}\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[\begin{split}h_i^0 &amp;\equiv \tilde{h}_i(f; \Theta, \phi=0); \\
O(h^0_i, d_i) &amp;\equiv 4 \int_0^\infty
    \frac{\tilde{h}_i^*(f; \Theta,0)\tilde{d}_i(f)}{S_n(f)}\mathrm{d}f.\end{split}\]</div>
<p>Gathering all of the terms that are not dependent on <span class="math notranslate nohighlight">\(\phi\)</span> together:</p>
<div class="math notranslate nohighlight">
\[\alpha(\Theta, d) \equiv \exp\left[-\frac{1}{2}\sum_i
    \left&lt;h^0_i, h^0_i\right&gt; + \left&lt;d_i, d_i\right&gt;\right],\]</div>
<p>we can marginalize the posterior over <span class="math notranslate nohighlight">\(\phi\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}p(\Theta|d)
    &amp;\propto p(\Theta)\alpha(\Theta,d)\frac{1}{2\pi}
             \int_{0}^{2\pi}\exp\left[\Re \left\{
                 e^{-i\phi} \sum_i O(h^0_i, d_i)
             \right\}\right]\mathrm{d}\phi \\
    &amp;\propto p(\Theta)\alpha(\Theta, d)\frac{1}{2\pi}
             \int_{0}^{2\pi}\exp\left[
                 x(\Theta,d)\cos(\phi) + y(\Theta, d)\sin(\phi)
             \right]\mathrm{d}\phi.\end{split}\]</div>
<p>The integral in the last line is equal to <span class="math notranslate nohighlight">\(2\pi I_0(\sqrt{x^2+y^2})\)</span>,
where <span class="math notranslate nohighlight">\(I_0\)</span> is the modified Bessel function of the first kind. Thus
the marginalized posterior is:</p>
<div class="math notranslate nohighlight">
\[p(\Theta|d) \propto
    I_0\left(\left|\sum_i O(h^0_i, d_i)\right|\right)
     p(\Theta)\exp\left[\frac{1}{2}\sum_i\left( \left&lt;h^0_i, h^0_i\right&gt; -
                            \left&lt;d_i, d_i\right&gt; \right)\right]\]</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.marginalized_gaussian_noise.MarginalizedPhaseGaussianNoise.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'marginalized_phase'</span></em><a class="headerlink" href="#pycbc.inference.models.marginalized_gaussian_noise.MarginalizedPhaseGaussianNoise.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.marginalized_gaussian_noise.MarginalizedPolarization">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.marginalized_gaussian_noise.</span></span><span class="sig-name descname"><span class="pre">MarginalizedPolarization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_frequency_cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_frequency_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polarization_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/marginalized_gaussian_noise.html#MarginalizedPolarization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.marginalized_gaussian_noise.MarginalizedPolarization" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.models.tools.DistMarg" title="pycbc.inference.models.tools.DistMarg"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistMarg</span></code></a>, <a class="reference internal" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise" title="pycbc.inference.models.gaussian_noise.BaseGaussianNoise"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseGaussianNoise</span></code></a></p>
<p>This likelihood numerically marginalizes over polarization angle</p>
<p>This class implements the Gaussian likelihood with an explicit numerical
marginalization over polarization angle. This is accomplished using
a fixed set of integration points distribution uniformation between
0 and 2pi. By default, 1000 integration points are used.
The ‘polarization_samples’ argument can be passed to set an alternate
number of integration points.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.marginalized_gaussian_noise.MarginalizedPolarization.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'marginalized_polarization'</span></em><a class="headerlink" href="#pycbc.inference.models.marginalized_gaussian_noise.MarginalizedPolarization.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.marginalized_gaussian_noise.MarginalizedTime">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.marginalized_gaussian_noise.</span></span><span class="sig-name descname"><span class="pre">MarginalizedTime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_frequency_cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_frequency_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/marginalized_gaussian_noise.html#MarginalizedTime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.marginalized_gaussian_noise.MarginalizedTime" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.models.tools.DistMarg" title="pycbc.inference.models.tools.DistMarg"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistMarg</span></code></a>, <a class="reference internal" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise" title="pycbc.inference.models.gaussian_noise.BaseGaussianNoise"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseGaussianNoise</span></code></a></p>
<p>This likelihood numerically marginalizes over time</p>
<p>This likelihood is optimized for marginalizing over time, but can also
handle marginalization over polarization, phase (where appropriate),
and sky location. The time series is interpolated using a
quadratic apparoximation for sub-sample times.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.marginalized_gaussian_noise.MarginalizedTime.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'marginalized_time'</span></em><a class="headerlink" href="#pycbc.inference.models.marginalized_gaussian_noise.MarginalizedTime.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-pycbc.inference.models.relbin">
<span id="pycbc-inference-models-relbin-module"></span><h2>pycbc.inference.models.relbin module<a class="headerlink" href="#module-pycbc.inference.models.relbin" title="Link to this heading"></a></h2>
<p>This module provides model classes and functions for implementing
a relative binning likelihood for parameter estimation.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin.Relative">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.relbin.</span></span><span class="sig-name descname"><span class="pre">Relative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_frequency_cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fiducial_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gammas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">earth_rotation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">earth_rotation_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marginalize_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/relbin.html#Relative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.relbin.Relative" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.models.tools.DistMarg" title="pycbc.inference.models.tools.DistMarg"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistMarg</span></code></a>, <a class="reference internal" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise" title="pycbc.inference.models.gaussian_noise.BaseGaussianNoise"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseGaussianNoise</span></code></a></p>
<p>Model that assumes the likelihood in a region around the peak
is slowly varying such that a linear approximation can be made, and
likelihoods can be calculated at a coarser frequency resolution. For
more details on the implementation, see <a class="reference external" href="https://arxiv.org/abs/1806.08792">https://arxiv.org/abs/1806.08792</a>.</p>
<p>This model requires the use of a fiducial waveform whose parameters are
near the peak of the likelihood. The fiducial waveform and all template
waveforms used in likelihood calculation are currently generated using
the SPAtmplt approximant.</p>
<p>For more details on initialization parameters and definition of terms, see
<code class="xref py py-class docutils literal notranslate"><span class="pre">BaseGaussianNoise</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variable_params</strong> (<em>(</em><em>tuple of</em><em>) </em><em>string</em><em>(</em><em>s</em><em>)</em>) – A tuple of parameter names that will be varied.</p></li>
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – A dictionary of data, in which the keys are the detector names and the
values are the data (assumed to be unwhitened). All data must have the
same frequency resolution.</p></li>
<li><p><strong>low_frequency_cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – A dictionary of starting frequencies, in which the keys are the
detector names and the values are the starting frequencies for the
respective detectors to be used for computing inner products.</p></li>
<li><p><strong>figucial_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – A dictionary of waveform parameters to be used for generating the
fiducial waveform. Keys must be parameter names in the form
‘PARAM_ref’ where PARAM is a recognized extrinsic parameter or
an intrinsic parameter compatible with the chosen approximant.</p></li>
<li><p><strong>gammas</strong> (<em>array</em><em> of </em><em>floats</em><em>, </em><em>optional</em>) – Frequency powerlaw indices to be used in computing frequency bins.</p></li>
<li><p><strong>epsilon</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Tuning parameter used in calculating the frequency bins. Lower values
will result in higher resolution and more bins.</p></li>
<li><p><strong>earth_rotation</strong> (<em>boolean</em><em>, </em><em>optional</em>) – Default is False. If True, then vary the fp/fc polarization values
as a function of frequency bin, using a predetermined PN approximation
for the time offsets.</p></li>
<li><p><strong>**kwargs</strong> – All other keyword arguments are passed to
<code class="xref py py-class docutils literal notranslate"><span class="pre">BaseGaussianNoise</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin.Relative.calculate_hihjs">
<span class="sig-name descname"><span class="pre">calculate_hihjs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">models</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/relbin.html#Relative.calculate_hihjs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.relbin.Relative.calculate_hihjs" title="Link to this definition"></a></dt>
<dd><p>Pre-calculate the hihj inner products on a grid</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin.Relative.combine_layout">
<span class="sig-name descname"><span class="pre">combine_layout</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/relbin.html#Relative.combine_layout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.relbin.Relative.combine_layout" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin.Relative.extra_args_from_config">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">extra_args_from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">section</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtypes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/relbin.html#Relative.extra_args_from_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.relbin.Relative.extra_args_from_config" title="Link to this definition"></a></dt>
<dd><p>Adds reading fiducial waveform parameters from config file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin.Relative.get_waveforms">
<span class="sig-name descname"><span class="pre">get_waveforms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/relbin.html#Relative.get_waveforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.relbin.Relative.get_waveforms" title="Link to this definition"></a></dt>
<dd><p>Get the waveform polarizations for each ifo</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin.Relative.init_from_frequencies">
<span class="sig-name descname"><span class="pre">init_from_frequencies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h00</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fbin_ind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ifo</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/relbin.html#Relative.init_from_frequencies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.relbin.Relative.init_from_frequencies" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin.Relative.likelihood_function">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">likelihood_function</span></span><a class="headerlink" href="#pycbc.inference.models.relbin.Relative.likelihood_function" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin.Relative.max_curvature_from_reference">
<span class="sig-name descname"><span class="pre">max_curvature_from_reference</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/relbin.html#Relative.max_curvature_from_reference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.relbin.Relative.max_curvature_from_reference" title="Link to this definition"></a></dt>
<dd><p>Return the maximum change in slope between frequency bins
relative to the reference waveform.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin.Relative.multi_loglikelihood">
<span class="sig-name descname"><span class="pre">multi_loglikelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">models</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/relbin.html#Relative.multi_loglikelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.relbin.Relative.multi_loglikelihood" title="Link to this definition"></a></dt>
<dd><p>Calculate a multi-model (signal) likelihood</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin.Relative.multi_signal_support">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">multi_signal_support</span></span><a class="headerlink" href="#pycbc.inference.models.relbin.Relative.multi_signal_support" title="Link to this definition"></a></dt>
<dd><p>The list of classes that this model supports in a multi-signal
likelihood</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin.Relative.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'relative'</span></em><a class="headerlink" href="#pycbc.inference.models.relbin.Relative.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin.Relative.setup_antenna">
<span class="sig-name descname"><span class="pre">setup_antenna</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">earth_rotation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fedges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/relbin.html#Relative.setup_antenna"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.relbin.Relative.setup_antenna" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin.Relative.summary_product">
<span class="sig-name descname"><span class="pre">summary_product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ifo</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/relbin.html#Relative.summary_product"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.relbin.Relative.summary_product" title="Link to this definition"></a></dt>
<dd><p>Calculate the summary values for the inner product &lt;h1|h2&gt;</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin.Relative.write_metadata">
<span class="sig-name descname"><span class="pre">write_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/relbin.html#Relative.write_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.relbin.Relative.write_metadata" title="Link to this definition"></a></dt>
<dd><p>Adds writing the fiducial parameters and epsilon to file’s attrs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fp</strong> (<em>pycbc.inference.io.BaseInferenceFile instance</em>) – The inference file to write to.</p></li>
<li><p><strong>group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – If provided, the metadata will be written to the attrs specified
by group, i.e., to <code class="docutils literal notranslate"><span class="pre">fp[group].attrs</span></code>. Otherwise, metadata is
written to the top-level attrs (<code class="docutils literal notranslate"><span class="pre">fp.attrs</span></code>).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin.RelativeTime">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.relbin.</span></span><span class="sig-name descname"><span class="pre">RelativeTime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4096</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/relbin.html#RelativeTime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.relbin.RelativeTime" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.models.relbin.Relative" title="pycbc.inference.models.relbin.Relative"><code class="xref py py-class docutils literal notranslate"><span class="pre">Relative</span></code></a></p>
<p>Heterodyne likelihood optimized for time marginalization. In addition
it supports phase (dominant-mode), sky location, and polarization
marginalization.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin.RelativeTime.get_snr">
<span class="sig-name descname"><span class="pre">get_snr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wfs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/relbin.html#RelativeTime.get_snr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.relbin.RelativeTime.get_snr" title="Link to this definition"></a></dt>
<dd><p>Return hp/hc maximized SNR time series</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin.RelativeTime.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'relative_time'</span></em><a class="headerlink" href="#pycbc.inference.models.relbin.RelativeTime.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin.RelativeTime.ref_snr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ref_snr</span></span><a class="headerlink" href="#pycbc.inference.models.relbin.RelativeTime.ref_snr" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin.RelativeTimeDom">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.relbin.</span></span><span class="sig-name descname"><span class="pre">RelativeTimeDom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4096</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/relbin.html#RelativeTimeDom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.relbin.RelativeTimeDom" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.models.relbin.RelativeTime" title="pycbc.inference.models.relbin.RelativeTime"><code class="xref py py-class docutils literal notranslate"><span class="pre">RelativeTime</span></code></a></p>
<p>Heterodyne likelihood optimized for time marginalization and only
dominant-mode waveforms. This enables the ability to do inclination
marginalization in addition to the other forms supportedy by RelativeTime.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin.RelativeTimeDom.get_snr">
<span class="sig-name descname"><span class="pre">get_snr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wfs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/relbin.html#RelativeTimeDom.get_snr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.relbin.RelativeTimeDom.get_snr" title="Link to this definition"></a></dt>
<dd><p>Return hp/hc maximized SNR time series</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin.RelativeTimeDom.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'relative_time_dom'</span></em><a class="headerlink" href="#pycbc.inference.models.relbin.RelativeTimeDom.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin.setup_bins">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.relbin.</span></span><span class="sig-name descname"><span class="pre">setup_bins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_lo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_hi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gammas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/relbin.html#setup_bins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.relbin.setup_bins" title="Link to this definition"></a></dt>
<dd><p>Construct frequency bins for use in a relative likelihood
model. For details, see [Barak, Dai &amp; Venumadhav 2018].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f_full</strong> (<em>array</em>) – The full resolution array of frequencies being used in the analysis.</p></li>
<li><p><strong>f_lo</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – The starting frequency used in matched filtering. This will be the
left edge of the first frequency bin.</p></li>
<li><p><strong>f_hi</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – The ending frequency used in matched filtering. This will be the right
edge of the last frequency bin.</p></li>
<li><p><strong>chi</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Tunable parameter, see [Barak, Dai &amp; Venumadhav 2018]</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Tunable parameter, see [Barak, Dai &amp; Venumadhav 2018]. Lower values
result in larger number of bins.</p></li>
<li><p><strong>gammas</strong> (<em>array</em><em>, </em><em>optional</em>) – Frequency powerlaw indices to be used in computing bins.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>nbin</strong> (<em>int</em>) – Number of bins.</p></li>
<li><p><strong>fbin</strong> (<em>numpy.array of floats</em>) – Bin edge frequencies.</p></li>
<li><p><strong>fbin_ind</strong> (<em>numpy.array of ints</em>) – Indices of bin edges in full frequency array.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pycbc.inference.models.relbin_cpu">
<span id="pycbc-inference-models-relbin-cpu-module"></span><h2>pycbc.inference.models.relbin_cpu module<a class="headerlink" href="#module-pycbc.inference.models.relbin_cpu" title="Link to this heading"></a></h2>
<p>Optimized inner loop functions for the relative likelihood model</p>
<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin_cpu.likelihood_parts">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.relbin_cpu.</span></span><span class="sig-name descname"><span class="pre">likelihood_parts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h00</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pycbc.inference.models.relbin_cpu.likelihood_parts" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin_cpu.likelihood_parts_det">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.relbin_cpu.</span></span><span class="sig-name descname"><span class="pre">likelihood_parts_det</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h00</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pycbc.inference.models.relbin_cpu.likelihood_parts_det" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin_cpu.likelihood_parts_det_multi">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.relbin_cpu.</span></span><span class="sig-name descname"><span class="pre">likelihood_parts_det_multi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h00</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtc2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h002</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pycbc.inference.models.relbin_cpu.likelihood_parts_det_multi" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin_cpu.likelihood_parts_multi">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.relbin_cpu.</span></span><span class="sig-name descname"><span class="pre">likelihood_parts_multi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h00</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtc2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hc2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h002</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pycbc.inference.models.relbin_cpu.likelihood_parts_multi" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin_cpu.likelihood_parts_multi_v">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.relbin_cpu.</span></span><span class="sig-name descname"><span class="pre">likelihood_parts_multi_v</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h00</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtc2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hc2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h002</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pycbc.inference.models.relbin_cpu.likelihood_parts_multi_v" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin_cpu.likelihood_parts_v">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.relbin_cpu.</span></span><span class="sig-name descname"><span class="pre">likelihood_parts_v</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h00</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pycbc.inference.models.relbin_cpu.likelihood_parts_v" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin_cpu.likelihood_parts_v_pol">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.relbin_cpu.</span></span><span class="sig-name descname"><span class="pre">likelihood_parts_v_pol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pol_phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h00</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pycbc.inference.models.relbin_cpu.likelihood_parts_v_pol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin_cpu.likelihood_parts_v_pol_time">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.relbin_cpu.</span></span><span class="sig-name descname"><span class="pre">likelihood_parts_v_pol_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pol_phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h00</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pycbc.inference.models.relbin_cpu.likelihood_parts_v_pol_time" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin_cpu.likelihood_parts_v_time">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.relbin_cpu.</span></span><span class="sig-name descname"><span class="pre">likelihood_parts_v_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h00</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pycbc.inference.models.relbin_cpu.likelihood_parts_v_time" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin_cpu.likelihood_parts_vector">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.relbin_cpu.</span></span><span class="sig-name descname"><span class="pre">likelihood_parts_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h00</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pycbc.inference.models.relbin_cpu.likelihood_parts_vector" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin_cpu.likelihood_parts_vectorp">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.relbin_cpu.</span></span><span class="sig-name descname"><span class="pre">likelihood_parts_vectorp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h00</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pycbc.inference.models.relbin_cpu.likelihood_parts_vectorp" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin_cpu.likelihood_parts_vectort">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.relbin_cpu.</span></span><span class="sig-name descname"><span class="pre">likelihood_parts_vectort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h00</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pycbc.inference.models.relbin_cpu.likelihood_parts_vectort" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin_cpu.snr_predictor">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.relbin_cpu.</span></span><span class="sig-name descname"><span class="pre">snr_predictor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstart</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h00</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pycbc.inference.models.relbin_cpu.snr_predictor" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.relbin_cpu.snr_predictor_dom">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.relbin_cpu.</span></span><span class="sig-name descname"><span class="pre">snr_predictor_dom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstart</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h00</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pycbc.inference.models.relbin_cpu.snr_predictor_dom" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-pycbc.inference.models.single_template">
<span id="pycbc-inference-models-single-template-module"></span><h2>pycbc.inference.models.single_template module<a class="headerlink" href="#module-pycbc.inference.models.single_template" title="Link to this heading"></a></h2>
<p>This module provides model classes that assume the noise is Gaussian.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.single_template.SingleTemplate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.single_template.</span></span><span class="sig-name descname"><span class="pre">SingleTemplate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_frequency_cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32768</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marginalize_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/single_template.html#SingleTemplate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.single_template.SingleTemplate" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.models.tools.DistMarg" title="pycbc.inference.models.tools.DistMarg"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistMarg</span></code></a>, <a class="reference internal" href="#pycbc.inference.models.gaussian_noise.BaseGaussianNoise" title="pycbc.inference.models.gaussian_noise.BaseGaussianNoise"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseGaussianNoise</span></code></a></p>
<p>Model that assumes we know all the intrinsic parameters.</p>
<p>This model assumes we know all the intrinsic parameters, and are only
maximizing over the extrinsic ones. We also assume a dominant mode waveform
approximant only and non-precessing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variable_params</strong> (<em>(</em><em>tuple of</em><em>) </em><em>string</em><em>(</em><em>s</em><em>)</em>) – A tuple of parameter names that will be varied.</p></li>
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – A dictionary of data, in which the keys are the detector names and the
values are the data (assumed to be unwhitened). All data must have the
same frequency resolution.</p></li>
<li><p><strong>low_frequency_cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – A dictionary of starting frequencies, in which the keys are the
detector names and the values are the starting frequencies for the
respective detectors to be used for computing inner products.</p></li>
<li><p><strong>sample_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) – The sample rate to use. Default is 32768.</p></li>
<li><p><strong>polarization_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) – Parameter to specify how finely to marginalize over polarization angle.
If None, then polarization must be a parameter.</p></li>
<li><p><strong>**kwargs</strong> – All other keyword arguments are passed to
<code class="xref py py-class docutils literal notranslate"><span class="pre">BaseGaussianNoise</span></code>; see that class for details.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.single_template.SingleTemplate.calculate_hihjs">
<span class="sig-name descname"><span class="pre">calculate_hihjs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">models</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/single_template.html#SingleTemplate.calculate_hihjs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.single_template.SingleTemplate.calculate_hihjs" title="Link to this definition"></a></dt>
<dd><p>Pre-calculate the hihj inner products on a grid</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.single_template.SingleTemplate.multi_loglikelihood">
<span class="sig-name descname"><span class="pre">multi_loglikelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">models</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/single_template.html#SingleTemplate.multi_loglikelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.single_template.SingleTemplate.multi_loglikelihood" title="Link to this definition"></a></dt>
<dd><p>Calculate a multi-model (signal) likelihood</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.single_template.SingleTemplate.multi_signal_support">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">multi_signal_support</span></span><a class="headerlink" href="#pycbc.inference.models.single_template.SingleTemplate.multi_signal_support" title="Link to this definition"></a></dt>
<dd><p>The list of classes that this model supports in a multi-signal
likelihood</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pycbc.inference.models.single_template.SingleTemplate.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'single_template'</span></em><a class="headerlink" href="#pycbc.inference.models.single_template.SingleTemplate.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-pycbc.inference.models.tools">
<span id="pycbc-inference-models-tools-module"></span><h2>pycbc.inference.models.tools module<a class="headerlink" href="#module-pycbc.inference.models.tools" title="Link to this heading"></a></h2>
<p>Common utility functions for calculation of likelihoods</p>
<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.tools.DistMarg">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.tools.</span></span><span class="sig-name descname"><span class="pre">DistMarg</span></span><a class="reference internal" href="_modules/pycbc/inference/models/tools.html#DistMarg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.tools.DistMarg" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Help class to add bookkeeping for likelihood marginalization</p>
<dl class="py property">
<dt class="sig sig-object py" id="pycbc.inference.models.tools.DistMarg.current_params">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">current_params</span></span><a class="headerlink" href="#pycbc.inference.models.tools.DistMarg.current_params" title="Link to this definition"></a></dt>
<dd><p>The current parameters</p>
<p>If a parameter has been vector marginalized, the likelihood should
expect an array for the given parameter. This allows transparent
vectorization for many models.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.tools.DistMarg.draw_ifos">
<span class="sig-name descname"><span class="pre">draw_ifos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_snr_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precalculate_marginalization_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/tools.html#DistMarg.draw_ifos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.tools.DistMarg.draw_ifos" title="Link to this definition"></a></dt>
<dd><p>Helper utility to determine which ifos we should use based on the
reference SNR time series.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.tools.DistMarg.draw_sky_times">
<span class="sig-name descname"><span class="pre">draw_sky_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/tools.html#DistMarg.draw_sky_times"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.tools.DistMarg.draw_sky_times" title="Link to this definition"></a></dt>
<dd><p>Draw ra, dec, and tc together using SNR timeseries to determine
monte-carlo weights.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.tools.DistMarg.draw_times">
<span class="sig-name descname"><span class="pre">draw_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/tools.html#DistMarg.draw_times"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.tools.DistMarg.draw_times" title="Link to this definition"></a></dt>
<dd><p>Draw times consistent with the incoherent network SNR</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>snrs</strong> (<em>dist</em><em> of </em><a class="reference internal" href="pycbc.types.html#pycbc.types.timeseries.TimeSeries" title="pycbc.types.timeseries.TimeSeries"><em>TimeSeries</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.tools.DistMarg.get_precalc_antenna_factors">
<span class="sig-name descname"><span class="pre">get_precalc_antenna_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ifo</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/tools.html#DistMarg.get_precalc_antenna_factors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.tools.DistMarg.get_precalc_antenna_factors" title="Link to this definition"></a></dt>
<dd><p>Get the antenna factors for marginalized samples if they exist</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.tools.DistMarg.marginalize_loglr">
<span class="sig-name descname"><span class="pre">marginalize_loglr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sh_total</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hh_total</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_vector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_peak</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/tools.html#DistMarg.marginalize_loglr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.tools.DistMarg.marginalize_loglr" title="Link to this definition"></a></dt>
<dd><p>Return the marginal likelihood</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sh_total</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> or </em><em>ndarray</em>) – The total &lt;s|h&gt; inner product summed over detectors</p></li>
<li><p><strong>hh_total</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> or </em><em>ndarray</em>) – The total &lt;h|h&gt; inner product summed over detectors</p></li>
<li><p><strong>skip_vector</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>False</em>) – If true, and input is a vector, do not marginalize over that
vector, instead return the likelihood values as a vector.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.tools.DistMarg.premarg_draw">
<span class="sig-name descname"><span class="pre">premarg_draw</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/tools.html#DistMarg.premarg_draw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.tools.DistMarg.premarg_draw" title="Link to this definition"></a></dt>
<dd><p>Choose random samples from prechosen set</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.tools.DistMarg.reconstruct">
<span class="sig-name descname"><span class="pre">reconstruct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_loglr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/tools.html#DistMarg.reconstruct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.tools.DistMarg.reconstruct" title="Link to this definition"></a></dt>
<dd><p>Reconstruct the distance or vectored marginalized parameter
of this class.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.tools.DistMarg.reset_vector_params">
<span class="sig-name descname"><span class="pre">reset_vector_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/tools.html#DistMarg.reset_vector_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.tools.DistMarg.reset_vector_params" title="Link to this definition"></a></dt>
<dd><p>Redraw vector params from their priors</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.tools.DistMarg.setup_marginalization">
<span class="sig-name descname"><span class="pre">setup_marginalization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marginalize_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marginalize_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marginalize_distance_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'distance'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marginalize_distance_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marginalize_distance_interpolator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marginalize_distance_snr_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marginalize_distance_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marginalize_vector_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marginalize_vector_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marginalize_sky_initial_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/tools.html#DistMarg.setup_marginalization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.tools.DistMarg.setup_marginalization" title="Link to this definition"></a></dt>
<dd><p>Setup the model for use with distance marginalization</p>
<p>This function sets up precalculations for distance / phase
marginalization. For distance margininalization it modifies the
model to internally remove distance as a parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variable_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><em>strings</em>) – The set of variable parameters</p></li>
<li><p><strong>marginalize_phase</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>False</em>) – Do analytic marginalization (appopriate only for 22 mode waveforms)</p></li>
<li><p><strong>marginalize_distance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>False</em>) – Marginalize over distance</p></li>
<li><p><strong>marginalize_distance_param</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Name of the parameter that is used to determine the distance.
This might be ‘distance’ or a parameter which can be converted
to distance by a provided univariate transformation.</p></li>
<li><p><strong>marginalize_distance_interpolator</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Use a pre-calculated interpolating function for the distance
marginalized likelihood.</p></li>
<li><p><strong>marginalize_distance_snr_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> of </em><em>floats</em><em>, </em><em>(</em><em>1</em><em>, </em><em>50</em><em>)</em>) – The SNR range for the interpolating function to be defined in.
If a sampler goes outside this range, the logl will be returned
as -numpy.inf.</p></li>
<li><p><strong>marginalize_distance_density</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> of </em><em>intes</em><em>, </em><em>(</em><em>1000</em><em>, </em><em>1000</em><em>)</em>) – The dimensions of the interpolation grid over (sh, hh).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>variable_params</strong> (<em>list of strings</em>) – Set of variable params (missing distance-related parameter).</p></li>
<li><p><strong>kwags</strong> (<em>dict</em>) – The keyword arguments to the model initialization, may be modified
from the original set by this function.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.tools.DistMarg.setup_peak_lock">
<span class="sig-name descname"><span class="pre">setup_peak_lock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4096</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_lock_snr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_lock_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_lock_region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/tools.html#DistMarg.setup_peak_lock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.tools.DistMarg.setup_peak_lock" title="Link to this definition"></a></dt>
<dd><p>Determine where to constrain marginalization based on
the observed reference SNR peaks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – The SNR sample rate</p></li>
<li><p><strong>snrs</strong> (<em>Dict</em><em> of </em><em>SNR time series</em>) – Either provide this or the model needs a function
to get the reference SNRs.</p></li>
<li><p><strong>peak_lock_snr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – The minimum SNR to bother restricting from the prior range</p></li>
<li><p><strong>peak_lock_ratio</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – The likelihood ratio (not log) relative to the peak to
act as a threshold bounding region.</p></li>
<li><p><strong>peak_lock_region</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Number of samples to inclue beyond the strict region
determined by the relative likelihood</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pycbc.inference.models.tools.DistMarg.snr_draw">
<span class="sig-name descname"><span class="pre">snr_draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wfs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/tools.html#DistMarg.snr_draw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.tools.DistMarg.snr_draw" title="Link to this definition"></a></dt>
<dd><p>Improve the monte-carlo vector marginalization using the SNR time
series of each detector</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.tools.draw_sample">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.tools.</span></span><span class="sig-name descname"><span class="pre">draw_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loglr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/tools.html#draw_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.tools.draw_sample" title="Link to this definition"></a></dt>
<dd><p>Draw a random index from a 1-d vector with loglr weights</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.tools.marginalize_likelihood">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.tools.</span></span><span class="sig-name descname"><span class="pre">marginalize_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_vector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_peak</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_complex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/tools.html#marginalize_likelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.tools.marginalize_likelihood" title="Link to this definition"></a></dt>
<dd><p>Return the marginalized likelihood.</p>
<p>Apply various marginalizations to the data, including phase, distance,
and brute-force vector marginalizations. Several options relate
to how the distance marginalization is approximated and others allow for
special return products to aid in parameter reconstruction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sh</strong> (<em>complex float</em><em> or </em><em>numpy.ndarray</em>) – The data-template inner product</p></li>
<li><p><strong>hh</strong> (<em>complex float</em><em> or </em><em>numpy.ndarray</em>) – The template-template inner product</p></li>
<li><p><strong>logw</strong> – log weighting factors if vector marginalization is used, if not
given, each sample is assumed to be equally weighted</p></li>
<li><p><strong>phase</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>False</em>) – Enable phase marginalization. Only use if orbital phase can be related
to just a single overall phase (e.g. not true for waveform with
sub-dominant modes)</p></li>
<li><p><strong>skip_vector</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>False</em>) – Don’t apply marginalization of vector component of input (i.e. leave
as vector).</p></li>
<li><p><strong>interpolator</strong> (<em>function</em><em>, </em><em>None</em>) – If provided, internal calculation is skipped in favor of a
precalculated interpolating function which takes in sh/hh
and returns the likelihood.</p></li>
<li><p><strong>return_peak</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>False</em>) – Return the peak likelihood and index if using passing an array as
input in addition to the marginalized over the array likelihood.</p></li>
<li><p><strong>return_complex</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>False</em>) – Return the sh / hh data products before applying phase marginalization.
This option is intended to aid in reconstucting phase marginalization
and is unlikely to be useful for other purposes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>loglr</strong> – The marginalized loglikehood ratio</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.tools.setup_distance_marg_interpolant">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.tools.</span></span><span class="sig-name descname"><span class="pre">setup_distance_marg_interpolant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist_marg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snr_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">50)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1000,</span> <span class="pre">1000)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/tools.html#setup_distance_marg_interpolant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.tools.setup_distance_marg_interpolant" title="Link to this definition"></a></dt>
<dd><p>Create the interpolant for distance marginalization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist_marg</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> of </em><em>two arrays</em>) – The (dist_loc, dist_weight) tuple which defines the grid
for integrating over distance</p></li>
<li><p><strong>snr_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> of </em><em>(</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em>) – Tuple of min, max SNR that the interpolant is expected to work
for.</p></li>
<li><p><strong>density</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> of </em><em>(</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em>) – The number of samples in either dimension of the 2d interpolant</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>interp</strong> – Function which returns the precalculated likelihood for a given
inner product sh/hh.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>function</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.tools.str_to_bool">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.tools.</span></span><span class="sig-name descname"><span class="pre">str_to_bool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sval</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/tools.html#str_to_bool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.tools.str_to_bool" title="Link to this definition"></a></dt>
<dd><p>Ensure value is a bool if it can be converted</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.tools.str_to_tuple">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.tools.</span></span><span class="sig-name descname"><span class="pre">str_to_tuple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftype</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models/tools.html#str_to_tuple"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.tools.str_to_tuple" title="Link to this definition"></a></dt>
<dd><p>Convenience parsing to convert str to tuple</p>
</dd></dl>

</section>
<section id="module-pycbc.inference.models">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pycbc.inference.models" title="Link to this heading"></a></h2>
<p>This package provides classes and functions for evaluating Bayesian statistics
assuming various noise models.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pycbc.inference.models.CallModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.</span></span><span class="sig-name descname"><span class="pre">CallModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callstat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_all_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models.html#CallModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.CallModel" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Wrapper class for calling models from a sampler.</p>
<p>This class can be called like a function, with the parameter values to
evaluate provided as a list in the same order as the model’s
<code class="docutils literal notranslate"><span class="pre">variable_params</span></code>. In that case, the model is updated with the provided
parameters and then the <code class="docutils literal notranslate"><span class="pre">callstat</span></code> retrieved. If <code class="docutils literal notranslate"><span class="pre">return_all_stats</span></code> is
set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, then all of the stats specified by the model’s
<code class="docutils literal notranslate"><span class="pre">default_stats</span></code> will be returned as a tuple, in addition to the stat
value.</p>
<p>The model’s attributes are promoted to this class’s namespace, so that any
attribute and method of <code class="docutils literal notranslate"><span class="pre">model</span></code> may be called directly from this class.</p>
<p>This class must be initalized prior to the creation of a <code class="docutils literal notranslate"><span class="pre">Pool</span></code> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Model instance</em>) – The model to call.</p></li>
<li><p><strong>callstat</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The statistic to call.</p></li>
<li><p><strong>return_all_stats</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether or not to return all of the other statistics along with the
<code class="docutils literal notranslate"><span class="pre">callstat</span></code> value.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create a wrapper around an instance of the <code class="docutils literal notranslate"><span class="pre">TestNormal</span></code> model, with the
<code class="docutils literal notranslate"><span class="pre">callstat</span></code> set to <code class="docutils literal notranslate"><span class="pre">logposterior</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pycbc.inference.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">TestNormal</span><span class="p">,</span> <span class="n">CallModel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">TestNormal</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">call_model</span> <span class="o">=</span> <span class="n">CallModel</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;logposterior&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now call on a set of parameter values:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">call_model</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">])</span>
<span class="go">(-1.8628770664093453, (0.0, 0.0, -1.8628770664093453))</span>
</pre></div>
</div>
<p>Note that a tuple of all of the model’s <code class="docutils literal notranslate"><span class="pre">default_stats</span></code> were returned in
addition to the <code class="docutils literal notranslate"><span class="pre">logposterior</span></code> value. We can shut this off by toggling
<code class="docutils literal notranslate"><span class="pre">return_all_stats</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">call_model</span><span class="o">.</span><span class="n">return_all_stats</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">call_model</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">])</span>
<span class="go">-1.8628770664093453</span>
</pre></div>
</div>
<p>Attributes of the model can be called from the call model. For example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">call_model</span><span class="o">.</span><span class="n">variable_params</span>
<span class="go">(&#39;x&#39;, &#39;y&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.available_models">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.</span></span><span class="sig-name descname"><span class="pre">available_models</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models.html#available_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.available_models" title="Link to this definition"></a></dt>
<dd><p>List the currently available models.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.get_model">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.</span></span><span class="sig-name descname"><span class="pre">get_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models.html#get_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.get_model" title="Link to this definition"></a></dt>
<dd><p>Retrieve the given model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The name of the model to get.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The requested model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.get_models">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.</span></span><span class="sig-name descname"><span class="pre">get_models</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models.html#get_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.get_models" title="Link to this definition"></a></dt>
<dd><p>Returns the dictionary of current models.</p>
<p>Ensures that plugins are added to the dictionary first.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.read_from_config">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.</span></span><span class="sig-name descname"><span class="pre">read_from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cp</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models.html#read_from_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.read_from_config" title="Link to this definition"></a></dt>
<dd><p>Initializes a model from the given config file.</p>
<p>The section must have a <code class="docutils literal notranslate"><span class="pre">name</span></code> argument. The name argument corresponds to
the name of the class to initialize.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cp</strong> (<a class="reference internal" href="pycbc.workflow.html#pycbc.workflow.configuration.WorkflowConfigParser" title="pycbc.workflow.configuration.WorkflowConfigParser"><em>WorkflowConfigParser</em></a>) – Config file parser to read.</p></li>
<li><p><strong>**kwargs</strong> – All other keyword arguments are passed to the <code class="docutils literal notranslate"><span class="pre">from_config</span></code> method
of the class specified by the name argument.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The initialized model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>cls</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pycbc.inference.models.register_model">
<span class="sig-prename descclassname"><span class="pre">pycbc.inference.models.</span></span><span class="sig-name descname"><span class="pre">register_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/models.html#register_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pycbc.inference.models.register_model" title="Link to this definition"></a></dt>
<dd><p>Makes a custom model available to PyCBC.</p>
<p>The provided model will be added to the dictionary of models that PyCBC
knows about, using the model’s <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute. If the <code class="docutils literal notranslate"><span class="pre">name</span></code> is the
same as a model that already exists in PyCBC, a warning will be printed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<a class="reference internal" href="#pycbc.inference.models.base.BaseModel" title="pycbc.inference.models.base.BaseModel"><em>pycbc.inference.models.base.BaseModel</em></a>) – The model to use. The model should be a sub-class of
<a class="reference internal" href="#pycbc.inference.models.base.BaseModel" title="pycbc.inference.models.base.BaseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></a> to ensure
it has the correct API for use within <code class="docutils literal notranslate"><span class="pre">pycbc_inference</span></code>.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pycbc.inference.jump.html" class="btn btn-neutral float-left" title="pycbc.inference.jump package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pycbc.inference.sampler.html" class="btn btn-neutral float-right" title="pycbc.inference.sampler package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2015, 2016, 2017, Alexander Nitz, Ian Harry, Christopher M. Biwer, Duncan A.  Brown, Josh Willis, and Tito Dal Canton.
      <span class="lastupdated">Last updated on Feb 06, 2026.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>